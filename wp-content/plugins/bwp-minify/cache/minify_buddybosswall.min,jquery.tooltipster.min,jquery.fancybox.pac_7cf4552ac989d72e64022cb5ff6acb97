/*! 
 * BuddyBoss Wall JavaScript Library 
 * @package BuddyBoss Wall 
 */function budyboss_wall_comment_like_unlike(a){if(jq=jQuery,a=jq(a),a.hasClass("fav-comment")||a.hasClass("unfav-comment")){var b=a.hasClass("fav-comment")?"fav":"unfav",c=a.closest("[id^=acomment-]"),d=c.attr("id").substr(9,c.attr("id").length);a.addClass("loading"),jq.post(ajaxurl,{action:"activity_mark_"+b,cookie:bp_get_cookies(),id:d,item_type:"comment"},function(c){a.removeClass("loading"),a.fadeOut(200,function(){jq(this).html(c),jq(this).attr("title","fav"==b?BP_DTheme.remove_fav:BP_DTheme.mark_as_fav),jq(this).fadeIn(200)}),"fav"==b?(jq(".item-list-tabs #activity-favs-personal-li").length||(jq(".item-list-tabs #activity-favorites").length||jq(".item-list-tabs ul #activity-mentions").before('<li id="activity-favorites"><a href="#">'+BP_DTheme.my_favs+" <span>0</span></a></li>"),jq(".item-list-tabs ul #activity-favorites span").html(Number(jq(".item-list-tabs ul #activity-favorites span").html())+1)),a.removeClass("fav-comment"),a.addClass("unfav-comment")):(a.removeClass("unfav-comment"),a.addClass("fav-comment"),jq(".item-list-tabs ul #activity-favorites span").html(Number(jq(".item-list-tabs ul #activity-favorites span").html())-1),Number(jq(".item-list-tabs ul #activity-favorites span").html())||(jq(".item-list-tabs ul #activity-favorites").hasClass("selected")&&bp_activity_request(null,null),jq(".item-list-tabs ul #activity-favorites").remove()))})}return!1}function bb_url_scrapeURL(a){var b="";if(a.indexOf("http://")>=0?b=bb_url_getUrl("http://",a):a.indexOf("https://")>=0?b=bb_url_getUrl("https://",a):a.indexOf("www.")>=0&&(b=bb_url_getUrl("www",a)),""!=b){var c=document.createElement("a");c.href=b;var d=c.hostname;window.Code.BuddyBoss_Wall_Util.state.excluded_oembed_hosts.indexOf(d)!=-1&&(b="")}return""===b?(jQuery("#bb-url-scrapper").hide(),void jQuery(".bb-url-scrapper-container").hide()):void bb_load_url_preview(b)}function bb_load_url_preview(a){bb_is_valid_url(a)&&bb_url_getUrlData(a)}function bb_url_abortTimer(){null!=bb_url_tid&&clearTimeout(bb_url_tid)}function bb_url_getUrlData(a){jQuery("#whats-new-submit input").prop("disabled",!0),jQuery(".bb-url-scrapper-container").show(),jQuery(".bb-url-scrapper-loading").show(),jQuery("#bb-url-scrapper").hide(),jQuery("#bb-url-error").hide();var b={action:"bb_url_parser",url:a};jQuery.ajax({url:ajaxurl,data:b,type:"POST",dataType:"json",success:function(b){if(jQuery("#whats-new-submit input").prop("disabled",!1),jQuery("#buddyboss-media-add-photo-button").prop("disabled",!1),jQuery("#bb-url-scrapper-img-holder").show(),""==b.title)return void jQuery(".bb-url-scrapper-container").hide();if(jQuery(".bb-url-scrapper-loading").hide(),""==b.error){jQuery("#bb-url-error").hide(),jQuery("#bb-url-scrapper").show(),bb_urlInUse=a;var c="";jQuery("#bb-url-scrapper-description").text(""),jQuery("#bb-url-scrapper-description-hidden").val(""),jQuery("#bb-url-scrapper-title").text(""),jQuery("#bb-url-scrapper-title-hidden").val(""),jQuery("#bb-url-scrapper-url").text(""),jQuery("#bb-url-scrapper-url-hidden").val(""),jQuery("#bb-url-scrapper-img").css("backgroundImage",""),bb_url_imgSrcArray=[],bb_url_imgArrayCounter=0,c=b.title,jQuery("#bb-url-scrapper-title").html(c),jQuery("#bb-url-scrapper-title-hidden").val(c),jQuery("#bb-url-scrapper-url").text(a),jQuery("#bb-url-scrapper-url-hidden").val(a),jQuery("#bb-url-scrapper-description").html(b.description),jQuery("#bb-url-scrapper-description-hidden").val(b.description),jQuery.each(b.images,function(a,b){bb_url_imgSrcArray.push(b)}),0!=bb_url_imgSrcArray.length&&jQuery("#buddyboss-media-add-photo-button").prop("disabled",!0)}else jQuery("#bb-url-error").text(b.error),jQuery(".bb-url-scrapper-container").hide(),jQuery("#bb-url-error").show();jQuery("#bb-url-scrapper-img").find("img").attr("src",bb_url_imgSrcArray[bb_url_imgArrayCounter]),jQuery("#bb-url-scrapper-img-hidden").val(bb_url_imgSrcArray[bb_url_imgArrayCounter]),jQuery("#bb-url-scrapper-img-count").text("1 of "+bb_url_imgSrcArray.length)}})}function bb_is_valid_url(a){var b=/^(http|https|ftp):\/\/[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$/;return b.test(a)}function bb_url_getUrl(a,b){for(var c="",d=b.indexOf(a),e=d;e<b.length&&(" "!=b[e]&&"\n"!=b[e]);e++)c+=b[e];return"www"===a&&(a="http://",c=a+c),c}var jq=$=jQuery;window.Code=window.Code||{},window.Code.BuddyBoss_Wall_Util=function(a,b,c,d){var e={state:c,lang:function(a){var a=a||"undefined key!";return c[a]||"Language key missing for: "+a}};return e}(window,window.jQuery,window.BuddyBoss_Wall_Appstate||!1),window.Code.BuddyBoss_Wall=function(a,b,c,d){var e=c.state||{},f=(c.lang,{on:null,setup_form:function(){var a=b("#buddyboss-wall-tpl-form"),c=b("body.just-me.has-activity #item-body > .activity").first(),d=b("#whats-new-form");!d.length&&a.length&&c.length},setup_comments:function(){var a=b(".buddyboss-wall-tpl-activity-comments");a.each(function(){var a=b(this),c=a.parent().find(".activity-comments");c.length&&!a.data("buddyboss-wall-appended")&&(a.data("buddyboss-wall-appended",!0),c.prepend(a.html()))})},setup_link_previews:function(){jQuery("#whats-new").addClass("bblinkBox"),jQuery("#whats-new-textarea").append('<div class="bb-url-scrapper-container"><i class="bb-url-scrapper-loading buddyboss-wall-ajax-loader fa fa-spinner"></i><div id="bb-url-scrapper"><div id="bb-url-scrapper-img-holder"><div id="bb-url-scrapper-img"><img src="" /><a title="Cancel Preview Image" href="#" id="bbimagecloselinksuggestion"><i class="fa fa-times"></i></a></div><div class="bb-url-thumb-nav"><input type="button" id="bb-url-prevPicButton" value="<" /><input type="button" id="bb-url-nextPicButton" value=">"><div id="bb-url-scrapper-img-count"></div></div></div><div id="bb-url-scrapper-text-holder"><div id="bb-url-scrapper-title"></div><div id="bb-url-scrapper-url"></div><div id="bb-url-scrapper-description"></div><div id="bb-url-error"></div><a title="Cancel Preview" href="#" id="bbcloselinksuggestion"><i class="fa fa-times"></i></a></div></div></div>'),jQuery("#whats-new-form").append('<input type="hidden" id="bb-url-scrapper-img-hidden" name="bb-url-scrapper-img-hidden" value="" /><input type="hidden" id="bb-url-scrapper-title-hidden"  name="bb-url-scrapper-title-hidden" value="" /><input type="hidden" id="bb-url-scrapper-url-hidden" name="bb-url-scrapper-url-hidden" value="" /><input type="hidden" id="bb-url-scrapper-description-hidden" name="bb-url-scrapper-description-hidden" value="" /><input type="hidden" id="bb-url-no-scrapper" name="bb-url-no-scrapper" value="1" />'),jQuery("#bb-url-scrapper").hide(),jQuery("#bb-url-nextPicButton").click(function(a){bb_url_imgArrayCounter++,bb_url_imgArrayCounter>=bb_url_imgSrcArray.length&&(bb_url_imgArrayCounter=0),jQuery("#bb-url-scrapper-img").find("img").attr("src",bb_url_imgSrcArray[bb_url_imgArrayCounter]),jQuery("#bb-url-scrapper-img-hidden").val(bb_url_imgSrcArray[bb_url_imgArrayCounter]),jQuery("#bb-url-scrapper-img-count").text(bb_url_imgArrayCounter+1+" of "+bb_url_imgSrcArray.length)}),jQuery("#bb-url-prevPicButton").click(function(a){bb_url_imgArrayCounter--,bb_url_imgArrayCounter<0&&(bb_url_imgArrayCounter=bb_url_imgSrcArray.length-1),jQuery("#bb-url-scrapper-img").find("img").attr("src",bb_url_imgSrcArray[bb_url_imgArrayCounter]),jQuery("#bb-url-scrapper-img-hidden").val(bb_url_imgSrcArray[bb_url_imgArrayCounter]),jQuery("#bb-url-scrapper-img-count").text(bb_url_imgArrayCounter+1+" of "+bb_url_imgSrcArray.length)}),jQuery("#bbimagecloselinksuggestion").click(function(a){a.preventDefault(),jQuery("#bb-url-scrapper-img-holder").hide(),jQuery("#bb-url-scrapper-img-hidden").val(""),jQuery("#buddyboss-media-add-photo-button").prop("disabled",!1)}),jQuery("#bbcloselinksuggestion").click(function(a){a.preventDefault(),jQuery(".bb-url-scrapper-container").hide(),jQuery("#bb-url-no-scrapper").val("1"),jQuery("#bb-url-scrapper-description").text(""),jQuery("#bb-url-scrapper-description-hidden").val(""),jQuery("#bb-url-scrapper-title").text(""),jQuery("#bb-url-scrapper-title-hidden").val(""),jQuery("#bb-url-scrapper-url").text(""),jQuery("#bb-url-scrapper-url-hidden").val(""),jQuery("#bb-url-scrapper-img").css("backgroundImage","")}),jQuery(".bblinkBox").on("keyup",function(a){"1"===jQuery("#bb-url-no-scrapper").val()&&(urlText=this.value,bb_url_abortTimer(),bb_url_tid=setTimeout(function(){bb_url_scrapeURL(urlText)},1e3),13==a.which&&this.rows++)})},setup:function(){f.on=!0,b.ajaxPrefilter(f.prefilter),b(document).ajaxSuccess(function(a){f.setup_comments(),setTimeout(f.setup_comments,205),setTimeout(f.setup_comments,500)}),f.setup_form(),f.setup_comments(),e.enabled_link_preview&&f.setup_link_previews();var a=b("#buddyboss-wall-tpl-greeting").html(),c=b("#whats-new-form .activity-greeting");c.length&&a&&c.html(a).show()},teardown:function(){f.on=!1},prefilter:function(a,c,d){item_type=c.data&&c.data.item_type||"";var g,h=parseInt(c.data&&c.data.id||0),i=c.data&&c.data.action||"",j="activity_mark_fav"===i||"activity_mark_unfav"===i,k="post_update"===i,l="comment"===item_type;k&&e.enabled_link_preview&&(g=b("#bb-url-scrapper-url").html().length,g>0&&(a.data+="&bb_link_url="+encodeURIComponent(b("#bb-url-scrapper-url-hidden").val()),a.data+="&bb_link_title="+encodeURIComponent(b("#bb-url-scrapper-title-hidden").val()),a.data+="&bb_link_img="+encodeURIComponent(b("#bb-url-scrapper-img-hidden").val()),a.data+="&bb_link_description="+encodeURIComponent(b("#bb-url-scrapper-description-hidden").val()),b(".bb-url-scrapper-container").hide(),b("#bb-url-no-scrapper").val("1"),b("#bb-url-scrapper-description").text(""),b("#bb-url-scrapper-description-hidden").val(""),b("#bb-url-scrapper-title").text(""),b("#bb-url-scrapper-title-hidden").val(""),b("#bb-url-scrapper-url").text(""),b("#bb-url-scrapper-url-hidden").val(""),b("#bb-url-scrapper-img").css("backgroundImage",""))),j&&h>0&&(g=b("#activity-"+h).find(".button.loading"),type=g.hasClass("fav")?"fav":"unfav",l&&(g=b("#acomment-"+h).find(".acomment-like.loading"),type=g.hasClass("fav-comment")?"fav":"unfav"),a.success=function(a){return function(c,d,e){c[0]+c[1]==="-1"&&b.isFunction(a)?a(c):f.success(g,type,l,c,d,e)}}(a.success))},success:function(a,b,c,e,f,g){var h=!1,i="",j="",k=0,l=!1,m=e.indexOf("{")!=-1&&jQuery.parseJSON(e);if(i=m&&m.but_text?m.but_text:e,m&&m.hasOwnProperty("like_count")&&(m.like_count?(h=!0,j=m.num_likes):l=!0),a.fadeOut(200,function(){var a=jq(this),d=a.parents(".activity-item"),e=d.find(".activity-comments"),f=e.find("ul").first(),g=e.find(".activity-like-count:not(.reply-like-count)"),k=e.find("li").not(".activity-like-count"),m=j;c&&(e=a.parents(".acomment-options"),f=e.find("ul").first(),g=e.find(".activity-like-count"),k=e.find("li").not(".activity-like-count"),m=j),a.html(i),a.attr("title","fav"==b?BP_DTheme.remove_fav:BP_DTheme.mark_as_fav),a.fadeIn(200),g.remove(),h&&(f.length?f.prepend(m):c?e.append('<ul class="acomment-reply-like-content">'+m+"</ul>"):e.prepend("<ul>"+m+"</ul>")),l&&f.length&&!k.length&&f.remove()}),"fav"==b){var n=jq(".item-list-tabs ul #activity-favorites span").html();n!=d&&(k=Number(n.replace(/,/g,""))+1),jq(".item-list-tabs #activity-favorites").length||jq(".item-list-tabs ul li#activity-mentions").before('<li id="activity-favorites"><a href="#" class="localized">'+BP_DTheme.my_favs+" <span>0</span></a></li>"),c?(a.removeClass("fav-comment"),a.addClass("unfav-comment")):(a.removeClass("fav"),a.addClass("unfav")),jq(".item-list-tabs ul #activity-favorites span").html(Number(jq(".item-list-tabs ul #activity-favorites span").html())+1)}else{var n=jq(".item-list-tabs ul #activity-favorites span").html();n!=d&&(k=Number(n.replace(/,/g,""))-1),c?(a.removeClass("unfav-comment"),a.addClass("fav-comment")):(a.removeClass("unfav"),a.addClass("fav")),n&&jq(".item-list-tabs ul #activity-favorites span").html(k),0==k&&(jq(".item-list-tabs ul #activity-favorites").hasClass("selected")&&bp_activity_request(null,null),jq(".item-list-tabs ul #activity-favorites").remove())}"activity-favorites"==jq(".item-list-tabs li.selected").attr("id")&&a.closest(".activity-item").slideUp(100),a.removeClass("loading")}});b(document).ready(function(){f.setup(),String.prototype.startsWith=function(a){return this.match("^"+a)==a}});var g={setup:function(){f.setup()},teardown:function(){f.teardown()}};return g}(window,window.jQuery,window.Code.BuddyBoss_Wall_Util),function(a,b,c,d){var e={ajaxResetTimeout:201},f=c.state||{},g=(c.lang,{}),h={};g.init=function(){h.document=b(document),h.document.ajaxSuccess(g.ajaxSuccessListener),g.initTooltips(),BP_DTheme&&f&&b.extend(BP_DTheme,f)},g.ajaxSuccessListener=function(b,c,d){g.destroyTooltips(),a.setTimeout(g.initTooltips,e.ajaxResetTimeout)},g.destroyTooltips=function(){h.tooltips&&h.tooltips.length&&(h.tooltips.tooltipster("destroy"),h.tooltips=null)},g.initTooltips=function(){h.tooltips=b(".buddyboss-wall-tt-others"),h.tooltips.length&&h.tooltips.tooltipster({contentAsHTML:!0,functionInit:g.getTooltipContent,interactive:!0,position:"top-left",theme:"tooltipster-buddyboss"})},g.getTooltipContent=function(a,b){var c=a.parent().find(".buddyboss-wall-tt-content").detach().html();return c},f.load_tooltips&&(g.load_tooltips=!0),jQuery(document).ready(function(){g.load_tooltips===!0&&g.init()})}(window,window.jQuery,window.Code.BuddyBoss_Wall_Util);var bb_url_imgSrcArray=[],bb_url_imgArrayCounter=0,bb_url_tid;
;/*! 
 * BuddyBoss Media JavaScript Library 
 * @package BuddyBoss Media 
 */!function(a,b,c){function d(b,c){this.bodyOverflowX,this.checkInterval=null,this.content,this.$el=a(b),this.elProxyPosition,this.$elProxy,this.enabled=!0,this.options=a.extend({},j,c),this.mouseIsOverProxy=!1,this.namespace="tooltipster-"+Math.round(1e5*Math.random()),this.status="hidden",this.timerHide=null,this.timerShow=null,this.$tooltip,this.options.iconTheme=this.options.iconTheme.replace(".",""),this.options.theme=this.options.theme.replace(".",""),this.init()}function e(b,c){var d=!0;return a.each(b,function(a,e){if("undefined"==typeof c[a]||b[a]!==c[a])return d=!1,!1}),d}function f(){return!l&&k}function g(){var a=c.body||c.documentElement,b=a.style,d="transition";if("string"==typeof b[d])return!0;v=["Moz","Webkit","Khtml","O","ms"],d=d.charAt(0).toUpperCase()+d.substr(1);for(var e=0;e<v.length;e++)if("string"==typeof b[v[e]+d])return!0;return!1}var h="tooltipster",j={animation:"fade",arrow:!0,arrowColor:"",autoClose:!0,content:null,contentAsHTML:!1,contentCloning:!0,delay:200,fixedWidth:0,maxWidth:0,functionInit:function(a,b){},functionBefore:function(a,b){b()},functionReady:function(a,b){},functionAfter:function(a){},icon:"(?)",iconCloning:!0,iconDesktop:!1,iconTouch:!1,iconTheme:"tooltipster-icon",interactive:!1,interactiveTolerance:350,offsetX:0,offsetY:0,onlyOne:!1,position:"top",positionTracker:!1,speed:350,timer:0,theme:"tooltipster-default",touchDevices:!0,trigger:"hover",updateAnimation:!0};d.prototype={init:function(){var b=this;if(c.querySelector){if(null!==b.options.content)b.setContent(b.options.content);else{var d=b.$el.attr("title");"undefined"==typeof d&&(d=null),b.setContent(d)}var e=b.options.functionInit(b.$el,b.content);"undefined"!=typeof e&&b.setContent(e),b.$el.removeAttr("title").addClass("tooltipstered"),!k&&b.options.iconDesktop||k&&b.options.iconTouch?("string"==typeof b.options.icon?(b.$elProxy=a('<span class="'+b.options.iconTheme+'"></span>'),b.$elProxy.text(b.options.icon)):b.options.iconCloning?b.$elProxy=b.options.icon.clone(!0):b.$elProxy=b.options.icon,b.$elProxy.insertAfter(b.$el)):b.$elProxy=b.$el,"hover"==b.options.trigger?(b.$elProxy.on("mouseenter."+b.namespace,function(){f()&&!b.options.touchDevices||(b.mouseIsOverProxy=!0,b.showTooltip())}).on("mouseleave."+b.namespace,function(){f()&&!b.options.touchDevices||(b.mouseIsOverProxy=!1)}),k&&b.options.touchDevices&&b.$elProxy.on("touchstart."+b.namespace,function(){b.showTooltipNow()})):"click"==b.options.trigger&&b.$elProxy.on("click."+b.namespace,function(){f()&&!b.options.touchDevices||b.showTooltip()})}},showTooltip:function(){var a=this;"shown"!=a.status&&"appearing"!=a.status&&(a.options.delay?a.timerShow=setTimeout(function(){("click"==a.options.trigger||"hover"==a.options.trigger&&a.mouseIsOverProxy)&&a.showTooltipNow()},a.options.delay):a.showTooltipNow())},showTooltipNow:function(){var c=this;clearTimeout(c.timerShow),c.timerShow=null,clearTimeout(c.timerHide),c.timerHide=null,c.enabled&&null!==c.content&&(c.options.onlyOne&&a(".tooltipstered").not(c.$el).each(function(b,c){var d=a(c),e=d[h]("status"),f=d[h]("option","autoClose");"hidden"!==e&&"disappearing"!==e&&f&&d[h]("hide")}),c.options.functionBefore(c.$elProxy,function(){if("hidden"!==c.status){var d=0;"disappearing"===c.status&&(c.status="appearing",g()?(c.$tooltip.clearQueue().removeClass("tooltipster-dying").addClass("tooltipster-"+c.options.animation+"-show"),c.options.speed>0&&c.$tooltip.delay(c.options.speed),c.$tooltip.queue(function(){c.status="shown"})):c.$tooltip.stop().fadeIn(function(){c.status="shown"}))}else{c.status="appearing";var d=c.options.speed;c.bodyOverflowX=a("body").css("overflow-x"),a("body").css("overflow-x","hidden");var e="tooltipster-"+c.options.animation,f="-webkit-transition-duration: "+c.options.speed+"ms; -webkit-animation-duration: "+c.options.speed+"ms; -moz-transition-duration: "+c.options.speed+"ms; -moz-animation-duration: "+c.options.speed+"ms; -o-transition-duration: "+c.options.speed+"ms; -o-animation-duration: "+c.options.speed+"ms; -ms-transition-duration: "+c.options.speed+"ms; -ms-animation-duration: "+c.options.speed+"ms; transition-duration: "+c.options.speed+"ms; animation-duration: "+c.options.speed+"ms;",h=c.options.fixedWidth>0?"width:"+Math.round(c.options.fixedWidth)+"px;":"",i=c.options.maxWidth>0?"max-width:"+Math.round(c.options.maxWidth)+"px;":"",j=c.options.interactive?"pointer-events: auto;":"";if(c.$tooltip=a('<div class="tooltipster-base '+c.options.theme+'" style="'+h+" "+i+" "+j+" "+f+'"><div class="tooltipster-content"></div></div>'),g()&&c.$tooltip.addClass(e),c.insertContent(),c.$tooltip.appendTo("body"),c.positionTooltip(),c.options.functionReady(c.$el,c.$tooltip),g()?(c.$tooltip.addClass(e+"-show"),c.options.speed>0&&c.$tooltip.delay(c.options.speed),c.$tooltip.queue(function(){c.status="shown"})):c.$tooltip.css("display","none").fadeIn(c.options.speed,function(){c.status="shown"}),c.setCheckInterval(),a(b).on("scroll."+c.namespace+" resize."+c.namespace,function(){c.positionTooltip()}),c.options.autoClose)if(a("body").off("."+c.namespace),"hover"==c.options.trigger)if(k&&setTimeout(function(){a("body").on("touchstart."+c.namespace,function(){c.hideTooltip()})},0),c.options.interactive){k&&c.$tooltip.on("touchstart."+c.namespace,function(a){a.stopPropagation()});var l=null;c.$elProxy.add(c.$tooltip).on("mouseleave."+c.namespace+"-autoClose",function(){clearTimeout(l),l=setTimeout(function(){c.hideTooltip()},c.options.interactiveTolerance)}).on("mouseenter."+c.namespace+"-autoClose",function(){clearTimeout(l)})}else c.$elProxy.on("mouseleave."+c.namespace+"-autoClose",function(){c.hideTooltip()});else"click"==c.options.trigger&&(setTimeout(function(){a("body").on("click."+c.namespace+" touchstart."+c.namespace,function(){c.hideTooltip()})},0),c.options.interactive&&c.$tooltip.on("click."+c.namespace+" touchstart."+c.namespace,function(a){a.stopPropagation()}))}c.options.timer>0&&(c.timerHide=setTimeout(function(){c.timerHide=null,c.hideTooltip()},c.options.timer+d))}))},setCheckInterval:function(){var b=this;b.checkInterval=setInterval(function(){if(0===a("body").find(b.$el).length||0===a("body").find(b.$elProxy).length||"hidden"==b.status||0===a("body").find(b.$tooltip).length)"shown"!=b.status&&"appearing"!=b.status||b.hideTooltip(),b.cancelCheckInterval();else if(b.options.positionTracker){var c=b.positionInfo(b.$elProxy),d=!1;e(c.dimension,b.elProxyPosition.dimension)&&("fixed"===b.$elProxy.css("position")?e(c.position,b.elProxyPosition.position)&&(d=!0):e(c.offset,b.elProxyPosition.offset)&&(d=!0)),d||b.positionTooltip()}},200)},cancelCheckInterval:function(){clearInterval(this.checkInterval),this.checkInterval=null},hideTooltip:function(){var c=this;if(clearTimeout(c.timerShow),c.timerShow=null,clearTimeout(c.timerHide),c.timerHide=null,"shown"==c.status||"appearing"==c.status){c.status="disappearing";var d=function(){c.status="hidden",c.$tooltip.remove(),c.$tooltip=null,a(b).off("."+c.namespace),a("body").off("."+c.namespace).css("overflow-x",c.bodyOverflowX),c.$elProxy.off("."+c.namespace+"-autoClose"),c.options.functionAfter(c.$elProxy)};g()?(c.$tooltip.clearQueue().removeClass("tooltipster-"+c.options.animation+"-show").addClass("tooltipster-dying"),c.options.speed>0&&c.$tooltip.delay(c.options.speed),c.$tooltip.queue(d)):c.$tooltip.stop().fadeOut(c.options.speed,d)}},setContent:function(a){"object"==typeof a&&null!==a&&this.options.contentCloning&&(a=a.clone(!0)),this.content=a},insertContent:function(){var a=this,b=this.$tooltip.find(".tooltipster-content");"string"!=typeof a.content||a.options.contentAsHTML?b.empty().append(a.content):b.text(a.content)},updateTooltip:function(a){var b=this;b.setContent(a),null!==b.content?"hidden"!==b.status&&(b.insertContent(),b.positionTooltip(),b.options.updateAnimation&&(g()?(b.$tooltip.css({width:"","-webkit-transition":"all "+b.options.speed+"ms, width 0ms, height 0ms, left 0ms, top 0ms","-moz-transition":"all "+b.options.speed+"ms, width 0ms, height 0ms, left 0ms, top 0ms","-o-transition":"all "+b.options.speed+"ms, width 0ms, height 0ms, left 0ms, top 0ms","-ms-transition":"all "+b.options.speed+"ms, width 0ms, height 0ms, left 0ms, top 0ms",transition:"all "+b.options.speed+"ms, width 0ms, height 0ms, left 0ms, top 0ms"}).addClass("tooltipster-content-changing"),setTimeout(function(){"hidden"!=b.status&&(b.$tooltip.removeClass("tooltipster-content-changing"),setTimeout(function(){"hidden"!==b.status&&b.$tooltip.css({"-webkit-transition":b.options.speed+"ms","-moz-transition":b.options.speed+"ms","-o-transition":b.options.speed+"ms","-ms-transition":b.options.speed+"ms",transition:b.options.speed+"ms"})},b.options.speed))},b.options.speed)):b.$tooltip.fadeTo(b.options.speed,.5,function(){"hidden"!=b.status&&b.$tooltip.fadeTo(b.options.speed,1)}))):b.hideTooltip()},positionInfo:function(a){return{dimension:{height:a.outerHeight(!1),width:a.outerWidth(!1)},offset:a.offset(),position:{left:parseInt(a.css("left")),top:parseInt(a.css("top"))}}},positionTooltip:function(){function c(){var c=a(b).scrollLeft();D-c<0&&(f=D-c,D=c),D+j-c>g&&(f=D-(g+c-j),D=g+c-j)}function d(c,d){h.offset.top-a(b).scrollTop()-l-G-12<0&&d.indexOf("top")>-1&&(I=c),h.offset.top+h.dimension.height+l+12+G>a(b).scrollTop()+a(b).height()&&d.indexOf("bottom")>-1&&(I=c,F=h.offset.top-l-G-12)}var e=this;if(0!==a("body").find(e.$tooltip).length){e.$tooltip.css("width",""),e.elProxyPosition=e.positionInfo(e.$elProxy);var f=null,g=a(b).width(),h=e.elProxyPosition,j=e.$tooltip.outerWidth(!1),k=e.$tooltip.innerWidth()+1,l=e.$tooltip.outerHeight(!1);if(e.$elProxy.is("area")){var m=e.$elProxy.attr("shape"),n=e.$elProxy.parent().attr("name"),o=a('img[usemap="#'+n+'"]'),p=o.offset().left,q=o.offset().top,r=void 0!==e.$elProxy.attr("coords")?e.$elProxy.attr("coords").split(","):void 0;if("circle"==m){var s=parseInt(r[0]),t=parseInt(r[1]),u=parseInt(r[2]);h.dimension.height=2*u,h.dimension.width=2*u,h.offset.top=q+t-u,h.offset.left=p+s-u}else if("rect"==m){var s=parseInt(r[0]),t=parseInt(r[1]),v=parseInt(r[2]),w=parseInt(r[3]);h.dimension.height=w-t,h.dimension.width=v-s,h.offset.top=q+t,h.offset.left=p+s}else if("poly"==m){var x=0,y=0,z=0,A=0,B="even";for(i=0;i<r.length;i++){var C=parseInt(r[i]);"even"==B?(C>z&&(z=C,0===i&&(x=z)),C<x&&(x=C),B="odd"):(C>A&&(A=C,1==i&&(y=A)),C<y&&(y=C),B="even")}h.dimension.height=A-y,h.dimension.width=z-x,h.offset.top=q+y,h.offset.left=p+x}else h.dimension.height=o.outerHeight(!1),h.dimension.width=o.outerWidth(!1),h.offset.top=q,h.offset.left=p}0===e.options.fixedWidth&&e.$tooltip.css({width:Math.round(k)+"px","padding-left":"0px","padding-right":"0px"});var D=0,E=0,F=0,G=parseInt(e.options.offsetY),H=parseInt(e.options.offsetX),I=e.options.position;if("top"==I){var J=h.offset.left+j-(h.offset.left+h.dimension.width);D=h.offset.left+H-J/2,F=h.offset.top-l-G-12,c(),d("bottom","top")}if("top-left"==I&&(D=h.offset.left+H,F=h.offset.top-l-G-12,c(),d("bottom-left","top-left")),"top-right"==I&&(D=h.offset.left+h.dimension.width+H-j,F=h.offset.top-l-G-12,c(),d("bottom-right","top-right")),"bottom"==I){var J=h.offset.left+j-(h.offset.left+h.dimension.width);D=h.offset.left-J/2+H,F=h.offset.top+h.dimension.height+G+12,c(),d("top","bottom")}if("bottom-left"==I&&(D=h.offset.left+H,F=h.offset.top+h.dimension.height+G+12,c(),d("top-left","bottom-left")),"bottom-right"==I&&(D=h.offset.left+h.dimension.width+H-j,F=h.offset.top+h.dimension.height+G+12,c(),d("top-right","bottom-right")),"left"==I){D=h.offset.left-H-j-12,E=h.offset.left+H+h.dimension.width+12;var K=h.offset.top+l-(h.offset.top+e.$elProxy.outerHeight(!1));if(F=h.offset.top-K/2-G,D<0&&E+j>g){var L=2*parseFloat(e.$tooltip.css("border-width")),M=j+D-L;e.$tooltip.css("width",M+"px"),l=e.$tooltip.outerHeight(!1),D=h.offset.left-H-M-12-L,K=h.offset.top+l-(h.offset.top+e.$elProxy.outerHeight(!1)),F=h.offset.top-K/2-G}else D<0&&(D=h.offset.left+H+h.dimension.width+12,f="left")}if("right"==I){D=h.offset.left+H+h.dimension.width+12,E=h.offset.left-H-j-12;var K=h.offset.top+l-(h.offset.top+e.$elProxy.outerHeight(!1));if(F=h.offset.top-K/2-G,D+j>g&&E<0){var L=2*parseFloat(e.$tooltip.css("border-width")),M=g-D-L;e.$tooltip.css("width",M+"px"),l=e.$tooltip.outerHeight(!1),K=h.offset.top+l-(h.offset.top+e.$elProxy.outerHeight(!1)),F=h.offset.top-K/2-G}else D+j>g&&(D=h.offset.left-H-j-12,f="right")}if(e.options.arrow){var N="tooltipster-arrow-"+I;if(e.options.arrowColor.length<1)var O=e.$tooltip.css("background-color");else var O=e.options.arrowColor;if(f?"left"==f?(N="tooltipster-arrow-right",f=""):"right"==f?(N="tooltipster-arrow-left",f=""):f="left:"+Math.round(f)+"px;":f="","top"==I||"top-left"==I||"top-right"==I)var P=parseFloat(e.$tooltip.css("border-bottom-width")),Q=e.$tooltip.css("border-bottom-color");else if("bottom"==I||"bottom-left"==I||"bottom-right"==I)var P=parseFloat(e.$tooltip.css("border-top-width")),Q=e.$tooltip.css("border-top-color");else if("left"==I)var P=parseFloat(e.$tooltip.css("border-right-width")),Q=e.$tooltip.css("border-right-color");else if("right"==I)var P=parseFloat(e.$tooltip.css("border-left-width")),Q=e.$tooltip.css("border-left-color");else var P=parseFloat(e.$tooltip.css("border-bottom-width")),Q=e.$tooltip.css("border-bottom-color");P>1&&P++;var R="";if(0!==P){var S="",T="border-color: "+Q+";";N.indexOf("bottom")!==-1?S="margin-top: -"+Math.round(P)+"px;":N.indexOf("top")!==-1?S="margin-bottom: -"+Math.round(P)+"px;":N.indexOf("left")!==-1?S="margin-right: -"+Math.round(P)+"px;":N.indexOf("right")!==-1&&(S="margin-left: -"+Math.round(P)+"px;"),R='<span class="tooltipster-arrow-border" style="'+S+" "+T+';"></span>'}e.$tooltip.find(".tooltipster-arrow").remove();var U='<div class="'+N+' tooltipster-arrow" style="'+f+'">'+R+'<span style="border-color:'+O+';"></span></div>';e.$tooltip.append(U)}e.$tooltip.css({top:Math.round(F)+"px",left:Math.round(D)+"px"})}}},a.fn[h]=function(){var b=arguments;if(0===this.length){if("string"==typeof b[0]){var c=!0;switch(b[0]){case"setDefaults":a.extend(j,b[1]);break;default:c=!1}return!!c||this}return this}if("string"==typeof b[0]){var e="#*$~&";return this.each(function(){var c=a(this).data("tooltipster");if(!c)throw new Error("You called Tooltipster's \""+b[0]+'" method on an uninitialized element');switch(b[0]){case"content":case"update":if("undefined"==typeof b[1])return e=c.content,!1;c.updateTooltip(b[1]);break;case"destroy":c.hideTooltip(),c.$el[0]!==c.$elProxy[0]&&c.$elProxy.remove();var d="string"==typeof c.content?c.content:a("<div></div>").append(c.content).html();c.$el.removeClass("tooltipstered").attr("title",d).removeData("tooltipster").off("."+c.namespace);break;case"disable":c.hideTooltip(),c.enabled=!1;break;case"elementIcon":return e=c.$el[0]!==c.$elProxy[0]?c.$elProxy[0]:void 0,!1;case"elementTooltip":return e=c.$tooltip?c.$tooltip[0]:void 0,!1;case"enable":c.enabled=!0;break;case"hide":c.hideTooltip();break;case"option":e=c.options[b[1]];break;case"reposition":c.positionTooltip();break;case"show":c.showTooltipNow();break;case"status":return e=c.status,!1;default:throw new Error('Unknown method .tooltipster("'+b[0]+'")')}}),"#*$~&"!==e?e:this}return this.each(function(){a(this).data("tooltipster")||a(this).data("tooltipster",new d(this,b[0]))})};var k=!!("ontouchstart"in b),l=!1;a("body").one("mousemove",function(){l=!0})}(jQuery,window,document);
;/*! fancyBox v2.1.5 fancyapps.com | fancyapps.com/fancybox/#license */
(function(r,G,f,v){var J=f("html"),n=f(r),p=f(G),b=f.fancybox=function(){b.open.apply(this,arguments)},I=navigator.userAgent.match(/msie/i),B=null,s=G.createTouch!==v,t=function(a){return a&&a.hasOwnProperty&&a instanceof f},q=function(a){return a&&"string"===f.type(a)},E=function(a){return q(a)&&0<a.indexOf("%")},l=function(a,d){var e=parseInt(a,10)||0;d&&E(a)&&(e*=b.getViewport()[d]/100);return Math.ceil(e)},w=function(a,b){return l(a,b)+"px"};f.extend(b,{version:"2.1.5",defaults:{padding:15,margin:20,width:800,height:600,minWidth:100,minHeight:100,maxWidth:9999,maxHeight:9999,pixelRatio:1,autoSize:!0,autoHeight:!1,autoWidth:!1,autoResize:!0,autoCenter:!s,fitToView:!0,aspectRatio:!1,topRatio:0.5,leftRatio:0.5,scrolling:"auto",wrapCSS:"",arrows:!0,closeBtn:!0,closeClick:!1,nextClick:!1,mouseWheel:!0,autoPlay:!1,playSpeed:3E3,preload:3,modal:!1,loop:!0,ajax:{dataType:"html",headers:{"X-fancyBox":!0}},iframe:{scrolling:"auto",preload:!0},swf:{wmode:"transparent",allowfullscreen:"true",allowscriptaccess:"always"},keys:{next:{13:"left",34:"up",39:"left",40:"up"},prev:{8:"right",33:"down",37:"right",38:"down"},close:[27],play:[32],toggle:[70]},direction:{next:"left",prev:"right"},scrollOutside:!0,index:0,type:null,href:null,content:null,title:null,tpl:{wrap:'<div class="fancybox-wrap" tabIndex="-1"><div class="fancybox-skin"><div class="fancybox-outer"><div class="fancybox-inner"></div></div></div></div>',image:'<img class="fancybox-image" src="{href}" alt="" />',iframe:'<iframe id="fancybox-frame{rnd}" name="fancybox-frame{rnd}" class="fancybox-iframe" frameborder="0" vspace="0" hspace="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen'+
(I?' allowtransparency="true"':"")+"></iframe>",error:'<p class="fancybox-error">The requested content cannot be loaded.<br/>Please try again later.</p>',closeBtn:'<a title="Close" class="fancybox-item fancybox-close" href="javascript:;"></a>',next:'<a title="Next" class="fancybox-nav fancybox-next" href="javascript:;"><span></span></a>',prev:'<a title="Previous" class="fancybox-nav fancybox-prev" href="javascript:;"><span></span></a>'},openEffect:"fade",openSpeed:250,openEasing:"swing",openOpacity:!0,openMethod:"zoomIn",closeEffect:"fade",closeSpeed:250,closeEasing:"swing",closeOpacity:!0,closeMethod:"zoomOut",nextEffect:"elastic",nextSpeed:250,nextEasing:"swing",nextMethod:"changeIn",prevEffect:"elastic",prevSpeed:250,prevEasing:"swing",prevMethod:"changeOut",helpers:{overlay:!0,title:!0},onCancel:f.noop,beforeLoad:f.noop,afterLoad:f.noop,beforeShow:f.noop,afterShow:f.noop,beforeChange:f.noop,beforeClose:f.noop,afterClose:f.noop},group:{},opts:{},previous:null,coming:null,current:null,isActive:!1,isOpen:!1,isOpened:!1,wrap:null,skin:null,outer:null,inner:null,player:{timer:null,isActive:!1},ajaxLoad:null,imgPreload:null,transitions:{},helpers:{},open:function(a,d){if(a&&(f.isPlainObject(d)||(d={}),!1!==b.close(!0)))return f.isArray(a)||(a=t(a)?f(a).get():[a]),f.each(a,function(e,c){var k={},g,h,j,m,l;"object"===f.type(c)&&(c.nodeType&&(c=f(c)),t(c)?(k={href:c.data("fancybox-href")||c.attr("href"),title:c.data("fancybox-title")||c.attr("title"),isDom:!0,element:c},f.metadata&&f.extend(!0,k,c.metadata())):k=c);g=d.href||k.href||(q(c)?c:null);h=d.title!==v?d.title:k.title||"";m=(j=d.content||k.content)?"html":d.type||k.type;!m&&k.isDom&&(m=c.data("fancybox-type"),m||(m=(m=c.prop("class").match(/fancybox\.(\w+)/))?m[1]:null));q(g)&&(m||(b.isImage(g)?m="image":b.isSWF(g)?m="swf":"#"===g.charAt(0)?m="inline":q(c)&&(m="html",j=c)),"ajax"===m&&(l=g.split(/\s+/,2),g=l.shift(),l=l.shift()));j||("inline"===m?g?j=f(q(g)?g.replace(/.*(?=#[^\s]+$)/,""):g):k.isDom&&(j=c):"html"===m?j=g:!m&&(!g&&k.isDom)&&(m="inline",j=c));f.extend(k,{href:g,type:m,content:j,title:h,selector:l});a[e]=k}),b.opts=f.extend(!0,{},b.defaults,d),d.keys!==v&&(b.opts.keys=d.keys?f.extend({},b.defaults.keys,d.keys):!1),b.group=a,b._start(b.opts.index)},cancel:function(){var a=b.coming;a&&!1!==b.trigger("onCancel")&&(b.hideLoading(),b.ajaxLoad&&b.ajaxLoad.abort(),b.ajaxLoad=null,b.imgPreload&&(b.imgPreload.onload=b.imgPreload.onerror=null),a.wrap&&a.wrap.stop(!0,!0).trigger("onReset").remove(),b.coming=null,b.current||b._afterZoomOut(a))},close:function(a){b.cancel();!1!==b.trigger("beforeClose")&&(b.unbindEvents(),b.isActive&&(!b.isOpen||!0===a?(f(".fancybox-wrap").stop(!0).trigger("onReset").remove(),b._afterZoomOut()):(b.isOpen=b.isOpened=!1,b.isClosing=!0,f(".fancybox-item, .fancybox-nav").remove(),b.wrap.stop(!0,!0).removeClass("fancybox-opened"),b.transitions[b.current.closeMethod]())))},play:function(a){var d=function(){clearTimeout(b.player.timer)},e=function(){d();b.current&&b.player.isActive&&(b.player.timer=setTimeout(b.next,b.current.playSpeed))},c=function(){d();p.unbind(".player");b.player.isActive=!1;b.trigger("onPlayEnd")};if(!0===a||!b.player.isActive&&!1!==a){if(b.current&&(b.current.loop||b.current.index<b.group.length-1))b.player.isActive=!0,p.bind({"onCancel.player beforeClose.player":c,"onUpdate.player":e,"beforeLoad.player":d}),e(),b.trigger("onPlayStart")}else c()},next:function(a){var d=b.current;d&&(q(a)||(a=d.direction.next),b.jumpto(d.index+1,a,"next"))},prev:function(a){var d=b.current;d&&(q(a)||(a=d.direction.prev),b.jumpto(d.index-1,a,"prev"))},jumpto:function(a,d,e){var c=b.current;c&&(a=l(a),b.direction=d||c.direction[a>=c.index?"next":"prev"],b.router=e||"jumpto",c.loop&&(0>a&&(a=c.group.length+a%c.group.length),a%=c.group.length),c.group[a]!==v&&(b.cancel(),b._start(a)))},reposition:function(a,d){var e=b.current,c=e?e.wrap:null,k;c&&(k=b._getPosition(d),a&&"scroll"===a.type?(delete k.position,c.stop(!0,!0).animate(k,200)):(c.css(k),e.pos=f.extend({},e.dim,k)))},update:function(a){var d=a&&a.type,e=!d||"orientationchange"===d;e&&(clearTimeout(B),B=null);b.isOpen&&!B&&(B=setTimeout(function(){var c=b.current;c&&!b.isClosing&&(b.wrap.removeClass("fancybox-tmp"),(e||"load"===d||"resize"===d&&c.autoResize)&&b._setDimension(),"scroll"===d&&c.canShrink||b.reposition(a),b.trigger("onUpdate"),B=null)},e&&!s?0:300))},toggle:function(a){b.isOpen&&(b.current.fitToView="boolean"===f.type(a)?a:!b.current.fitToView,s&&(b.wrap.removeAttr("style").addClass("fancybox-tmp"),b.trigger("onUpdate")),b.update())},hideLoading:function(){p.unbind(".loading");f("#fancybox-loading").remove()},showLoading:function(){var a,d;b.hideLoading();a=f('<div id="fancybox-loading"><div></div></div>').click(b.cancel).appendTo("body");p.bind("keydown.loading",function(a){if(27===(a.which||a.keyCode))a.preventDefault(),b.cancel()});b.defaults.fixed||(d=b.getViewport(),a.css({position:"absolute",top:0.5*d.h+d.y,left:0.5*d.w+d.x}))},getViewport:function(){var a=b.current&&b.current.locked||!1,d={x:n.scrollLeft(),y:n.scrollTop()};a?(d.w=a[0].clientWidth,d.h=a[0].clientHeight):(d.w=s&&r.innerWidth?r.innerWidth:n.width(),d.h=s&&r.innerHeight?r.innerHeight:n.height());return d},unbindEvents:function(){b.wrap&&t(b.wrap)&&b.wrap.unbind(".fb");p.unbind(".fb");n.unbind(".fb")},bindEvents:function(){var a=b.current,d;a&&(n.bind("orientationchange.fb"+(s?"":" resize.fb")+(a.autoCenter&&!a.locked?" scroll.fb":""),b.update),(d=a.keys)&&p.bind("keydown.fb",function(e){var c=e.which||e.keyCode,k=e.target||e.srcElement;if(27===c&&b.coming)return!1;!e.ctrlKey&&(!e.altKey&&!e.shiftKey&&!e.metaKey&&(!k||!k.type&&!f(k).is("[contenteditable]")))&&f.each(d,function(d,k){if(1<a.group.length&&k[c]!==v)return b[d](k[c]),e.preventDefault(),!1;if(-1<f.inArray(c,k))return b[d](),e.preventDefault(),!1})}),f.fn.mousewheel&&a.mouseWheel&&b.wrap.bind("mousewheel.fb",function(d,c,k,g){for(var h=f(d.target||null),j=!1;h.length&&!j&&!h.is(".fancybox-skin")&&!h.is(".fancybox-wrap");)j=h[0]&&!(h[0].style.overflow&&"hidden"===h[0].style.overflow)&&(h[0].clientWidth&&h[0].scrollWidth>h[0].clientWidth||h[0].clientHeight&&h[0].scrollHeight>h[0].clientHeight),h=f(h).parent();if(0!==c&&!j&&1<b.group.length&&!a.canShrink){if(0<g||0<k)b.prev(0<g?"down":"left");else if(0>g||0>k)b.next(0>g?"up":"right");d.preventDefault()}}))},trigger:function(a,d){var e,c=d||b.coming||b.current;if(c){f.isFunction(c[a])&&(e=c[a].apply(c,Array.prototype.slice.call(arguments,1)));if(!1===e)return!1;c.helpers&&f.each(c.helpers,function(d,e){if(e&&b.helpers[d]&&f.isFunction(b.helpers[d][a]))b.helpers[d][a](f.extend(!0,{},b.helpers[d].defaults,e),c)});p.trigger(a)}},isImage:function(a){return q(a)&&a.match(/(^data:image\/.*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg)((\?|#).*)?$)/i)},isSWF:function(a){return q(a)&&a.match(/\.(swf)((\?|#).*)?$/i)},_start:function(a){var d={},e,c;a=l(a);e=b.group[a]||null;if(!e)return!1;d=f.extend(!0,{},b.opts,e);e=d.margin;c=d.padding;"number"===f.type(e)&&(d.margin=[e,e,e,e]);"number"===f.type(c)&&(d.padding=[c,c,c,c]);d.modal&&f.extend(!0,d,{closeBtn:!1,closeClick:!1,nextClick:!1,arrows:!1,mouseWheel:!1,keys:null,helpers:{overlay:{closeClick:!1}}});d.autoSize&&(d.autoWidth=d.autoHeight=!0);"auto"===d.width&&(d.autoWidth=!0);"auto"===d.height&&(d.autoHeight=!0);d.group=b.group;d.index=a;b.coming=d;if(!1===b.trigger("beforeLoad"))b.coming=null;else{c=d.type;e=d.href;if(!c)return b.coming=null,b.current&&b.router&&"jumpto"!==b.router?(b.current.index=a,b[b.router](b.direction)):!1;b.isActive=!0;if("image"===c||"swf"===c)d.autoHeight=d.autoWidth=!1,d.scrolling="visible";"image"===c&&(d.aspectRatio=!0);"iframe"===c&&s&&(d.scrolling="scroll");d.wrap=f(d.tpl.wrap).addClass("fancybox-"+(s?"mobile":"desktop")+" fancybox-type-"+c+" fancybox-tmp "+d.wrapCSS).appendTo(d.parent||"body");f.extend(d,{skin:f(".fancybox-skin",d.wrap),outer:f(".fancybox-outer",d.wrap),inner:f(".fancybox-inner",d.wrap)});f.each(["Top","Right","Bottom","Left"],function(a,b){d.skin.css("padding"+b,w(d.padding[a]))});b.trigger("onReady");if("inline"===c||"html"===c){if(!d.content||!d.content.length)return b._error("content")}else if(!e)return b._error("href");"image"===c?b._loadImage():"ajax"===c?b._loadAjax():"iframe"===c?b._loadIframe():b._afterLoad()}},_error:function(a){f.extend(b.coming,{type:"html",autoWidth:!0,autoHeight:!0,minWidth:0,minHeight:0,scrolling:"no",hasError:a,content:b.coming.tpl.error});b._afterLoad()},_loadImage:function(){var a=b.imgPreload=new Image;a.onload=function(){this.onload=this.onerror=null;b.coming.width=this.width/b.opts.pixelRatio;b.coming.height=this.height/b.opts.pixelRatio;b._afterLoad()};a.onerror=function(){this.onload=this.onerror=null;b._error("image")};a.src=b.coming.href;!0!==a.complete&&b.showLoading()},_loadAjax:function(){var a=b.coming;b.showLoading();b.ajaxLoad=f.ajax(f.extend({},a.ajax,{url:a.href,error:function(a,e){b.coming&&"abort"!==e?b._error("ajax",a):b.hideLoading()},success:function(d,e){"success"===e&&(a.content=d,b._afterLoad())}}))},_loadIframe:function(){var a=b.coming,d=f(a.tpl.iframe.replace(/\{rnd\}/g,(new Date).getTime())).attr("scrolling",s?"auto":a.iframe.scrolling).attr("src",a.href);f(a.wrap).bind("onReset",function(){try{f(this).find("iframe").hide().attr("src","//about:blank").end().empty()}catch(a){}});a.iframe.preload&&(b.showLoading(),d.one("load",function(){f(this).data("ready",1);s||f(this).bind("load.fb",b.update);f(this).parents(".fancybox-wrap").width("100%").removeClass("fancybox-tmp").show();b._afterLoad()}));a.content=d.appendTo(a.inner);a.iframe.preload||b._afterLoad()},_preloadImages:function(){var a=b.group,d=b.current,e=a.length,c=d.preload?Math.min(d.preload,e-1):0,f,g;for(g=1;g<=c;g+=1)f=a[(d.index+g)%e],"image"===f.type&&f.href&&((new Image).src=f.href)},_afterLoad:function(){var a=b.coming,d=b.current,e,c,k,g,h;b.hideLoading();if(a&&!1!==b.isActive)if(!1===b.trigger("afterLoad",a,d))a.wrap.stop(!0).trigger("onReset").remove(),b.coming=null;else{d&&(b.trigger("beforeChange",d),d.wrap.stop(!0).removeClass("fancybox-opened").find(".fancybox-item, .fancybox-nav").remove());b.unbindEvents();e=a.content;c=a.type;k=a.scrolling;f.extend(b,{wrap:a.wrap,skin:a.skin,outer:a.outer,inner:a.inner,current:a,previous:d});g=a.href;switch(c){case"inline":case"ajax":case"html":a.selector?e=f("<div>").html(e).find(a.selector):t(e)&&(e.data("fancybox-placeholder")||e.data("fancybox-placeholder",f('<div class="fancybox-placeholder"></div>').insertAfter(e).hide()),e=e.show().detach(),a.wrap.bind("onReset",function(){f(this).find(e).length&&e.hide().replaceAll(e.data("fancybox-placeholder")).data("fancybox-placeholder",!1)}));break;case"image":e=a.tpl.image.replace("{href}",g);break;case"swf":e='<object id="fancybox-swf" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%"><param name="movie" value="'+g+'"></param>',h="",f.each(a.swf,function(a,b){e+='<param name="'+a+'" value="'+b+'"></param>';h+=" "+a+'="'+b+'"'}),e+='<embed src="'+g+'" type="application/x-shockwave-flash" width="100%" height="100%"'+h+"></embed></object>"}(!t(e)||!e.parent().is(a.inner))&&a.inner.append(e);b.trigger("beforeShow");a.inner.css("overflow","yes"===k?"scroll":"no"===k?"hidden":k);b._setDimension();b.reposition();b.isOpen=!1;b.coming=null;b.bindEvents();if(b.isOpened){if(d.prevMethod)b.transitions[d.prevMethod]()}else f(".fancybox-wrap").not(a.wrap).stop(!0).trigger("onReset").remove();b.transitions[b.isOpened?a.nextMethod:a.openMethod]();b._preloadImages()}},_setDimension:function(){var a=b.getViewport(),d=0,e=!1,c=!1,e=b.wrap,k=b.skin,g=b.inner,h=b.current,c=h.width,j=h.height,m=h.minWidth,u=h.minHeight,n=h.maxWidth,p=h.maxHeight,s=h.scrolling,q=h.scrollOutside?h.scrollbarWidth:0,x=h.margin,y=l(x[1]+x[3]),r=l(x[0]+x[2]),v,z,t,C,A,F,B,D,H;e.add(k).add(g).width("auto").height("auto").removeClass("fancybox-tmp");x=l(k.outerWidth(!0)-k.width());v=l(k.outerHeight(!0)-k.height());z=y+x;t=r+v;C=E(c)?(a.w-z)*l(c)/100:c;A=E(j)?(a.h-t)*l(j)/100:j;if("iframe"===h.type){if(H=h.content,h.autoHeight&&1===H.data("ready"))try{H[0].contentWindow.document.location&&(g.width(C).height(9999),F=H.contents().find("body"),q&&F.css("overflow-x","hidden"),A=F.outerHeight(!0))}catch(G){}}else if(h.autoWidth||h.autoHeight)g.addClass("fancybox-tmp"),h.autoWidth||g.width(C),h.autoHeight||g.height(A),h.autoWidth&&(C=g.width()),h.autoHeight&&(A=g.height()),g.removeClass("fancybox-tmp");c=l(C);j=l(A);D=C/A;m=l(E(m)?l(m,"w")-z:m);n=l(E(n)?l(n,"w")-z:n);u=l(E(u)?l(u,"h")-t:u);p=l(E(p)?l(p,"h")-t:p);F=n;B=p;h.fitToView&&(n=Math.min(a.w-z,n),p=Math.min(a.h-t,p));z=a.w-y;r=a.h-r;h.aspectRatio?(c>n&&(c=n,j=l(c/D)),j>p&&(j=p,c=l(j*D)),c<m&&(c=m,j=l(c/D)),j<u&&(j=u,c=l(j*D))):(c=Math.max(m,Math.min(c,n)),h.autoHeight&&"iframe"!==h.type&&(g.width(c),j=g.height()),j=Math.max(u,Math.min(j,p)));if(h.fitToView)if(g.width(c).height(j),e.width(c+x),a=e.width(),y=e.height(),h.aspectRatio)for(;(a>z||y>r)&&(c>m&&j>u)&&!(19<d++);)j=Math.max(u,Math.min(p,j-10)),c=l(j*D),c<m&&(c=m,j=l(c/D)),c>n&&(c=n,j=l(c/D)),g.width(c).height(j),e.width(c+x),a=e.width(),y=e.height();else c=Math.max(m,Math.min(c,c-(a-z))),j=Math.max(u,Math.min(j,j-(y-r)));q&&("auto"===s&&j<A&&c+x+q<z)&&(c+=q);g.width(c).height(j);e.width(c+x);a=e.width();y=e.height();e=(a>z||y>r)&&c>m&&j>u;c=h.aspectRatio?c<F&&j<B&&c<C&&j<A:(c<F||j<B)&&(c<C||j<A);f.extend(h,{dim:{width:w(a),height:w(y)},origWidth:C,origHeight:A,canShrink:e,canExpand:c,wPadding:x,hPadding:v,wrapSpace:y-k.outerHeight(!0),skinSpace:k.height()-j});!H&&(h.autoHeight&&j>u&&j<p&&!c)&&g.height("auto")},_getPosition:function(a){var d=b.current,e=b.getViewport(),c=d.margin,f=b.wrap.width()+c[1]+c[3],g=b.wrap.height()+c[0]+c[2],c={position:"absolute",top:c[0],left:c[3]};d.autoCenter&&d.fixed&&!a&&g<=e.h&&f<=e.w?c.position="fixed":d.locked||(c.top+=e.y,c.left+=e.x);c.top=w(Math.max(c.top,c.top+(e.h-g)*d.topRatio));c.left=w(Math.max(c.left,c.left+(e.w-f)*d.leftRatio));return c},_afterZoomIn:function(){var a=b.current;a&&(b.isOpen=b.isOpened=!0,b.wrap.css("overflow","visible").addClass("fancybox-opened"),b.update(),(a.closeClick||a.nextClick&&1<b.group.length)&&b.inner.css("cursor","pointer").bind("click.fb",function(d){!f(d.target).is("a")&&!f(d.target).parent().is("a")&&(d.preventDefault(),b[a.closeClick?"close":"next"]())}),a.closeBtn&&f(a.tpl.closeBtn).appendTo(b.skin).bind("click.fb",function(a){a.preventDefault();b.close()}),a.arrows&&1<b.group.length&&((a.loop||0<a.index)&&f(a.tpl.prev).appendTo(b.outer).bind("click.fb",b.prev),(a.loop||a.index<b.group.length-1)&&f(a.tpl.next).appendTo(b.outer).bind("click.fb",b.next)),b.trigger("afterShow"),!a.loop&&a.index===a.group.length-1?b.play(!1):b.opts.autoPlay&&!b.player.isActive&&(b.opts.autoPlay=!1,b.play()))},_afterZoomOut:function(a){a=a||b.current;f(".fancybox-wrap").trigger("onReset").remove();f.extend(b,{group:{},opts:{},router:!1,current:null,isActive:!1,isOpened:!1,isOpen:!1,isClosing:!1,wrap:null,skin:null,outer:null,inner:null});b.trigger("afterClose",a)}});b.transitions={getOrigPosition:function(){var a=b.current,d=a.element,e=a.orig,c={},f=50,g=50,h=a.hPadding,j=a.wPadding,m=b.getViewport();!e&&(a.isDom&&d.is(":visible"))&&(e=d.find("img:first"),e.length||(e=d));t(e)?(c=e.offset(),e.is("img")&&(f=e.outerWidth(),g=e.outerHeight())):(c.top=m.y+(m.h-g)*a.topRatio,c.left=m.x+(m.w-f)*a.leftRatio);if("fixed"===b.wrap.css("position")||a.locked)c.top-=m.y,c.left-=m.x;return c={top:w(c.top-h*a.topRatio),left:w(c.left-j*a.leftRatio),width:w(f+j),height:w(g+h)}},step:function(a,d){var e,c,f=d.prop;c=b.current;var g=c.wrapSpace,h=c.skinSpace;if("width"===f||"height"===f)e=d.end===d.start?1:(a-d.start)/(d.end-d.start),b.isClosing&&(e=1-e),c="width"===f?c.wPadding:c.hPadding,c=a-c,b.skin[f](l("width"===f?c:c-g*e)),b.inner[f](l("width"===f?c:c-g*e-h*e))},zoomIn:function(){var a=b.current,d=a.pos,e=a.openEffect,c="elastic"===e,k=f.extend({opacity:1},d);delete k.position;c?(d=this.getOrigPosition(),a.openOpacity&&(d.opacity=0.1)):"fade"===e&&(d.opacity=0.1);b.wrap.css(d).animate(k,{duration:"none"===e?0:a.openSpeed,easing:a.openEasing,step:c?this.step:null,complete:b._afterZoomIn})},zoomOut:function(){var a=b.current,d=a.closeEffect,e="elastic"===d,c={opacity:0.1};e&&(c=this.getOrigPosition(),a.closeOpacity&&(c.opacity=0.1));b.wrap.animate(c,{duration:"none"===d?0:a.closeSpeed,easing:a.closeEasing,step:e?this.step:null,complete:b._afterZoomOut})},changeIn:function(){var a=b.current,d=a.nextEffect,e=a.pos,c={opacity:1},f=b.direction,g;e.opacity=0.1;"elastic"===d&&(g="down"===f||"up"===f?"top":"left","down"===f||"right"===f?(e[g]=w(l(e[g])-200),c[g]="+=200px"):(e[g]=w(l(e[g])+200),c[g]="-=200px"));"none"===d?b._afterZoomIn():b.wrap.css(e).animate(c,{duration:a.nextSpeed,easing:a.nextEasing,complete:b._afterZoomIn})},changeOut:function(){var a=b.previous,d=a.prevEffect,e={opacity:0.1},c=b.direction;"elastic"===d&&(e["down"===c||"up"===c?"top":"left"]=("up"===c||"left"===c?"-":"+")+"=200px");a.wrap.animate(e,{duration:"none"===d?0:a.prevSpeed,easing:a.prevEasing,complete:function(){f(this).trigger("onReset").remove()}})}};b.helpers.overlay={defaults:{closeClick:!0,speedOut:200,showEarly:!0,css:{},locked:!s,fixed:!0},overlay:null,fixed:!1,el:f("html"),create:function(a){a=f.extend({},this.defaults,a);this.overlay&&this.close();this.overlay=f('<div class="fancybox-overlay"></div>').appendTo(b.coming?b.coming.parent:a.parent);this.fixed=!1;a.fixed&&b.defaults.fixed&&(this.overlay.addClass("fancybox-overlay-fixed"),this.fixed=!0)},open:function(a){var d=this;a=f.extend({},this.defaults,a);this.overlay?this.overlay.unbind(".overlay").width("auto").height("auto"):this.create(a);this.fixed||(n.bind("resize.overlay",f.proxy(this.update,this)),this.update());a.closeClick&&this.overlay.bind("click.overlay",function(a){if(f(a.target).hasClass("fancybox-overlay"))return b.isActive?b.close():d.close(),!1});this.overlay.css(a.css).show()},close:function(){var a,b;n.unbind("resize.overlay");this.el.hasClass("fancybox-lock")&&(f(".fancybox-margin").removeClass("fancybox-margin"),a=n.scrollTop(),b=n.scrollLeft(),this.el.removeClass("fancybox-lock"),n.scrollTop(a).scrollLeft(b));f(".fancybox-overlay").remove().hide();f.extend(this,{overlay:null,fixed:!1})},update:function(){var a="100%",b;this.overlay.width(a).height("100%");I?(b=Math.max(G.documentElement.offsetWidth,G.body.offsetWidth),p.width()>b&&(a=p.width())):p.width()>n.width()&&(a=p.width());this.overlay.width(a).height(p.height())},onReady:function(a,b){var e=this.overlay;f(".fancybox-overlay").stop(!0,!0);e||this.create(a);a.locked&&(this.fixed&&b.fixed)&&(e||(this.margin=p.height()>n.height()?f("html").css("margin-right").replace("px",""):!1),b.locked=this.overlay.append(b.wrap),b.fixed=!1);!0===a.showEarly&&this.beforeShow.apply(this,arguments)},beforeShow:function(a,b){var e,c;b.locked&&(!1!==this.margin&&(f("*").filter(function(){return"fixed"===f(this).css("position")&&!f(this).hasClass("fancybox-overlay")&&!f(this).hasClass("fancybox-wrap")}).addClass("fancybox-margin"),this.el.addClass("fancybox-margin")),e=n.scrollTop(),c=n.scrollLeft(),this.el.addClass("fancybox-lock"),n.scrollTop(e).scrollLeft(c));this.open(a)},onUpdate:function(){this.fixed||this.update()},afterClose:function(a){this.overlay&&!b.coming&&this.overlay.fadeOut(a.speedOut,f.proxy(this.close,this))}};b.helpers.title={defaults:{type:"float",position:"bottom"},beforeShow:function(a){var d=b.current,e=d.title,c=a.type;f.isFunction(e)&&(e=e.call(d.element,d));if(q(e)&&""!==f.trim(e)){d=f('<div class="fancybox-title fancybox-title-'+c+'-wrap">'+e+"</div>");switch(c){case"inside":c=b.skin;break;case"outside":c=b.wrap;break;case"over":c=b.inner;break;default:c=b.skin,d.appendTo("body"),I&&d.width(d.width()),d.wrapInner('<span class="child"></span>'),b.current.margin[2]+=Math.abs(l(d.css("margin-bottom")))}d["top"===a.position?"prependTo":"appendTo"](c)}}};f.fn.fancybox=function(a){var d,e=f(this),c=this.selector||"",k=function(g){var h=f(this).blur(),j=d,k,l;!g.ctrlKey&&(!g.altKey&&!g.shiftKey&&!g.metaKey)&&!h.is(".fancybox-wrap")&&(k=a.groupAttr||"data-fancybox-group",l=h.attr(k),l||(k="rel",l=h.get(0)[k]),l&&(""!==l&&"nofollow"!==l)&&(h=c.length?f(c):e,h=h.filter("["+k+'="'+l+'"]'),j=h.index(this)),a.index=j,!1!==b.open(h,a)&&g.preventDefault())};a=a||{};d=a.index||0;!c||!1===a.live?e.unbind("click.fb-start").bind("click.fb-start",k):p.undelegate(c,"click.fb-start").delegate(c+":not('.fancybox-item, .fancybox-nav')","click.fb-start",k);this.filter("[data-fancybox-start=1]").trigger("click");return this};p.ready(function(){var a,d;f.scrollbarWidth===v&&(f.scrollbarWidth=function(){var a=f('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body"),b=a.children(),b=b.innerWidth()-b.height(99).innerWidth();a.remove();return b});if(f.support.fixedPosition===v){a=f.support;d=f('<div style="position:fixed;top:20px;"></div>').appendTo("body");var e=20===d[0].offsetTop||15===d[0].offsetTop;d.remove();a.fixedPosition=e}f.extend(b.defaults,{scrollbarWidth:f.scrollbarWidth(),fixed:f.support.fixedPosition,parent:f("body")});a=f(r).width();J.addClass("fancybox-lock-test");d=f(r).width();J.removeClass("fancybox-lock-test");f("<style type='text/css'>.fancybox-margin{margin-right:"+(d-a)+"px;}</style>").appendTo("head")})})(window,document,jQuery);;var jq=$=jQuery.noConflict();window.Code=window.Code||{Util:false,PhotoSwipe:false};window.BuddyBoss_Media_Util=(function(window,jq,opt,undefined){var $window=jq(window);var Util={state:opt,lang:function(key){var key=key||'undefined key!';return opt[key]||'Language key missing for: '+key;}}
var resizeThrottle;function checkMobile(){if(!Util.state.isMobile&&$window.width()<=800){Util.state.isMobile=true;}
else if(!Util.state.isMobile){Util.state.isMobile=false;}}
checkMobile();$window.on('resize orientationchange',function(){clearTimeout(resizeThrottle);resizeThrottle=setTimeout(checkMobile,75);});return Util;}
(window,window.jQuery,window.BuddyBoss_Media_Appstate||{}));window.Code.BuddyBossSwiper=(function(window,PhotoSwipe_Util,PhotoSwipe,BuddyBoss_Media_Util){if(!PhotoSwipe_Util||!PhotoSwipe){return false;}
var
$buddyboss_photo_grid=jq('#buddyboss-media-grid'),$document=jq(document),buddyboss_mediawipe=false,current_photo_permalink,current_photo_activity_text,$caption,$comment_link,comment_count,favorite_count,favorite_class,photo_id;buddyboss_mediawipe_options={preventSlideshow:true,imageScaleMethod:'fitNoUpscale',loop:false,captionAndToolbarAutoHideDelay:0,getToolbar:function(){return'<div class="ps-toolbar-close"><div class="ps-toolbar-content"></div></div><div class="ps-toolbar-favorite"><div class="ps-toolbar-content"></div><div class="ps-favorite-count"></div></div><div class="ps-toolbar-comments"><div class="ps-toolbar-content"></div><div class="ps-comments-count"></div></div><div class="ps-toolbar-delete"><div class="ps-toolbar-content loading" style="display:none"><i class="fa fa-spinner fa-spin"></i></div><div class="ps-toolbar-content real"></div></div><div class="ps-toolbar-previous ps-toolbar-previous-disabled"><div class="ps-toolbar-content"></div></div><div class="ps-toolbar-next"><div class="ps-toolbar-content"></div></div>';},getImageCaption:function(el){var $pic=jq(el);var $comment,$caption;current_photo_permalink='#';current_photo_activity_text='';if($pic.find('img,i').length==0)
return'';current_photo_permalink=$pic.find('img,i')[0].getAttribute('data-permalink');current_photo_owner=$pic.find('img,i')[0].getAttribute('data-owner');current_photo_media=$pic.find('img,i')[0].getAttribute('data-media');current_photo_link_elm=$pic;comment_count=$pic.find('img,i')[0].getAttribute('data-comment-count');favorite_count=$pic.find('img,i')[0].getAttribute('data-favorite-count');favorite_class=$pic.find('img,i')[0].getAttribute('data-bbmfav');photo_id=$pic.find('img,i')[0].getAttribute('data-photo-id');if(jq('#bbmedia-grid-wrapper').length>0){if($pic.closest('.bbmedia-grid-item').length>0){var caption_div=$pic.closest('.bbmedia-grid-item');}else if($pic.closest('.photo-item-wrapper').length>0){var caption_div=$pic.closest('.photo-item-wrapper');}
if(jq(caption_div).length>0){$caption=jq(caption_div).find('.buddyboss_media_caption');$comment=$caption.find('.buddyboss_media_caption_body');$comment.find('a').remove();current_photo_activity_text=$comment.text();if(current_photo_activity_text.replace(/\s/g,'')===''){current_photo_activity_text=$caption.find('.buddyboss_media_caption_action').text();}}}
else{var comment_content_class='';var comment_header_class='';if($pic.parents('.activity-inner').length!=0){comment_content_class='activity-inner';comment_header_class='activity-header';}else if($pic.parents('.acomment-content').length!=0){comment_content_class='acomment-content';comment_header_class='acomment-meta';}else if($pic.parents('.bbp-reply-content').length!=0){comment_content_class='bbp-reply-content';comment_header_class='bbp-reply-content p';}
if(''!=comment_header_class){$comment=$pic.parents('.'+comment_content_class).clone();$comment.find('a').remove();current_photo_activity_text=$comment.text();if(current_photo_activity_text.replace(/\s/g,'')===''){current_photo_activity_text=$pic.parents('.'+comment_content_class).find('.'+comment_header_class).text();}}}
return jq.trim(current_photo_activity_text);},getImageMetaData:function(el){return{href:current_photo_permalink,caption:current_photo_activity_text,owner:current_photo_owner,media:current_photo_media,link_elm:current_photo_link_elm,comment_count:comment_count,favorite_count:favorite_count,favorite_class:favorite_class,photo_id:photo_id};}};BuddyBossSwiperClass={has_grid:function(){return $buddyboss_photo_grid.length>0;},has_photoswipe:function(){return buddyboss_mediawipe!==false;},location_from_current:function(){var current,comments_href,callback_args;if(!BuddyBossSwiperClass.has_photoswipe()){return false;}
current=buddyboss_mediawipe.getCurrentImage();comments_href=current.metaData.href;callback_args={comments_href:comments_href,current:current};jq(document).trigger('buddyboss:media:comment_link',callback_args);setTimeout(function(){window.location=comments_href;},15);},reset:function(){if(buddyboss_mediawipe!==false){try{PhotoSwipe.unsetActivateInstance(buddyboss_mediawipe);PhotoSwipe.detatch(buddyboss_mediawipe);}
catch(e){}}
BuddyBossSwiperClass.start();},start:function(){var _pics_sel=BuddyBossSwiperClass.has_grid()?'.gallery-icon > a':'.buddyboss-media-photo-wrap';var $buddyboss_media=jq(_pics_sel);if($buddyboss_media.length>0){buddyboss_mediawipe=$buddyboss_media.photoSwipe(buddyboss_mediawipe_options);buddyboss_mediawipe.addEventHandler(PhotoSwipe.EventTypes.onBeforeShow,function(e){jq('html').css({overflow:'hidden'});});buddyboss_mediawipe.addEventHandler(PhotoSwipe.EventTypes.onHide,function(e){jq('html').css({overflow:'auto'});current_photo_activity_text=null;current_photo_permalink=null;$caption.off('click');$caption=null;$comment_link=null;setTimeout(function(){jq(window).trigger('reset_carousel');},555);});buddyboss_mediawipe.addEventHandler(PhotoSwipe.EventTypes.onCaptionAndToolbarShow,function(e){$caption=jq('.ps-caption').on('click',function(e){window.location=buddyboss_mediawipe.getCurrentImage().metaData.href;});$comment_link=jq('.ps-toolbar-comments');});buddyboss_mediawipe.addEventHandler(PhotoSwipe.EventTypes.onToolbarTap,function(e){if(e.toolbarAction===PhotoSwipe.Toolbar.ToolbarAction.none){if(e.tapTarget===$comment_link[0]||PhotoSwipe_Util.DOM.isChildOf(e.tapTarget,$comment_link[0])){var current=buddyboss_mediawipe.getCurrentImage(),comments_href=current.metaData.href,callback_args={comments_href:comments_href,current:current};jq(document).trigger('buddyboss:media:comment_link',callback_args);window.location=comments_href;}
if(e.tapTarget===jq('.ps-toolbar-favorite')[0]||PhotoSwipe_Util.DOM.isChildOf(e.tapTarget,jq('.ps-toolbar-favorite')[0])){cache_ele=buddyboss_mediawipe.getCurrentImage().metaData.link_elm;var target=buddyboss_mediawipe.getCurrentImage().metaData;var act_id=target.media;if(jq('#activity-'+act_id).length>0){var $act_obj=jq('#activity-'+act_id);var fav_class_obj=$act_obj.find('.buddyboss-media-photo').first();var current_fav_class=fav_class_obj.attr('data-bbmfav');var fav_class='fav';var unfav_class='unfav';var type=current_fav_class==='bbm-fav'?'fav':'unfav';var act_fav_button=jq('#activity-'+act_id+' .activity-meta .'+type);var fav_activity_meta_obj=jq('#activity-'+act_id).find('.activity-meta .fav');var unfav_activity_meta_obj=jq('#activity-'+act_id).find('.activity-meta .unfav');}else if(jq('#acomment-'+act_id).length>0){var $act_obj=jq('#acomment-'+act_id);var fav_class_obj=$act_obj.find('.buddyboss-media-photo').first();var current_fav_class=fav_class_obj.attr('data-bbmfav');var fav_class='fav-comment';var unfav_class='unfav-comment';var type=current_fav_class==='bbm-fav'?'fav':'unfav';var act_fav_button=jq('#acomment-'+act_id+' .acomment-options .'+type+'-comment');var fav_activity_meta_obj=jq('#acomment-'+act_id).find('.acomment-options .fav-comment:first');var unfav_activity_meta_obj=jq('#acomment-'+act_id).find('.acomment-options .unfav-comment:first');}else if(jq('*[data-media="'+act_id+'"]').length>0){var $_obj=jq('*[data-media="'+act_id+'"]'),fav_class_obj=$_obj;current_fav_class=$_obj.attr('data-bbmfav'),fav_class='fav-comment',unfav_class='unfav-comment',type=current_fav_class==='bbm-fav'?'fav':'unfav',fav_activity_meta_obj=$_obj,unfav_activity_meta_obj=$_obj;}
mark_it=jq.post(ajaxurl,{action:'bbm_activity_mark_'+type,id:act_id,item_type:'bbm_activity_mark'});try{mark_it.done(function(d){if(d){d=jq.parseJSON(d);if(d.action==='fav'){jq('.ps-toolbar-favorite').removeClass('bbm-fav');jq('.ps-toolbar-favorite').addClass('bbm-unfav');jq(fav_class_obj).attr('data-bbmfav','bbm-unfav');if(fav_activity_meta_obj.length>0){var fav_url=jq(fav_activity_meta_obj).attr('href');jq(fav_activity_meta_obj).removeClass(fav_class);jq(fav_activity_meta_obj).addClass(unfav_class);jq(fav_activity_meta_obj).attr('title',BP_DTheme.remove_fav);var new_url=fav_url.replace('unfavorite','favorite');jq(fav_activity_meta_obj).attr('href',new_url);}
if('undefined'!=typeof act_fav_button){var title='fav'==type?BP_DTheme.remove_fav:BP_DTheme.mark_as_fav;act_fav_button.attr('title',title);act_fav_button.html(title);act_fav_button.removeClass('fav');act_fav_button.addClass('unfav');}}
else{jq('.ps-toolbar-favorite').removeClass('bbm-unfav');jq('.ps-toolbar-favorite').addClass('bbm-fav');jq(fav_class_obj).attr('data-bbmfav','bbm-fav');if(unfav_activity_meta_obj.length>0){var fav_url=jq(unfav_activity_meta_obj).attr('href');jq(unfav_activity_meta_obj).removeClass(unfav_class);jq(unfav_activity_meta_obj).addClass(fav_class);jq(unfav_activity_meta_obj).attr('title',BP_DTheme.mark_as_fav);var new_url=fav_url.replace('favorite','unfavorite');jq(unfav_activity_meta_obj).attr('href',new_url);}
if('undefined'!=typeof act_fav_button){var title='fav'==type?BP_DTheme.remove_fav:BP_DTheme.mark_as_fav;act_fav_button.attr('title',title);act_fav_button.html(title);act_fav_button.removeClass('unfav');act_fav_button.addClass('fav');}}
jq(fav_class_obj).attr('data-favorite-count',d.count);jq('.ps-favorite-count').html(d.count);}});}catch(e){}}
if(e.tapTarget===jq('.ps-toolbar-delete')[0]||PhotoSwipe_Util.DOM.isChildOf(e.tapTarget,jq('.ps-toolbar-delete')[0])){if(confirm(BuddyBoss_Media_Appstate.sure_delete_photo)){jq('.ps-toolbar-delete').find(".loading").show();jq('.ps-toolbar-delete').find(".real").hide();cache_ele=buddyboss_mediawipe.getCurrentImage().metaData.link_elm;delete_it=jq.post(ajaxurl,{'action':'buddyboss_delete_media','media':buddyboss_mediawipe.getCurrentImage().metaData.media,'photo-id':buddyboss_mediawipe.getCurrentImage().metaData.photo_id});try{delete_it.done(function(d){if(d=="done"){var contentToRemove=document.querySelectorAll("#activity-"+buddyboss_mediawipe.getCurrentImage().metaData.media);jq(contentToRemove).remove();jq(".ps-toolbar-close .ps-toolbar-content").click();location.reload();}else{alert(d);}});delete_it.always(function(){jq('.ps-toolbar-delete').find(".loading").hide();jq('.ps-toolbar-delete').find(".real").show();jq(cache_ele).first().click();});}catch(e){}}}}});buddyboss_mediawipe.addEventHandler(PhotoSwipe.EventTypes.onDisplayImage,function(e){jq('.ps-comments-count').html(buddyboss_mediawipe.getCurrentImage().metaData.comment_count);$delete_link=jq('.ps-toolbar-delete');if(buddyboss_mediawipe.getCurrentImage().metaData.owner=="1"){$delete_link.show();}else{$delete_link.hide();}
var acti_id=buddyboss_mediawipe.getCurrentImage().metaData.media;if(jq('#activity-'+acti_id).length>0){var fav_class_obj=jq('#activity-'+acti_id).find('.buddyboss-media-photo').first();}else if(jq('#acomment-'+acti_id).length>0){var fav_class_obj=jq('#acomment-'+acti_id).find('.buddyboss-media-photo').first();}else if(jq('*[data-media="'+acti_id+'"]').length>0){var fav_class_obj=jq('*[data-media="'+acti_id+'"]');}
if('undefined'!=typeof fav_class_obj){jq('.ps-favorite-count').html(fav_class_obj.attr('data-favorite-count'));jq('.ps-toolbar-favorite').removeClass('bbm-unfav');jq('.ps-toolbar-favorite').removeClass('bbm-fav');jq('.ps-toolbar-favorite').addClass(fav_class_obj.attr('data-bbmfav'));}});}}}
BuddyBossSwiperClass.start();function ajaxSuccessHandler(e,xhr,options){var action=bbmedia_getQueryVariable(options.data,'action');var resetCallback=function(action){return function(){var reset_action=['activity_get_older_updates','post_update','new_activity_comment','delete_activity_comment','activity_widget_filter','get_single_activity_content'];if(-1!==reset_action.indexOf(action)){BuddyBossSwiperClass.reset();}}}(action);window.setTimeout(resetCallback,205);window.setTimeout(resetCallback,750);}
jq(document).ajaxSuccess(ajaxSuccessHandler);return BuddyBossSwiperClass;}
(window,window.Code.Util||false,window.Code.PhotoSwipe||false,window.BuddyBoss_Media_Util));window.BuddyBoss_Media_Uploader=(function(window,jq,util,undefined){var uploader=false;var _l={},filesAdded=0;var state=util.state||{},lang=util.lang;var pics_uploaded=[];var APP={init:function(){var self=this;this.inject_markup();if(!this.get_elements()){return false;}
this.setup_modal();this.setup_textbox();setTimeout(function(){self.start_uploader();},10);jq.ajaxPrefilter(APP.prefilter);jq(document).ajaxSuccess(APP.ajaxSuccessHandler);},destroy:function(){},ajaxSuccessHandler:function(e,xhr,options){var action=bbmedia_getQueryVariable(options.data,'action');if('post_update'==action){var slug=BBOSS_MEDIA.photo_component_slug;var data={action:'bbm_photo_counts'};jq.ajax({type:'GET',url:ajaxurl,data:data,success:function(response){if(response.success){var $photo_cnt_span=jq('#'+slug+'-personal-li #user-'+slug+' span');if($photo_cnt_span.length>0){$photo_cnt_span.text(response.data);}}}});}},inject_markup:function(){var $activity_greeting=jq('.my-gallery .activity-greeting'),greeting=lang('user_add_photo');if($activity_greeting.length&&!!greeting){$activity_greeting.text(greeting).show();}
var $whats_new_content=jq('#whats-new-content');var $add_photo=jq('#buddyboss-media-tpl-add-photo');if($add_photo.length&&$whats_new_content.length){$whats_new_content.before($add_photo.html());}
var $preview_pane=jq('#buddyboss-media-tpl-preview');if($preview_pane.length&&$whats_new_content.length&&'undefined'==typeof bbpress_media){$whats_new_content.find('textarea').after($preview_pane.html());}},get_elements:function(){_l.$whats_new=jq('#whats-new');if(_l.$whats_new.length===0&&'undefined'==typeof bbpress_media){return false;}
_l.$add_photo=jq('#buddyboss-media-bulk-uploader');_l.$open_uploder_button=jq('#buddyboss-media-open-uploader-button');_l.$add_photo_button=jq('#logo-file-browser-button');_l.$post_button=jq('#whats-new-submit').find('[type=submit],button');_l.$uploader=jq('#buddyboss-media-bulk-uploader');_l.$uploaded=jq('#buddyboss-media-bulk-uploader-uploaded .images');_l.$preview_pane=jq('#buddyboss-media-preview-inner');_l.$privacy_bp=jq('#bbwall-activity-privacy');_l.$privacy_modal=jq('#bbm-media-privacy');return true;},setup_textbox:function(){_l.$whats_new.blur(function(){setTimeout(function(){if(pics_uploaded&&pics_uploaded.length>0){_l.$post_button.removeAttr('disabled');_l.$post_button.prop('disabled',false);}},200)});},setup_modal:function(){_l.$open_uploder_button.fancybox({href:'#buddyboss-media-bulk-uploader-wrapper',minWidth:500,beforeLoad:function(){jq('#buddyboss-media-bulk-uploader-text').val(_l.$whats_new.val());if(_l.$privacy_bp.length>0){_l.$privacy_modal.val(_l.$privacy_bp.val());}
_l.$preview_pane.hide();},beforeClose:function(){if(jq('#buddyboss-media-bulk-uploader-text').length>0){_l.$whats_new.val(jq('#buddyboss-media-bulk-uploader-text').val());}
if(_l.$privacy_bp.length>0){_l.$privacy_bp.val(_l.$privacy_modal.val());}},afterClose:function(){_l.$preview_pane.html(_l.$uploaded.html());_l.$preview_pane.show();}});jq('#aw-whats-new-submit-bbmedia').click(function(){jq.fancybox.close();_l.$post_button.trigger('click');});},prefilter:function(options,origOptions,jqXHR){var action=bbmedia_getQueryVariable(options.data,'action');if(typeof action=='undefined'||action!='post_update')
return;var new_data,pic_html='';if(pics_uploaded.length>0){for(var i=0;i<pics_uploaded.length;i++){var pic=jq('<a/>').attr('href',pics_uploaded[i].url).attr('target','_blank').attr('title',pics_uploaded[i].name).addClass('buddyboss-media-photo-link').html(pics_uploaded[i].name)[0].outerHTML;pic_html+=pic;}
new_data=jq.extend({},origOptions.data,{content:origOptions.data.content+' '+pic_html,pics_uploaded:pics_uploaded});options.data=jq.param(new_data);options.success=(function(old_success){return function(response,txt,xhr){if(jq.isFunction(old_success)){old_success(response,txt,xhr);}
if(response[0]+response[1]!=='-1'){APP.post_success(response,txt,xhr);}}})(options.success);}
else if(origOptions.data&&origOptions.data.action==='get_single_activity_content'){options.success=(function(old_success){return function(response,txt,xhr){if(jq.isFunction(old_success)){old_success(response,txt,xhr);}
if(response[0]+response[1]!=='-1'){APP.readmore_success(response,txt,xhr);}}})(options.success);}},post_success:function(response){var $new=jq("li.new-update").find('.buddyboss-media-photo-wrap');if($new.length>0&&typeof BuddyBossSwiper=='object'&&BuddyBossSwiper.hasOwnProperty('reset')){BuddyBossSwiper.reset();}
pics_uploaded=[];_l.$preview_pane.html('');_l.$uploaded.html('');uploader.splice(0,uploader.files.length);filesAdded=0;},start_uploader:function(){var $progressBar,progressPercent=0;var ieMobile=navigator.userAgent.indexOf('IEMobile')!==-1;if(ieMobile){_l.$add_photo.addClass('legacy');}
uploader=new plupload.Uploader({runtimes:state.uploader_runtimes||'html5,flash,silverlight,html4',browse_button:_l.$add_photo_button[0],dragdrop:true,container:'buddyboss-media-bulk-uploader-reception',drop_element:'buddyboss-media-bulk-uploader-wrapper',max_file_size:state.uploader_filesize||'10mb',multi_selection:state.uploader_multiselect||false,url:ajaxurl,multipart:true,multipart_params:{action:'buddyboss_media_post_photo','cookie':encodeURIComponent(document.cookie),'_wpnonce_post_update':BBOSS_MEDIA.media_upload_nonce},flash_swf_url:state.uploader_swf_url||'',silverlight_xap_url:state.uploader_xap_url||'',filters:[{title:lang('file_browse_title'),extensions:state.uploader_filetypes||'jpg,jpeg,gif,png,bmp',prevent_duplicates:true}],init:{Init:function(){if(_l.$add_photo.find('.moxie-shim').find("input").length=='0'){_l.$add_photo.find('.moxie-shim').first().css("z-index",10);_l.$add_photo.find('.moxie-shim').css("cursor",'pointer');}else{clone=jq(_l.$add_photo_button[0]).clone();jq(_l.$add_photo_button[0]).after(clone).remove();_l.$add_photo_button[0]=clone;jq(_l.$add_photo_button[0]).on("click",function(){_l.$add_photo.find('.moxie-shim').find("input").click();});}},FilesAdded:function(up,files){jq('#aw-whats-new-submit-bbmedia').prop('disabled',true);if(up.files.length>state.uploader_max_files||files.length>state.uploader_max_files){uploader.splice(filesAdded,uploader.files.length);alert(lang('exceed_max_files_per_batch'));return false;}
for(var i=0;i<files.length;i++){if(jq('div[data-fileid="'+files[i].id+'"]').length===0){var newimg="<div data-fileid='"+files[i].id+"' class='file uploading'><img src='"+state.uploader_temp_img+"'><progress class='buddyboss-media-progress-bar' value='0' max='100'></progress></div>";_l.$uploaded.append(newimg);_l.$preview_pane.append(newimg);filesAdded++;}}
jq.fancybox.update();up.start();},UploadProgress:function(up,file){if(file&&file.hasOwnProperty('percent')){$progressBar=jq('div[data-fileid="'+file.id+'"]').find('progress');progressPercent=file.percent;$progressBar.val(progressPercent);}},FileUploaded:function(up,file,info){jq('#aw-whats-new-submit-bbmedia').prop('disabled',false);var responseJSON=jq.parseJSON(info.response);$file=jq('div[data-fileid="'+file.id+'"]');$file.removeClass('uploading');if('undefined'!=typeof bbpress_media){$file.append("<input type='hidden' value='"+responseJSON.attachment_id+"' name='bbm_bbpress_attachments[]'>");}
$file.data('attachment_id',responseJSON.attachment_id);$file.find('>img').attr('src',responseJSON.url);$file.find('progress').replaceWith("<a href='#' onclick='return window.BuddyBoss_Media_Uploader.removeUploaded(\""+file.id+"\");' class='delete'>+</a>");pics_uploaded.push(responseJSON);jq.fancybox.update();},Error:function(up,args){jq('#aw-whats-new-submit-bbmedia').prop('disabled',false);alert(lang('error_uploading_photo'));$progressWrap.removeClass('uploading');$postButton.prop("disabled",false).removeClass('loading');}}});uploader.init();jq('.fancybox-close').on('click',function(){jq('#aw-whats-new-submit-bbmedia').prop('disabled',false);});if(jq('#buddyboss-media-bulk-uploader-reception-fake').length>0){var additional_dropzone=document.getElementById('buddyboss-media-bulk-uploader-reception-fake');$additional_dropzone=jq(additional_dropzone);var dropzone=new mOxie.FileDrop({drop_zone:additional_dropzone});dropzone.ondrop=function(event){_l.$open_uploder_button.click();uploader.addFile(dropzone.files);};dropzone.init();var input=new mOxie.FileInput({browse_button:jq("a.browse-file-button",$additional_dropzone)[0],container:additional_dropzone,multiple:true});input.onchange=function(event){_l.$open_uploder_button.click();uploader.addFile(input.files);};input.init();}
if(jq('#buddyboss-media-add-photo').length>0&&'false'===BBOSS_MEDIA.is_media_page&&'false'===BBOSS_MEDIA.is_photo_page){var additional_dropzone=document.getElementById('buddyboss-media-add-photo');$additional_dropzone=jq(additional_dropzone);var input=new mOxie.FileInput({browse_button:jq(".browse-file-button")[0],container:additional_dropzone,multiple:true});input.onchange=function(event){uploader.addFile(input.files);};input.init();}},removeUploaded:function(fileid){var $file=jq('div[data-fileid="'+fileid+'"]');if(pics_uploaded.length>0){var pics_uploaded_temp=[];for(var i=0;i<pics_uploaded.length;i++){if(pics_uploaded[i].attachment_id!==$file.data('attachment_id')){pics_uploaded_temp.push(pics_uploaded[i]);}}
pics_uploaded=pics_uploaded_temp;}
var file_to_remove=false;jq.each(uploader.files,function(i,ufile){if(ufile.hasOwnProperty('id')&&ufile.id==fileid){file_to_remove=ufile;}});if(file_to_remove){uploader.removeFile(file_to_remove);filesAdded--;}
$file.remove();return false;},}
var API={setup:function(){APP.init();},teardown:function(){APP.destroy();},removeUploaded:function(file){return APP.removeUploaded(file);},}
jq(document).ready(function(){APP.init();});return API;}
(window,window.jQuery,window.BuddyBoss_Media_Util));window.BuddyBoss_Edit_Media_Uploader=(function(window,jq,util,undefined){var uploader=false;var _el={},filesAdded=0;var state=util.state||{},lang=util.lang;var pics_uploaded=[];var APP={init:function(){var self=this;if(!this.get_elements()){return false;}
setTimeout(function(){self.start_uploader();},10);jq.ajaxPrefilter(APP.prefilter);jq(document).ajaxSuccess(APP.ajaxSuccessHandler);jq(document).on('click','a.buddyboss_edit_activity.action-edit',APP.editActivityMediaPreview);},destroy:function(){},prefilter:function(options,origOptions,jqXHR){var action=bbmedia_getQueryVariable(options.data,'action');if(typeof action=='undefined'||action!='buddypress-edit-activity-save')
return;var media_ids=[];jq("#buddyboss-edit-media-preview .file").map(function(idx,ele){media_ids[idx]=jq(ele).data('media-id');});var new_data=jq.extend({},origOptions.data,{'buddyboss_media_aid':media_ids,});options.data=jq.param(new_data);},get_elements:function(){_el.$add_photo=jq('#buddyboss-edit-media-bulk-uploader');_el.$open_uploder_button=jq('#buddyboss-edit-media-open-uploader-button');_el.$add_photo_button=jq('#browse-file-button');_el.$uploaded=jq('#buddyboss-media-bulk-uploader-uploaded .images');_el.$preview_pane=jq('#buddyboss-edit-media-preview-inner');return true;},editActivityMediaPreview:function(e){$elm_edit_btn=jq(this);var activity_id=$elm_edit_btn.data('activity_id');var data={'action':'buddypress_edit_activity_media_content','activity_id':$elm_edit_btn.data('activity_id'),};jq.ajax({type:'POST',url:ajaxurl,data:data,success:function(response){$media_edit_wrapper=jq('#buddyboss-edit-media-preview-inner');$media_edit_wrapper.html(response);}});},start_uploader:function(){var $progressBar,progressPercent=0;var ieMobile=navigator.userAgent.indexOf('IEMobile')!==-1;if(ieMobile){_el.$add_photo.addClass('legacy');}
uploader=new plupload.Uploader({runtimes:state.uploader_runtimes||'html5,flash,silverlight,html4',browse_button:_el.$add_photo_button[0],dragdrop:true,container:'buddyboss-edit-media-bulk-uploader-reception',drop_element:'buddyboss-edit-media-bulk-uploader-wrapper',max_file_size:state.uploader_filesize||'10mb',multi_selection:state.uploader_multiselect||false,url:ajaxurl,multipart:true,multipart_params:{action:'buddyboss_media_post_photo','cookie':encodeURIComponent(document.cookie),'_wpnonce_post_update':BBOSS_MEDIA.media_upload_nonce},flash_swf_url:state.uploader_swf_url||'',silverlight_xap_url:state.uploader_xap_url||'',filters:[{title:lang('file_browse_title'),extensions:state.uploader_filetypes||'jpg,jpeg,gif,png,bmp',prevent_duplicates:true}],init:{Init:function(){if(_el.$add_photo.find('.moxie-shim').find("input").length=='0'){_el.$add_photo.find('.moxie-shim').first().css("z-index",10);_el.$add_photo.find('.moxie-shim').css("cursor",'pointer');}else{clone=jq(_el.$add_photo_button[0]).clone();jq(_el.$add_photo_button[0]).after(clone).remove();_el.$add_photo_button[0]=clone;jq(_el.$add_photo_button[0]).on("click",function(){_el.$add_photo.find('.moxie-shim').find("input").click();});}},FilesAdded:function(up,files){jq('#aw-whats-new-submit-bbmedia').prop('disabled',true);if(up.files.length>state.uploader_max_files||files.length>state.uploader_max_files){uploader.splice(filesAdded,uploader.files.length);alert(lang('exceed_max_files_per_batch'));return false;}
for(var i=0;i<files.length;i++){if(jq('div[data-fileid="'+files[i].id+'"]').length===0){var newimg="<div data-fileid='"+files[i].id+"' class='file uploading'><img src='"+state.uploader_temp_img+"'><progress class='buddyboss-media-progress-bar' value='0' max='100'></progress></div>";_el.$uploaded.append(newimg);_el.$preview_pane.append(newimg);filesAdded++;}}
jq.fancybox.update();up.start();},UploadProgress:function(up,file){if(file&&file.hasOwnProperty('percent')){$progressBar=jq('div[data-fileid="'+file.id+'"]').find('progress');progressPercent=file.percent;$progressBar.val(progressPercent);}},FileUploaded:function(up,file,info){jq('#aw-whats-new-submit-bbmedia').prop('disabled',false);var responseJSON=jq.parseJSON(info.response);$file=jq('div[data-fileid="'+file.id+'"]');$file.removeClass('uploading');$file.data('media-id',responseJSON.attachment_id);$file.find('>img').attr('src',responseJSON.url);$file.find('progress').replaceWith("<a href='#' onclick='return window.BuddyBoss_Media_Uploader.removeUploaded(\""+file.id+"\");' class='delete'>+</a>");pics_uploaded.push(responseJSON);jq.fancybox.update();},Error:function(up,args){jq('#aw-whats-new-submit-bbmedia').prop('disabled',false);alert(lang('error_uploading_photo'));$progressWrap.removeClass('uploading');$postButton.prop("disabled",false).removeClass('loading');}}});uploader.init();jq('.fancybox-close').on('click',function(){jq('#aw-whats-new-submit-bbmedia').prop('disabled',false);});if(jq('#buddyboss-media-bulk-uploader-reception-fake').length>0){var additional_dropzone=document.getElementById('buddyboss-media-bulk-uploader-reception-fake');$additional_dropzone=jq(additional_dropzone);var dropzone=new mOxie.FileDrop({drop_zone:additional_dropzone});dropzone.ondrop=function(event){_el.$open_uploder_button.click();uploader.addFile(dropzone.files);};dropzone.init();if(jq("#buddyboss-edit-media-add-photo .browse-file-button").is(':visible')){var input=new mOxie.FileInput({browse_button:jq("#buddyboss-edit-media-add-photo .browse-file-button",$additional_dropzone)[0],container:additional_dropzone,multiple:true});input.onchange=function(event){_el.$open_uploder_button.click();uploader.addFile(input.files);};input.init();}}
if(jq('#buddyboss-edit-media-add-photo a.buddyboss-media-add-photo').length>0&&'false'===BBOSS_MEDIA.is_photo_page){var additional_dropzone=document.getElementById('buddyboss-media-add-photo');$additional_dropzone=jq(additional_dropzone);var input=new mOxie.FileInput({browse_button:jq("#buddyboss-edit-media-add-photo .browse-file-button")[0],container:additional_dropzone,multiple:true});input.onchange=function(event){uploader.addFile(input.files);};input.init();}},removeUploaded:function(fileid){var $file=jq('div[data-fileid="'+fileid+'"]');if(pics_uploaded.length>0){var pics_uploaded_temp=[];for(var i=0;i<pics_uploaded.length;i++){if(pics_uploaded[i].attachment_id!==$file.data('attachment_id')){pics_uploaded_temp.push(pics_uploaded[i]);}}
pics_uploaded=pics_uploaded_temp;}
var file_to_remove=false;jq.each(uploader.files,function(i,ufile){if(ufile.hasOwnProperty('id')&&ufile.id==fileid){file_to_remove=ufile;}});if(file_to_remove){uploader.removeFile(file_to_remove);filesAdded--;}
$file.remove();return false;},editActivityRemoveMedia:function(el){var $el=jq(el);$el.parent().remove();},}
var API={setup:function(){APP.init();},teardown:function(){APP.destroy();},removeUploaded:function(file){return APP.removeUploaded(file);},editActivityRemoveMedia:function(el){return APP.editActivityRemoveMedia(el);},}
jq(document).ready(function(){APP.init();});return API;}
(window,window.jQuery,window.BuddyBoss_Media_Util));window.BuddyBoss_Comment_Media_Uploader=(function(window,jq,util,undefined){var uploader=false;var _cl={},filesAdded=0;var state=util.state||{},lang=util.lang;var pics_uploaded=[];var APP={init:function(){var self=this;this.inject_markup();if(!this.get_elements()){return false;}
jq(document).on('click','.buddyboss-comment-media-add-photo-button',APP.set_post_button);jq('ul#activity-stream').on('click','a.acomment-reply',APP.set_file_browse_button);this.setup_modal();setTimeout(function(){self.start_uploader();},10);jq.ajaxPrefilter(APP.prefilter);jq(document).ajaxSuccess(APP.ajaxSuccessHandler);},destroy:function(){},inject_markup:function(){var $ac_form_submit=jq("input[name='ac_form_submit']:not(.has-comment-media-button)");var $add_photo=jq('#buddyboss-comment-media-tpl-add-photo');if($add_photo.length&&$ac_form_submit.length){$ac_form_submit.before($add_photo.html());$ac_form_submit.addClass('has-comment-media-button');}
var $preview_pane=jq('#buddyboss-comment-media-tpl-preview');if($preview_pane.length&&$ac_form_submit.length){var $ac_reply_content=jq('.ac-reply-content:not(.has-comment-media-button)')
$ac_reply_content.after($preview_pane.html());$ac_reply_content.addClass('has-comment-media-button')}},get_elements:function(){_cl.$comment_input=null;_cl.$browse_file_button=null;_cl.$comment_media_container=null;_cl.$add_photo=jq('#buddyboss-comment-media-bulk-uploader');_cl.$open_uploder_button=jq('.open-uploader-button.buddyboss-comment-media-add-photo-button');_cl.$add_photo_button=jq('.logo-comment-file-browser-button');_cl.$post_button=null;_cl.$uploader=jq('#buddyboss-comment-media-bulk-uploader');_cl.$uploaded=jq('.buddyboss-comment-media-bulk-uploader-uploaded .images');_cl.$preview_pane=jq('.buddyboss-comment-media-preview-inner');return true;},setup_modal:function(){_cl.$open_uploder_button.fancybox({href:'#buddyboss-comment-media-bulk-uploader-wrapper',minWidth:500,beforeLoad:function(){jq('.buddyboss-comment-media-bulk-uploader-text').val(_cl.$comment_input.val());},beforeClose:function(){if(jq('.buddyboss-comment-media-bulk-uploader-text').length>0){_cl.$comment_input.val(jq('.buddyboss-comment-media-bulk-uploader-text').val());}},afterClose:function(){_cl.$preview_pane.html(_cl.$uploaded.html());_cl.$preview_pane.show();}});jq('#buddyboss-comment-media-attach').click(function(){jq.fancybox.close();_cl.$post_button.trigger('click');});},set_post_button:function(e){$attach_comment_media_button=jq(this).parents('.ac-reply-content');_cl.$post_button=$attach_comment_media_button.find('input[name=ac_form_submit]');_cl.$comment_input=$attach_comment_media_button.find('textarea');},set_file_browse_button:function(e){$acomment_reply_button=jq(this);$activity_comment_div=$acomment_reply_button.parents('.activity-content').next('.activity-comments')
_cl.$browse_file_button=$activity_comment_div.find('.browse-file-button');_cl.$comment_media_container=$activity_comment_div.find('.buddyboss-comment-media-add-photo');var input=new mOxie.FileInput({browse_button:_cl.$browse_file_button.get(0),container:_cl.$comment_media_container.get(0),multiple:true});input.onchange=function(event){uploader.addFile(input.files);};input.init();},prefilter:function(options,origOptions,jqXHR){var action=bbmedia_getQueryVariable(options.data,'action');if(typeof action=='undefined'||action!='new_activity_comment')
return;var new_data,pic_html='';if(pics_uploaded.length>0){for(var i=0;i<pics_uploaded.length;i++){var pic=jq('<a/>').attr('href',pics_uploaded[i].url).attr('target','_blank').attr('title',pics_uploaded[i].name).addClass('buddyboss-media-photo-link').html(pics_uploaded[i].name)[0].outerHTML;pic_html+=pic;}
new_data=jq.extend({},origOptions.data,{content:origOptions.data.content+' '+pic_html,pics_uploaded:pics_uploaded});options.data=jq.param(new_data);options.success=(function(old_success){return function(response,txt,xhr){if(jq.isFunction(old_success)){old_success(response,txt,xhr);}
if(response[0]+response[1]!=='-1'){APP.post_success(response,txt,xhr);}}})(options.success);}
else if(origOptions.data&&origOptions.data.action==='get_single_activity_content'){options.success=(function(old_success){return function(response,txt,xhr){if(jq.isFunction(old_success)){old_success(response,txt,xhr);}
if(response[0]+response[1]!=='-1'){APP.readmore_success(response,txt,xhr);}}})(options.success);}},ajaxSuccessHandler:function(e,xhr,options){var action=bbmedia_getQueryVariable(options.data,'action');var action_arr=['activity_get_older_updates','post_update','activity_widget_filter'];if(-1!=action_arr.indexOf(action)){setTimeout(function(){APP.inject_markup();},2000);}},post_success:function(response){var $new=jq("li.new-update").find('.buddyboss-media-photo-wrap');if($new.length>0&&typeof BuddyBossSwiper=='object'&&BuddyBossSwiper.hasOwnProperty('reset')){BuddyBossSwiper.reset();}
pics_uploaded=[];_cl.$preview_pane.html('');_cl.$uploaded.html('');uploader.splice(0,uploader.files.length);filesAdded=0;},start_uploader:function(){var $progressBar,progressPercent=0;var ieMobile=navigator.userAgent.indexOf('IEMobile')!==-1;if(ieMobile){_cl.$add_photo.addClass('legacy');}
uploader=new plupload.Uploader({runtimes:state.uploader_runtimes||'html5,flash,silverlight,html4',browse_button:_cl.$add_photo_button[0],dragdrop:true,container:'buddyboss-comment-media-bulk-uploader-reception',drop_element:'buddyboss-comment-media-bulk-uploader-wrapper',max_file_size:state.uploader_filesize||'10mb',multi_selection:state.uploader_multiselect||false,url:ajaxurl,multipart:true,multipart_params:{action:'buddyboss_media_post_photo','cookie':encodeURIComponent(document.cookie),'_wpnonce_post_update':BBOSS_MEDIA.media_upload_nonce},flash_swf_url:state.uploader_swf_url||'',silverlight_xap_url:state.uploader_xap_url||'',filters:[{title:lang('file_browse_title'),extensions:state.uploader_filetypes||'jpg,jpeg,gif,png,bmp',prevent_duplicates:true}],init:{Init:function(){if(_cl.$add_photo.find('.moxie-shim').find("input").length=='0'){_cl.$add_photo.find('.moxie-shim').first().css("z-index",10);_cl.$add_photo.find('.moxie-shim').css("cursor",'pointer');}else{clone=jq(_cl.$add_photo_button[0]).clone();jq(_cl.$add_photo_button[0]).after(clone).remove();_cl.$add_photo_button[0]=clone;jq(_cl.$add_photo_button[0]).on("click",function(){_cl.$add_photo.find('.moxie-shim').find("input").click();});}},FilesAdded:function(up,files){jQuery('.has-comment-media-button').prop('disabled',true);jQuery('#buddyboss-comment-media-attach').prop('disabled',true);if(up.files.length>state.uploader_max_files||files.length>state.uploader_max_files){uploader.splice(filesAdded,uploader.files.length);alert(lang('exceed_max_files_per_batch'));return false;}
for(var i=0;i<files.length;i++){if(jq('div[data-fileid="'+files[i].id+'"]').length===0){var newimg="<div data-fileid='"+files[i].id+"' class='file uploading'><img src='"+state.uploader_temp_img+"'><progress class='buddyboss-media-progress-bar' value='0' max='100'></progress></div>";_cl.$uploaded.append(newimg);_cl.$preview_pane.append(newimg);filesAdded++;}}
jq.fancybox.update();up.start();},UploadProgress:function(up,file){if(file&&file.hasOwnProperty('percent')){$progressBar=jq('div[data-fileid="'+file.id+'"]').find('progress');progressPercent=file.percent;$progressBar.val(progressPercent);}},FileUploaded:function(up,file,info){jQuery('.has-comment-media-button').prop('disabled',false);jQuery('#buddyboss-comment-media-attach').prop('disabled',false);var responseJSON=jq.parseJSON(info.response);$file=jq('div[data-fileid="'+file.id+'"]');$file.removeClass('uploading');$file.data('attachment_id',responseJSON.attachment_id);$file.find('>img').attr('src',responseJSON.url);$file.find('progress').replaceWith("<a href='#' onclick='return window.BuddyBoss_Comment_Media_Uploader.removeUploaded(\""+file.id+"\");' class='delete'>+</a>");pics_uploaded.push(responseJSON);jq.fancybox.update();},Error:function(up,args){jQuery('.has-comment-media-button').prop('disabled',false);alert(lang('error_uploading_photo'));$progressWrap.removeClass('uploading');$postButton.prop("disabled",false).removeClass('loading');}}});uploader.init();if(jq('#buddyboss-comment-media-bulk-uploader-reception-fake').length>0){var additional_dropzone=document.getElementById('buddyboss-media-bulk-uploader-reception-fake');$additional_dropzone=jq(additional_dropzone);var dropzone=new mOxie.FileDrop({drop_zone:additional_dropzone});dropzone.ondrop=function(event){_l.$open_uploder_button.click();uploader.addFile(dropzone.files);};dropzone.init();var input=new mOxie.FileInput({browse_button:jq("#buddyboss-comment-media-add-photo .browse-file-button",$additional_dropzone)[0],container:additional_dropzone,multiple:true});input.onchange=function(event){_l.$open_uploder_button.click();uploader.addFile(input.files);};input.init();}},removeUploaded:function(fileid){var $file=jq('div[data-fileid="'+fileid+'"]');if(pics_uploaded.length>0){var pics_uploaded_temp=[];for(var i=0;i<pics_uploaded.length;i++){if(pics_uploaded[i].attachment_id!==$file.data('attachment_id')){pics_uploaded_temp.push(pics_uploaded[i]);}}
pics_uploaded=pics_uploaded_temp;}
var file_to_remove=false;jq.each(uploader.files,function(i,ufile){if(ufile.hasOwnProperty('id')&&ufile.id==fileid){file_to_remove=ufile;}});if(file_to_remove){uploader.removeFile(file_to_remove);filesAdded--;}
$file.remove();return false;}}
var API={setup:function(){APP.init();},teardown:function(){APP.destroy();},removeUploaded:function(file){return APP.removeUploaded(file);}}
jq(document).ready(function(){APP.init();});return API;}
(window,window.jQuery,window.BuddyBoss_Media_Util));window.BuddyBoss_bbPress_Media_Uploader=(function(window,jq,util,undefined){var uploader=false;var _cl={},filesAdded=0;var state=util.state||{},lang=util.lang;var pics_uploaded=[];var APP={init:function(){var self=this;this.inject_markup();if(!this.get_elements()){return false;}
jq(document).on('click','.buddyboss-bbpress-media-add-photo-button',APP.set_post_button);this.setup_modal();setTimeout(function(){self.start_uploader();},10);jq.ajaxPrefilter(APP.prefilter);jq(document).ajaxSuccess(APP.ajaxSuccessHandler);},destroy:function(){},inject_markup:function(){var $whats_new_content=jq('.bbp-submit-wrapper');var $add_photo=jq('#buddyboss-bbpress-media-tpl-add-photo');if($add_photo.length&&$whats_new_content.length){$whats_new_content.append($add_photo.html());}},get_elements:function(){_cl.$bbpress_input=null;_cl.$add_photo=jq('#buddyboss-bbpress-media-bulk-uploader');_cl.$open_uploder_button=jq('.open-uploader-button.buddyboss-bbpress-media-add-photo-button');_cl.$add_photo_button=jq('.logo-bbpress-file-browser-button');_cl.$post_button=null;_cl.$uploader=jq('#buddyboss-bbpress-media-bulk-uploader');_cl.$uploaded=jq('.buddyboss-bbpress-media-bulk-uploader-uploaded .images');_cl.$preview_pane=jq('.buddyboss-bbpress-media-preview-inner');return true;},setup_modal:function(){_cl.$open_uploder_button.fancybox({href:'#buddyboss-bbpress-media-bulk-uploader-wrapper',minWidth:500,beforeLoad:function(){jq('.buddyboss-bbpress-media-bulk-uploader-text').val(_cl.$bbpress_input.val());},beforeClose:function(){if(jq('.buddyboss-bbpress-media-bulk-uploader-text').length>0){_cl.$bbpress_input.val(jq('.buddyboss-bbpress-media-bulk-uploader-text').val());}}});jq('#buddyboss-bbpress-media-attach').click(function(){jq.fancybox.close();_cl.$post_button.trigger('click');});},set_post_button:function(e){$attach_bbpress_media_button=jq(this).parents('.ac-reply-content');_cl.$post_button=$attach_bbpress_media_button.find('input[name=ac_form_submit]');_cl.$bbpress_input=$attach_bbpress_media_button.find('textarea');},prefilter:function(options,origOptions,jqXHR){var action=bbmedia_getQueryVariable(options.data,'action');if(typeof action=='undefined'||action!='new_activity_bbpress')
return;var new_data,pic_html='';if(pics_uploaded.length>0){for(var i=0;i<pics_uploaded.length;i++){var pic=jq('<a/>').attr('href',pics_uploaded[i].url).attr('target','_blank').attr('title',pics_uploaded[i].name).addClass('buddyboss-media-photo-link').html(pics_uploaded[i].name)[0].outerHTML;pic_html+=pic;}
new_data=jq.extend({},origOptions.data,{content:origOptions.data.content+' '+pic_html,pics_uploaded:pics_uploaded});options.data=jq.param(new_data);options.success=(function(old_success){return function(response,txt,xhr){if(jq.isFunction(old_success)){old_success(response,txt,xhr);}
if(response[0]+response[1]!=='-1'){APP.post_success(response,txt,xhr);}}})(options.success);}
else if(origOptions.data&&origOptions.data.action==='get_single_activity_content'){options.success=(function(old_success){return function(response,txt,xhr){if(jq.isFunction(old_success)){old_success(response,txt,xhr);}
if(response[0]+response[1]!=='-1'){APP.readmore_success(response,txt,xhr);}}})(options.success);}},ajaxSuccessHandler:function(e,xhr,options){var action=bbmedia_getQueryVariable(options.data,'action');if('activity_get_older_updates'==action){APP.inject_markup();}},post_success:function(response){var $new=jq("li.new-update").find('.buddyboss-media-photo-wrap');if($new.length>0&&typeof BuddyBossSwiper=='object'&&BuddyBossSwiper.hasOwnProperty('reset')){BuddyBossSwiper.reset();}
pics_uploaded=[];_cl.$preview_pane.html('');_cl.$uploaded.html('');uploader.splice(0,uploader.files.length);filesAdded=0;},start_uploader:function(){var $progressBar,progressPercent=0;var ieMobile=navigator.userAgent.indexOf('IEMobile')!==-1;if(ieMobile){_cl.$add_photo.addClass('legacy');}
uploader=new plupload.Uploader({runtimes:state.uploader_runtimes||'html5,flash,silverlight,html4',browse_button:_cl.$add_photo_button[0],dragdrop:true,container:'buddyboss-bbpress-media-bulk-uploader-reception',drop_element:'buddyboss-bbpress-media-bulk-uploader-wrapper',max_file_size:state.uploader_filesize||'10mb',multi_selection:state.uploader_multiselect||false,url:ajaxurl,multipart:true,multipart_params:{action:'buddyboss_media_post_photo','cookie':encodeURIComponent(document.cookie),'_wpnonce_post_update':BBOSS_MEDIA.media_upload_nonce},flash_swf_url:state.uploader_swf_url||'',silverlight_xap_url:state.uploader_xap_url||'',filters:[{title:lang('file_browse_title'),extensions:state.uploader_filetypes||'jpg,jpeg,gif,png,bmp',prevent_duplicates:true}],init:{Init:function(){if(_cl.$add_photo.find('.moxie-shim').find("input").length=='0'){_cl.$add_photo.find('.moxie-shim').first().css("z-index",10);_cl.$add_photo.find('.moxie-shim').css("cursor",'pointer');}else{clone=jq(_cl.$add_photo_button[0]).clone();jq(_cl.$add_photo_button[0]).after(clone).remove();_cl.$add_photo_button[0]=clone;jq(_cl.$add_photo_button[0]).on("click",function(){_cl.$add_photo.find('.moxie-shim').find("input").click();});}},FilesAdded:function(up,files){if(up.files.length>state.uploader_max_files||files.length>state.uploader_max_files){uploader.splice(filesAdded,uploader.files.length);alert(lang('exceed_max_files_per_batch'));return false;}
for(var i=0;i<files.length;i++){if(jq('div[data-fileid="'+files[i].id+'"]').length===0){var newimg="<div data-fileid='"+files[i].id+"' class='file uploading'><img src='"+state.uploader_temp_img+"'><progress class='buddyboss-media-progress-bar' value='0' max='100'></progress></div>";_cl.$uploaded.append(newimg);_cl.$preview_pane.append(newimg);filesAdded++;}}
jq.fancybox.update();up.start();},UploadProgress:function(up,file){if(file&&file.hasOwnProperty('percent')){$progressBar=jq('div[data-fileid="'+file.id+'"]').find('progress');progressPercent=file.percent;$progressBar.val(progressPercent);}},FileUploaded:function(up,file,info){var responseJSON=jq.parseJSON(info.response);$file=jq('div[data-fileid="'+file.id+'"]');$file.removeClass('uploading');$file.data('attachment_id',responseJSON.attachment_id);$file.append("<input type='hidden' value='"+responseJSON.attachment_id+"' name='bbm_bbpress_attachments[]'>");$file.find('>img').attr('src',responseJSON.url);$file.find('progress').replaceWith("<a href='#' onclick='return window.BuddyBoss_bbPress_Media_Uploader.removeUploaded(\""+file.id+"\");' class='delete'>+</a>");pics_uploaded.push(responseJSON);jq.fancybox.update();},Error:function(up,args){alert(lang('error_uploading_photo'));$progressWrap.removeClass('uploading');$postButton.prop("disabled",false).removeClass('loading');}}});uploader.init();if(jq('#buddyboss-bbpress-media-bulk-uploader-reception-fake').length>0){var additional_dropzone=document.getElementById('buddyboss-media-bulk-uploader-reception-fake');$additional_dropzone=jq(additional_dropzone);var dropzone=new mOxie.FileDrop({drop_zone:additional_dropzone});dropzone.ondrop=function(event){_l.$open_uploder_button.click();uploader.addFile(dropzone.files);};dropzone.init();var input=new mOxie.FileInput({browse_button:jq("a.browse-file-button",$additional_dropzone)[0],container:additional_dropzone,multiple:true});input.onchange=function(event){_l.$open_uploder_button.click();uploader.addFile(input.files);};input.init();}
if(jq('.buddyboss-bbpress-media-add-photo').length>0){var additional_dropzone=document.getElementsByClassName('buddyboss-bbpress-media-add-photo');var input=new mOxie.FileInput({browse_button:jq(".browse-file-button")[0],container:additional_dropzone[0],multiple:true});input.onchange=function(event){uploader.addFile(input.files);};input.init();}},removeUploaded:function(fileid){var $file=jq('div[data-fileid="'+fileid+'"]');if(pics_uploaded.length>0){var pics_uploaded_temp=[];for(var i=0;i<pics_uploaded.length;i++){if(pics_uploaded[i].attachment_id!==$file.data('attachment_id')){pics_uploaded_temp.push(pics_uploaded[i]);}}
pics_uploaded=pics_uploaded_temp;}
var file_to_remove=false;jq.each(uploader.files,function(i,ufile){if(ufile.hasOwnProperty('id')&&ufile.id==fileid){file_to_remove=ufile;}});if(file_to_remove){uploader.removeFile(file_to_remove);filesAdded--;}
$file.remove();return false;}}
var API={setup:function(){APP.init();},teardown:function(){APP.destroy();},removeUploaded:function(file){return APP.removeUploaded(file);}}
jq(document).ready(function(){APP.init();});return API;}
(window,window.jQuery,window.BuddyBoss_Media_Util));function bbmedia_getQueryVariable(query,variable){if(typeof query!=='string'||query==''||typeof variable=='undefined'||variable=='')
return'';var vars=query.split("&");for(var i=0;i<vars.length;i++){var pair=vars[i].split("=");if(pair[0]==variable){return pair[1];}}
return(false);}
bbmedia_move_media_opened=false;bbmedia_tag_friends_opened=false;jq(document).ready(function(){jq(document).keyup(function(e){if(e.keyCode==27&&(bbmedia_move_media_opened===true||bbmedia_tag_friends_opened===true)){if(bbmedia_move_media_opened===true)
buddyboss_media_move_media_close();if(bbmedia_tag_friends_opened===true)
buddyboss_media_tag_friends_close();}});setMediaPageCookie();jq.ajaxPrefilter(function(options,originalOptions,jqXHR){var originalSuccess=options.success;var action=bbmedia_getQueryVariable(options.data,'action');if(typeof action=='undefined'||action!='activity_get_older_updates')
return;options.success=function(data){jq('#bbmedia-grid-wrapper #activity-stream li.load-more').remove();if(originalSuccess!=null){originalSuccess(data);}};});jq('#activity-stream').on('click','.activity-meta > a.fav',function(){var img_wrap=jq(this).parents('.activity-content').find('.buddyboss-media-photos-wrap-container');if(!(img_wrap.length>0)){return;}
bbm_ps_mark_favorite(img_wrap);});jq('#activity-stream').on('click','.activity-meta > a.unfav',function(){var img_wrap=jq(this).parents('.activity-content').find('.buddyboss-media-photos-wrap-container');if(!(img_wrap.length>0)){return;}
bbm_ps_mark_unfavorite(img_wrap);});jq('#activity-stream').on('click','.acomment-options > a.fav-comment',function(){var img_wrap=jq(this).parent().parent().find('.acomment-content > .buddyboss-media-photos-wrap-container');if(!(img_wrap.length>0)){return;}
bbm_ps_mark_favorite(img_wrap);});jq('#activity-stream').on('click','.acomment-options > a.unfav-comment',function(){var img_wrap=jq(this).parent().parent().find('.acomment-content > .buddyboss-media-photos-wrap-container');if(!(img_wrap.length>0)){return;}
bbm_ps_mark_unfavorite(img_wrap);});jq('#activity-stream').on('click','input[name=ac_form_submit]',function(e){var $activity_elm=jq(this).parents('.activity-item');var img_wrap=$activity_elm.find('.activity-inner > .buddyboss-media-photos-wrap-container');if(!(img_wrap.length>0)){return;}
jq(img_wrap).find('.buddyboss-media-photo-wrap .buddyboss-media-photo').each(function(){var img=jq(this);var comment_count=img.attr('data-comment-count');var new_comment_count=parseInt(comment_count)+1;img.attr('data-comment-count',new_comment_count);});});jq('#activity-stream').on('click','a.acomment-delete',function(e){var $activity_elm=jq(this).parents('.activity-item');var $reply_thread=jq(this).parents('li[id^=acomment]:first').find('li[id^=acomment]');if(0<$reply_thread.length){var deleted_comments=$reply_thread.length+1;}else{var deleted_comments=1;}
var img_wrap=$activity_elm.find('.activity-inner > .buddyboss-media-photos-wrap-container');if(!(img_wrap.length>0)){return;}
jq(img_wrap).find('.buddyboss-media-photo-wrap .buddyboss-media-photo').each(function(){var img=jq(this);var comment_count=img.attr('data-comment-count');if(0<=comment_count){var new_comment_count=parseInt(comment_count)-deleted_comments;img.attr('data-comment-count',new_comment_count);}});});jq('div.buddyboss-media-photos-wrap-container').each(function(index,val){var tall_images=jq(this).find('a.size-activity-2-thumbnail-tall');tall_images_height_scale(tall_images[0],tall_images[1]);});jq(document).on('click','a.browse-file-button',function(e){e.preventDefault();});});var hidden,visibilityChange;if(typeof document.hidden!=="undefined"){hidden="hidden";visibilityChange="visibilitychange";}else if(typeof document.msHidden!=="undefined"){hidden="msHidden";visibilityChange="msvisibilitychange";}else if(typeof document.webkitHidden!=="undefined"){hidden="webkitHidden";visibilityChange="webkitvisibilitychange";}
function setMediaPageVisibilityChange(){if(!document[hidden]){setMediaPageCookie();}}
function setMediaPageCookie(){if(jq('body').hasClass('buddyboss-media-all-media')){docCookies.setItem("bp-bboss-is-media-page","yes","","/");}else{docCookies.removeItem("bp-bboss-is-media-page","/");}}
document.addEventListener(visibilityChange,setMediaPageVisibilityChange,false);function tall_images_height_scale(img1,img2){var h1=jq(img1).find('img').height();var h2=jq(img2).find('img').height();if(h1<h2){jq(img1).height(h2);jq(img1).find('img').height(h2);jq(img2).height(h2);jq(img2).find('img').height(h2);}
else if(h2<h1){jq(img2).height(h1);jq(img2).find('img').height(h1);jq(img1).height(h1);jq(img1).find('img').height(h1);}}
function bbm_ps_mark_favorite(img_wrap){jq(img_wrap).find('.buddyboss-media-photo-wrap .buddyboss-media-photo').each(function(){var fav_count=jq(this).attr('data-favorite-count');jq(this).attr('data-bbmfav','bbm-unfav');jq(this).attr('data-favorite-count',parseInt(fav_count)+1);});}
function bbm_ps_mark_unfavorite(img_wrap){jq(img_wrap).find('.buddyboss-media-photo-wrap .buddyboss-media-photo').each(function(){var fav_count=jq(this).attr('data-favorite-count');jq(this).attr('data-bbmfav','bbm-fav');if(fav_count==0){jq(this).attr('data-favorite-count',parseInt(fav_count));}else{jq(this).attr('data-favorite-count',parseInt(fav_count)-1);}});}
function buddyboss_media_initiate_media_move(link){$link=jq(link);$form=jq('#frm_buddyboss-media-move-media');$form_wrapper=$form.parent();$link.closest('.activity').find('form.ac-form').slideUp();if($form_wrapper.is(':visible')){buddyboss_media_move_media_close();return false;}
jq('.buddyboss-activity-comments-form').hide();$link.closest('.activity-content').after($form_wrapper);var selected_album=$link.data('album_id');if(!selected_album)
selected_album='';$form.find('#buddyboss_media_move_media_albums').val(selected_album);$form_wrapper.slideDown(200);bbmedia_move_media_opened=true;$form.find('input[name="activity_id"]').val($link.data('activity_id'));return false;}
function buddyboss_media_submit_media_move(){$form=jq('#frm_buddyboss-media-move-media');$submit_button=$form.find('input[type="submit"]');if($submit_button.hasClass('loading'))
return false;var bbm_move_media_albums_id=$form.find('select[name="buddyboss_media_move_media_albums"]').val();var data={'action':$form.find('input[name="action"]').val(),'bboss_media_move_media_nonce':$form.find('input[name="bboss_media_move_media_nonce"]').val(),'activity_id':$form.find('input[name="activity_id"]').val(),'buddyboss_media_move_media_albums':bbm_move_media_albums_id};$submit_button.addClass('loading');$form.find("#message").removeAttr('class').html('');jq.ajax({type:"POST",url:ajaxurl,data:data,success:function(response){response=jq.parseJSON(response);if(response.status){$form.find("#message").addClass('updated').html("<p>"+response.message+"</p>");if($form.find('input[name="is_single_album"]').val()=='yes'){setTimeout(function(){buddyboss_media_media_move_cleanup($form,true);},2000);}else{setTimeout(function(){buddyboss_media_media_move_cleanup($form,false);},2000);}
$form.parents('li.activity-item').find('a.buddyboss_media_move').data('album_id',bbm_move_media_albums_id);}else{$form.find("#message").addClass('error').html("<p>"+response.message+"</p>");}
$submit_button.removeClass('loading');}});return false;}
function buddyboss_media_media_move_cleanup($form,remove_activity_item){$form.find("#message").removeAttr('class').html('');$form_wrapper=$form.parent();buddyboss_media_move_media_close();if(remove_activity_item){$activity=$form.closest('.activity');jq('body').append($form_wrapper);$form_wrapper.hide();$activity.slideUp(200,function(){$activity.remove();});}}
function buddyboss_media_move_media_close(){$form=jq('#frm_buddyboss-media-move-media');$form_wrapper=$form.parent();$form_wrapper.slideUp(200);bbmedia_move_media_opened=false;return false;}
function buddyboss_media_initiate_tagging(link){$link=jq(link);$form=jq('#frm_buddyboss-media-tag-friends');$form_wrapper=$form.parent();$link.closest('.activity').find('form.ac-form').slideUp();if($form_wrapper.is(':visible')){buddyboss_media_tag_friends_close();return false;}
jq('.buddyboss-activity-comments-form').hide();$link.closest('.activity-content').after($form_wrapper);$form_wrapper.slideDown(200);bbmedia_tag_friends_opened=true;$form.find('input[name="ac_search"]').off('input').on('input',function(){buddyboss_media_tag_friends_search();});$form.find('.preloading').show();$form.find('input[name="activity_id"]').val($link.data('activity_id'));buddyboss_media_tag_friends_search();return false;}
function buddyboss_media_tag_friends_close(){$form=jq('#frm_buddyboss-media-tag-friends');$form_wrapper=$form.parent();$form.data('doingsearch','no');$form.find('#invite-list > ul').html('');$form.find('input[name="ac_search"]').off('input').val('').hide();$form_wrapper.slideUp(200);bbmedia_tag_friends_opened=false;return false;}
function buddyboss_media_tag_friends_search(){$form=jq('#frm_buddyboss-media-tag-friends');if($form.data('doingsearch')=='yes')
return false;var search_term=jq.trim($form.find('input[name="ac_search"]').val());var exclude_ids=[];$form.find('#invite-list > ul > li').each(function(){if(jq(this).hasClass('more_i10')){jq(this).remove();}else{if(jq(this).find('input[type="checkbox"]').is(':checked')){exclude_ids.push(jq(this).find('input[type="checkbox"]').val());}else{jq(this).remove();}}});$form.data('doingsearch','yes');$form.find('.preloading').show();$form.find('#message').each(function(){jq(this).remove();});var data={'action':$form.find('input[name="action"]').val(),'buddyboss_media_tag_friends_nonce':$form.find('input[name="buddyboss_media_tag_friends_nonce"]').val(),'activity_id':$form.find('input[name="activity_id"]').val(),'search_term':search_term,'exclude_ids':exclude_ids};jq.ajax({type:"POST",url:ajaxurl,data:data,success:function(response){if($form.data('doingsearch')=='no')
return;$form.find('.preloading').hide();response=jq.parseJSON(response);$ul=$form.find('#invite-list > ul');if(response.friends_list){var count=response.friends_list.length;for(var i=0;i<count;i++){$ul.append(response.friends_list[i]);}
if(count<response.total){var more=response.total-count;var more_i10=response.more_i10.replace('xx',more);$ul.append("<li class='more_i10'>"+more_i10+"</li>");}
$ul.show();}else{if($ul.html()!=''){$form.find('#invite-list').append(response.error);}}
jq('#invite-list input[name="friends[]"]').unbind('change').bind('change',function(){buddyboss_media_tag_friends_toggle_tag(data.activity_id,jq(this).val());});jq('#friend-list .action .remove').click(function(e){e.preventDefault();buddyboss_media_tag_friends_toggle_tag(data.activity_id,jq(this).data('userid'));});if(search_term==''&&response.show_search){$form.find('input[name="ac_search"]').show();}
$form.data('doingsearch','no');}});return false;}
function buddyboss_media_tag_friends_toggle_tag(activity_id,friend_id){$form=jq('#frm_buddyboss-media-tag-friends');var data={'action':$form.find('input[name="action_tag"]').val(),'buddyboss_media_tag_friends_nonce':$form.find('input[name="buddyboss_media_tag_friends_nonce"]').val(),'activity_id':activity_id,'friend_id':friend_id};jq.ajax({type:"POST",url:ajaxurl,data:data,success:function(response){}});}
function buddyboss_media_tag_friends_complete(){$form=jq('#frm_buddyboss-media-tag-friends');var data={'action':$form.find('input[name="action_tag_complete"]').val(),'buddyboss_media_tag_friends_nonce':$form.find('input[name="buddyboss_media_tag_friends_nonce"]').val(),'activity_id':$form.find('input[name="activity_id"]').val(),'update_action':false};if($form.closest('.activity').find(BuddyBoss_Media_Appstate.activity_header_selector).length>0){data.update_action=true;}
$form.find('input[type="submit"]').addClass('loading');jq.ajax({type:"POST",url:ajaxurl,data:data,success:function(response){$form.find('input[type="submit"]').removeClass('loading');if(data.update_action===true){response=jq.parseJSON(response);$activity=$form.closest('.activity');$activity.find(BuddyBoss_Media_Appstate.activity_header_selector).html(response.activity_action);if(response.activity_tooltip){$activity.find('.buddyboss-media-tt-content').remove();$activity.append(response.activity_tooltip);window.BBMediaTooltips.initTooltips();}}
buddyboss_media_tag_friends_close();}});return false;}
(function(window,$){var BBMediaTooltips={};var $el={};BBMediaTooltips.init=function(){BBMediaTooltips.initTooltips();}
BBMediaTooltips.initTooltips=function(){$el.tooltips=jq('.buddyboss-media-tt-others');if($el.tooltips.length){$el.tooltips.tooltipster({contentAsHTML:true,functionInit:BBMediaTooltips.getTooltipContent,interactive:true,position:'top-left',theme:'tooltipster-buddyboss'});}}
BBMediaTooltips.getTooltipContent=function(origin,content){var $content=origin.closest('li').find('.buddyboss-media-tt-content').detach().html();return $content;}
jq(document).ready(function(){if(BuddyBoss_Media_Appstate.enable_tagging==true){BBMediaTooltips.initTooltips();window.BBMediaTooltips=BBMediaTooltips;}});}(window,window.jQuery));var docCookies=docCookies||{getItem:function(sKey){if(!sKey){return null;}
return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(sKey).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null;},setItem:function(sKey,sValue,vEnd,sPath,sDomain,bSecure){if(!sKey||/^(?:expires|max\-age|path|domain|secure)$/i.test(sKey)){return false;}
var sExpires="";if(vEnd){switch(vEnd.constructor){case Number:sExpires=vEnd===Infinity?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+vEnd;break;case String:sExpires="; expires="+vEnd;break;case Date:sExpires="; expires="+vEnd.toUTCString();break;}}
document.cookie=encodeURIComponent(sKey)+"="+encodeURIComponent(sValue)+sExpires+(sDomain?"; domain="+sDomain:"")+(sPath?"; path="+sPath:"")+(bSecure?"; secure":"");return true;},removeItem:function(sKey,sPath,sDomain){if(!this.hasItem(sKey)){return false;}
document.cookie=encodeURIComponent(sKey)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(sDomain?"; domain="+sDomain:"")+(sPath?"; path="+sPath:"");return true;},hasItem:function(sKey){if(!sKey){return false;}
return(new RegExp("(?:^|;\\s*)"+encodeURIComponent(sKey).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=")).test(document.cookie);},keys:function(){var aKeys=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/);for(var nLen=aKeys.length,nIdx=0;nIdx<nLen;nIdx++){aKeys[nIdx]=decodeURIComponent(aKeys[nIdx]);}
return aKeys;}};
;function buddypress_edit_activity_initiate(a){return jQuery(a).hasClass("action-save")?buddypress_edit_activity_save(a):buddypress_edit_activity_get(a),!1}function buddypress_edit_activity_get(a){$link=jQuery(a),$form=jQuery("#frm_buddypress-edit-activity"),$form_wrapper=$form.parent(),$link.addClass("loading"),$link.hasClass("buddyboss_edit_activity_comment")?B_E_A_.current_activity_org=$link.closest("[id^=acomment]").find(" > .acomment-content").html():B_E_A_.current_activity_org=$link.closest(".activity-content").find(".activity-inner").html();var b={action:$form.find('input[name="action_get"]').val(),buddypress_edit_activity_nonce:$form.find('input[name="buddypress_edit_activity_nonce"]').val(),activity_id:$link.data("activity_id")};jQuery.ajax({type:"POST",url:ajaxurl,data:b,success:function(a){if(a=jQuery.parseJSON(a),a.status){$link.removeClass("loading").addClass("action-save").html(B_E_A_.button_text.save);var c=jQuery("<a href='#'>").addClass("bp-secondary-action buddyboss_edit_activity_cancel").html(B_E_A_.button_text.cancel);$link.before(c),c.attr("onclick","return buddypress_edit_activity_cancel(this);"),c.data("target_type","activity"),$link.hasClass("buddyboss_edit_activity_comment")?($link.closest("[id^=acomment]").find(" > .acomment-content").html("").hide().after($form_wrapper),c.data("target_type","comment")):($link.closest(".activity-content").find(".activity-inner").html("").hide().after($form_wrapper),c.addClass("button")),$form_wrapper.show(),$form.find('input[name="activity_id"]').val(b.activity_id),$form.find("textarea").val(a.content)}}})}function buddypress_edit_activity_save(a){$link=jQuery(a),$form=jQuery("#frm_buddypress-edit-activity"),$form_wrapper=$form.parent(),$link.addClass("loading"),jQuery(".buddyboss_edit_activity_cancel").remove();var b={action:$form.find('input[name="action_save"]').val(),buddypress_edit_activity_nonce:$form.find('input[name="buddypress_edit_activity_nonce"]').val(),activity_id:$link.data("activity_id"),content:$form.find("textarea").val()};jQuery.ajax({type:"POST",url:ajaxurl,data:b,success:function(a){a=jQuery.parseJSON(a),a.status&&($link.removeClass("loading").removeClass("action-save").html(B_E_A_.button_text.edit),$link.hasClass("buddyboss_edit_activity_comment")?$link.closest("[id^=acomment]").find(" > .acomment-content").html(a.content).show():$link.closest(".activity-content").find(".activity-inner").html(a.content).show(),$form_wrapper.hide(),jQuery("body").append($form_wrapper))}})}function buddypress_edit_activity_cancel(a){var b=jQuery(a),c=jQuery("#frm_buddypress-edit-activity"),d=c.parent(),e="";return"comment"==b.data("target_type")?(b.closest("[id^=acomment]").find(" > .acomment-content").html(B_E_A_.current_activity_org).show(),e=b.closest("[id^=acomment]").find(".buddyboss_edit_activity_comment.action-save")):(b.closest(".activity-content").find(".activity-inner").html(B_E_A_.current_activity_org).show(),e=b.closest(".activity-content").find(".buddyboss_edit_activity.action-save")),e.removeClass("action-save").html(B_E_A_.button_text.edit),d.hide(),jQuery("body").append(d),b.remove(),!1}
;/*! jQuery Validation Plugin - v1.13.1 - 10/14/2014
 * http://jqueryvalidation.org/
 * Copyright (c) 2014 Jörn Zaefferer; Licensed MIT */
!function(a){"function"==typeof define&&define.amd?define(["jquery","./jquery.validate.min"],a):a(jQuery)}(function(a){!function(){function b(a){return a.replace(/<.[^<>]*?>/g," ").replace(/&nbsp;|&#160;/gi," ").replace(/[.(),;:!?%#$'\"_+=\/\-“”’]*/g,"")}a.validator.addMethod("maxWords",function(a,c,d){return this.optional(c)||b(a).match(/\b\w+\b/g).length<=d},a.validator.format("Please enter {0} words or less.")),a.validator.addMethod("minWords",function(a,c,d){return this.optional(c)||b(a).match(/\b\w+\b/g).length>=d},a.validator.format("Please enter at least {0} words.")),a.validator.addMethod("rangeWords",function(a,c,d){var e=b(a),f=/\b\w+\b/g;return this.optional(c)||e.match(f).length>=d[0]&&e.match(f).length<=d[1]},a.validator.format("Please enter between {0} and {1} words."))}(),a.validator.addMethod("accept",function(b,c,d){var e,f,g="string"==typeof d?d.replace(/\s/g,"").replace(/,/g,"|"):"image/*",h=this.optional(c);if(h)return h;if("file"===a(c).attr("type")&&(g=g.replace(/\*/g,".*"),c.files&&c.files.length))for(e=0;e<c.files.length;e++)if(f=c.files[e],!f.type.match(new RegExp(".?("+g+")$","i")))return!1;return!0},a.validator.format("Please enter a value with a valid mimetype.")),a.validator.addMethod("alphanumeric",function(a,b){return this.optional(b)||/^\w+$/i.test(a)},"Letters, numbers, and underscores only please"),a.validator.addMethod("bankaccountNL",function(a,b){if(this.optional(b))return!0;if(!/^[0-9]{9}|([0-9]{2} ){3}[0-9]{3}$/.test(a))return!1;var c,d,e,f=a.replace(/ /g,""),g=0,h=f.length;for(c=0;h>c;c++)d=h-c,e=f.substring(c,c+1),g+=d*e;return g%11===0},"Please specify a valid bank account number"),a.validator.addMethod("bankorgiroaccountNL",function(b,c){return this.optional(c)||a.validator.methods.bankaccountNL.call(this,b,c)||a.validator.methods.giroaccountNL.call(this,b,c)},"Please specify a valid bank or giro account number"),a.validator.addMethod("bic",function(a,b){return this.optional(b)||/^([A-Z]{6}[A-Z2-9][A-NP-Z1-2])(X{3}|[A-WY-Z0-9][A-Z0-9]{2})?$/.test(a)},"Please specify a valid BIC code"),a.validator.addMethod("cifES",function(a){"use strict";var b,c,d,e,f,g,h=[];if(a=a.toUpperCase(),!a.match("((^[A-Z]{1}[0-9]{7}[A-Z0-9]{1}$|^[T]{1}[A-Z0-9]{8}$)|^[0-9]{8}[A-Z]{1}$)"))return!1;for(d=0;9>d;d++)h[d]=parseInt(a.charAt(d),10);for(c=h[2]+h[4]+h[6],e=1;8>e;e+=2)f=(2*h[e]).toString(),g=f.charAt(1),c+=parseInt(f.charAt(0),10)+(""===g?0:parseInt(g,10));return/^[ABCDEFGHJNPQRSUVW]{1}/.test(a)?(c+="",b=10-parseInt(c.charAt(c.length-1),10),a+=b,h[8].toString()===String.fromCharCode(64+b)||h[8].toString()===a.charAt(a.length-1)):!1},"Please specify a valid CIF number."),a.validator.addMethod("creditcardtypes",function(a,b,c){if(/[^0-9\-]+/.test(a))return!1;a=a.replace(/\D/g,"");var d=0;return c.mastercard&&(d|=1),c.visa&&(d|=2),c.amex&&(d|=4),c.dinersclub&&(d|=8),c.enroute&&(d|=16),c.discover&&(d|=32),c.jcb&&(d|=64),c.unknown&&(d|=128),c.all&&(d=255),1&d&&/^(5[12345])/.test(a)?16===a.length:2&d&&/^(4)/.test(a)?16===a.length:4&d&&/^(3[47])/.test(a)?15===a.length:8&d&&/^(3(0[012345]|[68]))/.test(a)?14===a.length:16&d&&/^(2(014|149))/.test(a)?15===a.length:32&d&&/^(6011)/.test(a)?16===a.length:64&d&&/^(3)/.test(a)?16===a.length:64&d&&/^(2131|1800)/.test(a)?15===a.length:128&d?!0:!1},"Please enter a valid credit card number."),a.validator.addMethod("currency",function(a,b,c){var d,e="string"==typeof c,f=e?c:c[0],g=e?!0:c[1];return f=f.replace(/,/g,""),f=g?f+"]":f+"]?",d="^["+f+"([1-9]{1}[0-9]{0,2}(\\,[0-9]{3})*(\\.[0-9]{0,2})?|[1-9]{1}[0-9]{0,}(\\.[0-9]{0,2})?|0(\\.[0-9]{0,2})?|(\\.[0-9]{1,2})?)$",d=new RegExp(d),this.optional(b)||d.test(a)},"Please specify a valid currency"),a.validator.addMethod("dateFA",function(a,b){return this.optional(b)||/^[1-4]\d{3}\/((0?[1-6]\/((3[0-1])|([1-2][0-9])|(0?[1-9])))|((1[0-2]|(0?[7-9]))\/(30|([1-2][0-9])|(0?[1-9]))))$/.test(a)},"Please enter a correct date"),a.validator.addMethod("dateITA",function(a,b){var c,d,e,f,g,h=!1,i=/^\d{1,2}\/\d{1,2}\/\d{4}$/;return i.test(a)?(c=a.split("/"),d=parseInt(c[0],10),e=parseInt(c[1],10),f=parseInt(c[2],10),g=new Date(f,e-1,d,12,0,0,0),h=g.getUTCFullYear()===f&&g.getUTCMonth()===e-1&&g.getUTCDate()===d?!0:!1):h=!1,this.optional(b)||h},"Please enter a correct date"),a.validator.addMethod("dateNL",function(a,b){return this.optional(b)||/^(0?[1-9]|[12]\d|3[01])[\.\/\-](0?[1-9]|1[012])[\.\/\-]([12]\d)?(\d\d)$/.test(a)},"Please enter a correct date"),a.validator.addMethod("extension",function(a,b,c){return c="string"==typeof c?c.replace(/,/g,"|"):"png|jpe?g|gif",this.optional(b)||a.match(new RegExp(".("+c+")$","i"))},a.validator.format("Please enter a value with a valid extension.")),a.validator.addMethod("giroaccountNL",function(a,b){return this.optional(b)||/^[0-9]{1,7}$/.test(a)},"Please specify a valid giro account number"),a.validator.addMethod("iban",function(a,b){if(this.optional(b))return!0;var c,d,e,f,g,h,i,j,k,l=a.replace(/ /g,"").toUpperCase(),m="",n=!0,o="",p="";if(!/^([a-zA-Z0-9]{4} ){2,8}[a-zA-Z0-9]{1,4}|[a-zA-Z0-9]{12,34}$/.test(l))return!1;if(c=l.substring(0,2),h={AL:"\\d{8}[\\dA-Z]{16}",AD:"\\d{8}[\\dA-Z]{12}",AT:"\\d{16}",AZ:"[\\dA-Z]{4}\\d{20}",BE:"\\d{12}",BH:"[A-Z]{4}[\\dA-Z]{14}",BA:"\\d{16}",BR:"\\d{23}[A-Z][\\dA-Z]",BG:"[A-Z]{4}\\d{6}[\\dA-Z]{8}",CR:"\\d{17}",HR:"\\d{17}",CY:"\\d{8}[\\dA-Z]{16}",CZ:"\\d{20}",DK:"\\d{14}",DO:"[A-Z]{4}\\d{20}",EE:"\\d{16}",FO:"\\d{14}",FI:"\\d{14}",FR:"\\d{10}[\\dA-Z]{11}\\d{2}",GE:"[\\dA-Z]{2}\\d{16}",DE:"\\d{18}",GI:"[A-Z]{4}[\\dA-Z]{15}",GR:"\\d{7}[\\dA-Z]{16}",GL:"\\d{14}",GT:"[\\dA-Z]{4}[\\dA-Z]{20}",HU:"\\d{24}",IS:"\\d{22}",IE:"[\\dA-Z]{4}\\d{14}",IL:"\\d{19}",IT:"[A-Z]\\d{10}[\\dA-Z]{12}",KZ:"\\d{3}[\\dA-Z]{13}",KW:"[A-Z]{4}[\\dA-Z]{22}",LV:"[A-Z]{4}[\\dA-Z]{13}",LB:"\\d{4}[\\dA-Z]{20}",LI:"\\d{5}[\\dA-Z]{12}",LT:"\\d{16}",LU:"\\d{3}[\\dA-Z]{13}",MK:"\\d{3}[\\dA-Z]{10}\\d{2}",MT:"[A-Z]{4}\\d{5}[\\dA-Z]{18}",MR:"\\d{23}",MU:"[A-Z]{4}\\d{19}[A-Z]{3}",MC:"\\d{10}[\\dA-Z]{11}\\d{2}",MD:"[\\dA-Z]{2}\\d{18}",ME:"\\d{18}",NL:"[A-Z]{4}\\d{10}",NO:"\\d{11}",PK:"[\\dA-Z]{4}\\d{16}",PS:"[\\dA-Z]{4}\\d{21}",PL:"\\d{24}",PT:"\\d{21}",RO:"[A-Z]{4}[\\dA-Z]{16}",SM:"[A-Z]\\d{10}[\\dA-Z]{12}",SA:"\\d{2}[\\dA-Z]{18}",RS:"\\d{18}",SK:"\\d{20}",SI:"\\d{15}",ES:"\\d{20}",SE:"\\d{20}",CH:"\\d{5}[\\dA-Z]{12}",TN:"\\d{20}",TR:"\\d{5}[\\dA-Z]{17}",AE:"\\d{3}\\d{16}",GB:"[A-Z]{4}\\d{14}",VG:"[\\dA-Z]{4}\\d{16}"},g=h[c],"undefined"!=typeof g&&(i=new RegExp("^[A-Z]{2}\\d{2}"+g+"$",""),!i.test(l)))return!1;for(d=l.substring(4,l.length)+l.substring(0,4),j=0;j<d.length;j++)e=d.charAt(j),"0"!==e&&(n=!1),n||(m+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(e));for(k=0;k<m.length;k++)f=m.charAt(k),p=""+o+f,o=p%97;return 1===o},"Please specify a valid IBAN"),a.validator.addMethod("integer",function(a,b){return this.optional(b)||/^-?\d+$/.test(a)},"A positive or negative non-decimal number please"),a.validator.addMethod("ipv4",function(a,b){return this.optional(b)||/^(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)$/i.test(a)},"Please enter a valid IP v4 address."),a.validator.addMethod("ipv6",function(a,b){return this.optional(b)||/^((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))$/i.test(a)},"Please enter a valid IP v6 address."),a.validator.addMethod("lettersonly",function(a,b){return this.optional(b)||/^[a-z]+$/i.test(a)},"Letters only please"),a.validator.addMethod("letterswithbasicpunc",function(a,b){return this.optional(b)||/^[a-z\-.,()'"\s]+$/i.test(a)},"Letters or punctuation only please"),a.validator.addMethod("mobileNL",function(a,b){return this.optional(b)||/^((\+|00(\s|\s?\-\s?)?)31(\s|\s?\-\s?)?(\(0\)[\-\s]?)?|0)6((\s|\s?\-\s?)?[0-9]){8}$/.test(a)},"Please specify a valid mobile number"),a.validator.addMethod("mobileUK",function(a,b){return a=a.replace(/\(|\)|\s+|-/g,""),this.optional(b)||a.length>9&&a.match(/^(?:(?:(?:00\s?|\+)44\s?|0)7(?:[1345789]\d{2}|624)\s?\d{3}\s?\d{3})$/)},"Please specify a valid mobile number"),a.validator.addMethod("nieES",function(a){"use strict";return a=a.toUpperCase(),a.match("((^[A-Z]{1}[0-9]{7}[A-Z0-9]{1}$|^[T]{1}[A-Z0-9]{8}$)|^[0-9]{8}[A-Z]{1}$)")?/^[T]{1}/.test(a)?a[8]===/^[T]{1}[A-Z0-9]{8}$/.test(a):/^[XYZ]{1}/.test(a)?a[8]==="TRWAGMYFPDXBNJZSQVHLCKE".charAt(a.replace("X","0").replace("Y","1").replace("Z","2").substring(0,8)%23):!1:!1},"Please specify a valid NIE number."),a.validator.addMethod("nifES",function(a){"use strict";return a=a.toUpperCase(),a.match("((^[A-Z]{1}[0-9]{7}[A-Z0-9]{1}$|^[T]{1}[A-Z0-9]{8}$)|^[0-9]{8}[A-Z]{1}$)")?/^[0-9]{8}[A-Z]{1}$/.test(a)?"TRWAGMYFPDXBNJZSQVHLCKE".charAt(a.substring(8,0)%23)===a.charAt(8):/^[KLM]{1}/.test(a)?a[8]===String.fromCharCode(64):!1:!1},"Please specify a valid NIF number."),a.validator.addMethod("nowhitespace",function(a,b){return this.optional(b)||/^\S+$/i.test(a)},"No white space please"),a.validator.addMethod("pattern",function(a,b,c){return this.optional(b)?!0:("string"==typeof c&&(c=new RegExp("^(?:"+c+")$")),c.test(a))},"Invalid format."),a.validator.addMethod("phoneNL",function(a,b){return this.optional(b)||/^((\+|00(\s|\s?\-\s?)?)31(\s|\s?\-\s?)?(\(0\)[\-\s]?)?|0)[1-9]((\s|\s?\-\s?)?[0-9]){8}$/.test(a)},"Please specify a valid phone number."),a.validator.addMethod("phoneUK",function(a,b){return a=a.replace(/\(|\)|\s+|-/g,""),this.optional(b)||a.length>9&&a.match(/^(?:(?:(?:00\s?|\+)44\s?)|(?:\(?0))(?:\d{2}\)?\s?\d{4}\s?\d{4}|\d{3}\)?\s?\d{3}\s?\d{3,4}|\d{4}\)?\s?(?:\d{5}|\d{3}\s?\d{3})|\d{5}\)?\s?\d{4,5})$/)},"Please specify a valid phone number"),a.validator.addMethod("phoneUS",function(a,b){return a=a.replace(/\s+/g,""),this.optional(b)||a.length>9&&a.match(/^(\+?1-?)?(\([2-9]([02-9]\d|1[02-9])\)|[2-9]([02-9]\d|1[02-9]))-?[2-9]([02-9]\d|1[02-9])-?\d{4}$/)},"Please specify a valid phone number"),a.validator.addMethod("phonesUK",function(a,b){return a=a.replace(/\(|\)|\s+|-/g,""),this.optional(b)||a.length>9&&a.match(/^(?:(?:(?:00\s?|\+)44\s?|0)(?:1\d{8,9}|[23]\d{9}|7(?:[1345789]\d{8}|624\d{6})))$/)},"Please specify a valid uk phone number"),a.validator.addMethod("postalCodeCA",function(a,b){return this.optional(b)||/^[ABCEGHJKLMNPRSTVXY]\d[A-Z] \d[A-Z]\d$/.test(a)},"Please specify a valid postal code"),a.validator.addMethod("postalcodeBR",function(a,b){return this.optional(b)||/^\d{2}.\d{3}-\d{3}?$|^\d{5}-?\d{3}?$/.test(a)},"Informe um CEP válido."),a.validator.addMethod("postalcodeIT",function(a,b){return this.optional(b)||/^\d{5}$/.test(a)},"Please specify a valid postal code"),a.validator.addMethod("postalcodeNL",function(a,b){return this.optional(b)||/^[1-9][0-9]{3}\s?[a-zA-Z]{2}$/.test(a)},"Please specify a valid postal code"),a.validator.addMethod("postcodeUK",function(a,b){return this.optional(b)||/^((([A-PR-UWYZ][0-9])|([A-PR-UWYZ][0-9][0-9])|([A-PR-UWYZ][A-HK-Y][0-9])|([A-PR-UWYZ][A-HK-Y][0-9][0-9])|([A-PR-UWYZ][0-9][A-HJKSTUW])|([A-PR-UWYZ][A-HK-Y][0-9][ABEHMNPRVWXY]))\s?([0-9][ABD-HJLNP-UW-Z]{2})|(GIR)\s?(0AA))$/i.test(a)},"Please specify a valid UK postcode"),a.validator.addMethod("require_from_group",function(b,c,d){var e=a(d[1],c.form),f=e.eq(0),g=f.data("valid_req_grp")?f.data("valid_req_grp"):a.extend({},this),h=e.filter(function(){return g.elementValue(this)}).length>=d[0];return f.data("valid_req_grp",g),a(c).data("being_validated")||(e.data("being_validated",!0),e.each(function(){g.element(this)}),e.data("being_validated",!1)),h},a.validator.format("Please fill at least {0} of these fields.")),a.validator.addMethod("skip_or_fill_minimum",function(b,c,d){var e=a(d[1],c.form),f=e.eq(0),g=f.data("valid_skip")?f.data("valid_skip"):a.extend({},this),h=e.filter(function(){return g.elementValue(this)}).length,i=0===h||h>=d[0];return f.data("valid_skip",g),a(c).data("being_validated")||(e.data("being_validated",!0),e.each(function(){g.element(this)}),e.data("being_validated",!1)),i},a.validator.format("Please either skip these fields or fill at least {0} of them.")),jQuery.validator.addMethod("stateUS",function(a,b,c){var d,e="undefined"==typeof c,f=e||"undefined"==typeof c.caseSensitive?!1:c.caseSensitive,g=e||"undefined"==typeof c.includeTerritories?!1:c.includeTerritories,h=e||"undefined"==typeof c.includeMilitary?!1:c.includeMilitary;return d=g||h?g&&h?"^(A[AEKLPRSZ]|C[AOT]|D[CE]|FL|G[AU]|HI|I[ADLN]|K[SY]|LA|M[ADEINOPST]|N[CDEHJMVY]|O[HKR]|P[AR]|RI|S[CD]|T[NX]|UT|V[AIT]|W[AIVY])$":g?"^(A[KLRSZ]|C[AOT]|D[CE]|FL|G[AU]|HI|I[ADLN]|K[SY]|LA|M[ADEINOPST]|N[CDEHJMVY]|O[HKR]|P[AR]|RI|S[CD]|T[NX]|UT|V[AIT]|W[AIVY])$":"^(A[AEKLPRZ]|C[AOT]|D[CE]|FL|GA|HI|I[ADLN]|K[SY]|LA|M[ADEINOST]|N[CDEHJMVY]|O[HKR]|PA|RI|S[CD]|T[NX]|UT|V[AT]|W[AIVY])$":"^(A[KLRZ]|C[AOT]|D[CE]|FL|GA|HI|I[ADLN]|K[SY]|LA|M[ADEINOST]|N[CDEHJMVY]|O[HKR]|PA|RI|S[CD]|T[NX]|UT|V[AT]|W[AIVY])$",d=f?new RegExp(d):new RegExp(d,"i"),this.optional(b)||d.test(a)},"Please specify a valid state"),a.validator.addMethod("strippedminlength",function(b,c,d){return a(b).text().length>=d},a.validator.format("Please enter at least {0} characters")),a.validator.addMethod("time",function(a,b){return this.optional(b)||/^([01]\d|2[0-3])(:[0-5]\d){1,2}$/.test(a)},"Please enter a valid time, between 00:00 and 23:59"),a.validator.addMethod("time12h",function(a,b){return this.optional(b)||/^((0?[1-9]|1[012])(:[0-5]\d){1,2}(\ ?[AP]M))$/i.test(a)},"Please enter a valid time in 12-hour am/pm format"),a.validator.addMethod("url2",function(a,b){return this.optional(b)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)*(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)},a.validator.messages.url),a.validator.addMethod("vinUS",function(a){if(17!==a.length)return!1;var b,c,d,e,f,g,h=["A","B","C","D","E","F","G","H","J","K","L","M","N","P","R","S","T","U","V","W","X","Y","Z"],i=[1,2,3,4,5,6,7,8,1,2,3,4,5,7,9,2,3,4,5,6,7,8,9],j=[8,7,6,5,4,3,2,10,0,9,8,7,6,5,4,3,2],k=0;for(b=0;17>b;b++){if(e=j[b],d=a.slice(b,b+1),8===b&&(g=d),isNaN(d)){for(c=0;c<h.length;c++)if(d.toUpperCase()===h[c]){d=i[c],d*=e,isNaN(g)&&8===c&&(g=h[c]);break}}else d*=e;k+=d}return f=k%11,10===f&&(f="X"),f===g?!0:!1},"The specified vehicle identification number (VIN) is invalid."),a.validator.addMethod("zipcodeUS",function(a,b){return this.optional(b)||/^\d{5}(-\d{4})?$/.test(a)},"The specified US ZIP Code is invalid"),a.validator.addMethod("ziprange",function(a,b){return this.optional(b)||/^90[2-5]\d\{2\}-\d{4}$/.test(a)},"Your ZIP-code must be in the range 902xx-xxxx to 905xx-xxxx")});
;/* Javascript plotting library for jQuery, version 0.8.3.

Copyright (c) 2007-2014 IOLA and Ole Laursen.
Licensed under the MIT license.

*/
(function($){$.color={};$.color.make=function(r,g,b,a){var o={};o.r=r||0;o.g=g||0;o.b=b||0;o.a=a!=null?a:1;o.add=function(c,d){for(var i=0;i<c.length;++i)o[c.charAt(i)]+=d;return o.normalize()};o.scale=function(c,f){for(var i=0;i<c.length;++i)o[c.charAt(i)]*=f;return o.normalize()};o.toString=function(){if(o.a>=1){return"rgb("+[o.r,o.g,o.b].join(",")+")"}else{return"rgba("+[o.r,o.g,o.b,o.a].join(",")+")"}};o.normalize=function(){function clamp(min,value,max){return value<min?min:value>max?max:value}o.r=clamp(0,parseInt(o.r),255);o.g=clamp(0,parseInt(o.g),255);o.b=clamp(0,parseInt(o.b),255);o.a=clamp(0,o.a,1);return o};o.clone=function(){return $.color.make(o.r,o.b,o.g,o.a)};return o.normalize()};$.color.extract=function(elem,css){var c;do{c=elem.css(css).toLowerCase();if(c!=""&&c!="transparent")break;elem=elem.parent()}while(elem.length&&!$.nodeName(elem.get(0),"body"));if(c=="rgba(0, 0, 0, 0)")c="transparent";return $.color.parse(c)};$.color.parse=function(str){var res,m=$.color.make;if(res=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(str))return m(parseInt(res[1],10),parseInt(res[2],10),parseInt(res[3],10));if(res=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(str))return m(parseInt(res[1],10),parseInt(res[2],10),parseInt(res[3],10),parseFloat(res[4]));if(res=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(str))return m(parseFloat(res[1])*2.55,parseFloat(res[2])*2.55,parseFloat(res[3])*2.55);if(res=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(str))return m(parseFloat(res[1])*2.55,parseFloat(res[2])*2.55,parseFloat(res[3])*2.55,parseFloat(res[4]));if(res=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(str))return m(parseInt(res[1],16),parseInt(res[2],16),parseInt(res[3],16));if(res=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(str))return m(parseInt(res[1]+res[1],16),parseInt(res[2]+res[2],16),parseInt(res[3]+res[3],16));var name=$.trim(str).toLowerCase();if(name=="transparent")return m(255,255,255,0);else{res=lookupColors[name]||[0,0,0];return m(res[0],res[1],res[2])}};var lookupColors={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery);(function($){var hasOwnProperty=Object.prototype.hasOwnProperty;if(!$.fn.detach){$.fn.detach=function(){return this.each(function(){if(this.parentNode){this.parentNode.removeChild(this)}})}}function Canvas(cls,container){var element=container.children("."+cls)[0];if(element==null){element=document.createElement("canvas");element.className=cls;$(element).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(container);if(!element.getContext){if(window.G_vmlCanvasManager){element=window.G_vmlCanvasManager.initElement(element)}else{throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.")}}}this.element=element;var context=this.context=element.getContext("2d");var devicePixelRatio=window.devicePixelRatio||1,backingStoreRatio=context.webkitBackingStorePixelRatio||context.mozBackingStorePixelRatio||context.msBackingStorePixelRatio||context.oBackingStorePixelRatio||context.backingStorePixelRatio||1;this.pixelRatio=devicePixelRatio/backingStoreRatio;this.resize(container.width(),container.height());this.textContainer=null;this.text={};this._textCache={}}Canvas.prototype.resize=function(width,height){if(width<=0||height<=0){throw new Error("Invalid dimensions for plot, width = "+width+", height = "+height)}var element=this.element,context=this.context,pixelRatio=this.pixelRatio;if(this.width!=width){element.width=width*pixelRatio;element.style.width=width+"px";this.width=width}if(this.height!=height){element.height=height*pixelRatio;element.style.height=height+"px";this.height=height}context.restore();context.save();context.scale(pixelRatio,pixelRatio)};Canvas.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)};Canvas.prototype.render=function(){var cache=this._textCache;for(var layerKey in cache){if(hasOwnProperty.call(cache,layerKey)){var layer=this.getTextLayer(layerKey),layerCache=cache[layerKey];layer.hide();for(var styleKey in layerCache){if(hasOwnProperty.call(layerCache,styleKey)){var styleCache=layerCache[styleKey];for(var key in styleCache){if(hasOwnProperty.call(styleCache,key)){var positions=styleCache[key].positions;for(var i=0,position;position=positions[i];i++){if(position.active){if(!position.rendered){layer.append(position.element);position.rendered=true}}else{positions.splice(i--,1);if(position.rendered){position.element.detach()}}}if(positions.length==0){delete styleCache[key]}}}}}layer.show()}}};Canvas.prototype.getTextLayer=function(classes){var layer=this.text[classes];if(layer==null){if(this.textContainer==null){this.textContainer=$("<div class='flot-text'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)}layer=this.text[classes]=$("<div></div>").addClass(classes).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)}return layer};Canvas.prototype.getTextInfo=function(layer,text,font,angle,width){var textStyle,layerCache,styleCache,info;text=""+text;if(typeof font==="object"){textStyle=font.style+" "+font.variant+" "+font.weight+" "+font.size+"px/"+font.lineHeight+"px "+font.family}else{textStyle=font}layerCache=this._textCache[layer];if(layerCache==null){layerCache=this._textCache[layer]={}}styleCache=layerCache[textStyle];if(styleCache==null){styleCache=layerCache[textStyle]={}}info=styleCache[text];if(info==null){var element=$("<div></div>").html(text).css({position:"absolute","max-width":width,top:-9999}).appendTo(this.getTextLayer(layer));if(typeof font==="object"){element.css({font:textStyle,color:font.color})}else if(typeof font==="string"){element.addClass(font)}info=styleCache[text]={width:element.outerWidth(true),height:element.outerHeight(true),element:element,positions:[]};element.detach()}return info};Canvas.prototype.addText=function(layer,x,y,text,font,angle,width,halign,valign){var info=this.getTextInfo(layer,text,font,angle,width),positions=info.positions;if(halign=="center"){x-=info.width/2}else if(halign=="right"){x-=info.width}if(valign=="middle"){y-=info.height/2}else if(valign=="bottom"){y-=info.height}for(var i=0,position;position=positions[i];i++){if(position.x==x&&position.y==y){position.active=true;return}}position={active:true,rendered:false,element:positions.length?info.element.clone():info.element,x:x,y:y};positions.push(position);position.element.css({top:Math.round(y),left:Math.round(x),"text-align":halign})};Canvas.prototype.removeText=function(layer,x,y,text,font,angle){if(text==null){var layerCache=this._textCache[layer];if(layerCache!=null){for(var styleKey in layerCache){if(hasOwnProperty.call(layerCache,styleKey)){var styleCache=layerCache[styleKey];for(var key in styleCache){if(hasOwnProperty.call(styleCache,key)){var positions=styleCache[key].positions;for(var i=0,position;position=positions[i];i++){position.active=false}}}}}}}else{var positions=this.getTextInfo(layer,text,font,angle).positions;for(var i=0,position;position=positions[i];i++){if(position.x==x&&position.y==y){position.active=false}}}};function Plot(placeholder,data_,options_,plugins){var series=[],options={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:true,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:false,radius:3,lineWidth:2,fill:true,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:false,fillColor:null,steps:false},bars:{show:false,lineWidth:2,barWidth:1,fill:true,fillColor:null,align:"left",horizontal:false,zero:true},shadowSize:3,highlightColor:null},grid:{show:true,aboveData:false,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:false,hoverable:false,autoHighlight:true,mouseActiveRadius:10},interaction:{redrawOverlayInterval:1e3/60},hooks:{}},surface=null,overlay=null,eventHolder=null,ctx=null,octx=null,xaxes=[],yaxes=[],plotOffset={left:0,right:0,top:0,bottom:0},plotWidth=0,plotHeight=0,hooks={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},plot=this;plot.setData=setData;plot.setupGrid=setupGrid;plot.draw=draw;plot.getPlaceholder=function(){return placeholder};plot.getCanvas=function(){return surface.element};plot.getPlotOffset=function(){return plotOffset};plot.width=function(){return plotWidth};plot.height=function(){return plotHeight};plot.offset=function(){var o=eventHolder.offset();o.left+=plotOffset.left;o.top+=plotOffset.top;return o};plot.getData=function(){return series};plot.getAxes=function(){var res={},i;$.each(xaxes.concat(yaxes),function(_,axis){if(axis)res[axis.direction+(axis.n!=1?axis.n:"")+"axis"]=axis});return res};plot.getXAxes=function(){return xaxes};plot.getYAxes=function(){return yaxes};plot.c2p=canvasToAxisCoords;plot.p2c=axisToCanvasCoords;plot.getOptions=function(){return options};plot.highlight=highlight;plot.unhighlight=unhighlight;plot.triggerRedrawOverlay=triggerRedrawOverlay;plot.pointOffset=function(point){return{left:parseInt(xaxes[axisNumber(point,"x")-1].p2c(+point.x)+plotOffset.left,10),top:parseInt(yaxes[axisNumber(point,"y")-1].p2c(+point.y)+plotOffset.top,10)}};plot.shutdown=shutdown;plot.destroy=function(){shutdown();placeholder.removeData("plot").empty();series=[];options=null;surface=null;overlay=null;eventHolder=null;ctx=null;octx=null;xaxes=[];yaxes=[];hooks=null;highlights=[];plot=null};plot.resize=function(){var width=placeholder.width(),height=placeholder.height();surface.resize(width,height);overlay.resize(width,height)};plot.hooks=hooks;initPlugins(plot);parseOptions(options_);setupCanvases();setData(data_);setupGrid();draw();bindEvents();function executeHooks(hook,args){args=[plot].concat(args);for(var i=0;i<hook.length;++i)hook[i].apply(this,args)}function initPlugins(){var classes={Canvas:Canvas};for(var i=0;i<plugins.length;++i){var p=plugins[i];p.init(plot,classes);if(p.options)$.extend(true,options,p.options)}}function parseOptions(opts){$.extend(true,options,opts);if(opts&&opts.colors){options.colors=opts.colors}if(options.xaxis.color==null)options.xaxis.color=$.color.parse(options.grid.color).scale("a",.22).toString();if(options.yaxis.color==null)options.yaxis.color=$.color.parse(options.grid.color).scale("a",.22).toString();if(options.xaxis.tickColor==null)options.xaxis.tickColor=options.grid.tickColor||options.xaxis.color;if(options.yaxis.tickColor==null)options.yaxis.tickColor=options.grid.tickColor||options.yaxis.color;if(options.grid.borderColor==null)options.grid.borderColor=options.grid.color;if(options.grid.tickColor==null)options.grid.tickColor=$.color.parse(options.grid.color).scale("a",.22).toString();var i,axisOptions,axisCount,fontSize=placeholder.css("font-size"),fontSizeDefault=fontSize?+fontSize.replace("px",""):13,fontDefaults={style:placeholder.css("font-style"),size:Math.round(.8*fontSizeDefault),variant:placeholder.css("font-variant"),weight:placeholder.css("font-weight"),family:placeholder.css("font-family")};axisCount=options.xaxes.length||1;for(i=0;i<axisCount;++i){axisOptions=options.xaxes[i];if(axisOptions&&!axisOptions.tickColor){axisOptions.tickColor=axisOptions.color}axisOptions=$.extend(true,{},options.xaxis,axisOptions);options.xaxes[i]=axisOptions;if(axisOptions.font){axisOptions.font=$.extend({},fontDefaults,axisOptions.font);if(!axisOptions.font.color){axisOptions.font.color=axisOptions.color}if(!axisOptions.font.lineHeight){axisOptions.font.lineHeight=Math.round(axisOptions.font.size*1.15)}}}axisCount=options.yaxes.length||1;for(i=0;i<axisCount;++i){axisOptions=options.yaxes[i];if(axisOptions&&!axisOptions.tickColor){axisOptions.tickColor=axisOptions.color}axisOptions=$.extend(true,{},options.yaxis,axisOptions);options.yaxes[i]=axisOptions;if(axisOptions.font){axisOptions.font=$.extend({},fontDefaults,axisOptions.font);if(!axisOptions.font.color){axisOptions.font.color=axisOptions.color}if(!axisOptions.font.lineHeight){axisOptions.font.lineHeight=Math.round(axisOptions.font.size*1.15)}}}if(options.xaxis.noTicks&&options.xaxis.ticks==null)options.xaxis.ticks=options.xaxis.noTicks;if(options.yaxis.noTicks&&options.yaxis.ticks==null)options.yaxis.ticks=options.yaxis.noTicks;if(options.x2axis){options.xaxes[1]=$.extend(true,{},options.xaxis,options.x2axis);options.xaxes[1].position="top";if(options.x2axis.min==null){options.xaxes[1].min=null}if(options.x2axis.max==null){options.xaxes[1].max=null}}if(options.y2axis){options.yaxes[1]=$.extend(true,{},options.yaxis,options.y2axis);options.yaxes[1].position="right";if(options.y2axis.min==null){options.yaxes[1].min=null}if(options.y2axis.max==null){options.yaxes[1].max=null}}if(options.grid.coloredAreas)options.grid.markings=options.grid.coloredAreas;if(options.grid.coloredAreasColor)options.grid.markingsColor=options.grid.coloredAreasColor;if(options.lines)$.extend(true,options.series.lines,options.lines);if(options.points)$.extend(true,options.series.points,options.points);if(options.bars)$.extend(true,options.series.bars,options.bars);if(options.shadowSize!=null)options.series.shadowSize=options.shadowSize;if(options.highlightColor!=null)options.series.highlightColor=options.highlightColor;for(i=0;i<options.xaxes.length;++i)getOrCreateAxis(xaxes,i+1).options=options.xaxes[i];for(i=0;i<options.yaxes.length;++i)getOrCreateAxis(yaxes,i+1).options=options.yaxes[i];for(var n in hooks)if(options.hooks[n]&&options.hooks[n].length)hooks[n]=hooks[n].concat(options.hooks[n]);executeHooks(hooks.processOptions,[options])}function setData(d){series=parseData(d);fillInSeriesOptions();processData()}function parseData(d){var res=[];for(var i=0;i<d.length;++i){var s=$.extend(true,{},options.series);if(d[i].data!=null){s.data=d[i].data;delete d[i].data;$.extend(true,s,d[i]);d[i].data=s.data}else s.data=d[i];res.push(s)}return res}function axisNumber(obj,coord){var a=obj[coord+"axis"];if(typeof a=="object")a=a.n;if(typeof a!="number")a=1;return a}function allAxes(){return $.grep(xaxes.concat(yaxes),function(a){return a})}function canvasToAxisCoords(pos){var res={},i,axis;for(i=0;i<xaxes.length;++i){axis=xaxes[i];if(axis&&axis.used)res["x"+axis.n]=axis.c2p(pos.left)}for(i=0;i<yaxes.length;++i){axis=yaxes[i];if(axis&&axis.used)res["y"+axis.n]=axis.c2p(pos.top)}if(res.x1!==undefined)res.x=res.x1;if(res.y1!==undefined)res.y=res.y1;return res}function axisToCanvasCoords(pos){var res={},i,axis,key;for(i=0;i<xaxes.length;++i){axis=xaxes[i];if(axis&&axis.used){key="x"+axis.n;if(pos[key]==null&&axis.n==1)key="x";if(pos[key]!=null){res.left=axis.p2c(pos[key]);break}}}for(i=0;i<yaxes.length;++i){axis=yaxes[i];if(axis&&axis.used){key="y"+axis.n;if(pos[key]==null&&axis.n==1)key="y";if(pos[key]!=null){res.top=axis.p2c(pos[key]);break}}}return res}function getOrCreateAxis(axes,number){if(!axes[number-1])axes[number-1]={n:number,direction:axes==xaxes?"x":"y",options:$.extend(true,{},axes==xaxes?options.xaxis:options.yaxis)};return axes[number-1]}function fillInSeriesOptions(){var neededColors=series.length,maxIndex=-1,i;for(i=0;i<series.length;++i){var sc=series[i].color;if(sc!=null){neededColors--;if(typeof sc=="number"&&sc>maxIndex){maxIndex=sc}}}if(neededColors<=maxIndex){neededColors=maxIndex+1}var c,colors=[],colorPool=options.colors,colorPoolSize=colorPool.length,variation=0;for(i=0;i<neededColors;i++){c=$.color.parse(colorPool[i%colorPoolSize]||"#666");if(i%colorPoolSize==0&&i){if(variation>=0){if(variation<.5){variation=-variation-.2}else variation=0}else variation=-variation}colors[i]=c.scale("rgb",1+variation)}var colori=0,s;for(i=0;i<series.length;++i){s=series[i];if(s.color==null){s.color=colors[colori].toString();++colori}else if(typeof s.color=="number")s.color=colors[s.color].toString();if(s.lines.show==null){var v,show=true;for(v in s)if(s[v]&&s[v].show){show=false;break}if(show)s.lines.show=true}if(s.lines.zero==null){s.lines.zero=!!s.lines.fill}s.xaxis=getOrCreateAxis(xaxes,axisNumber(s,"x"));s.yaxis=getOrCreateAxis(yaxes,axisNumber(s,"y"))}}function processData(){var topSentry=Number.POSITIVE_INFINITY,bottomSentry=Number.NEGATIVE_INFINITY,fakeInfinity=Number.MAX_VALUE,i,j,k,m,length,s,points,ps,x,y,axis,val,f,p,data,format;function updateAxis(axis,min,max){if(min<axis.datamin&&min!=-fakeInfinity)axis.datamin=min;if(max>axis.datamax&&max!=fakeInfinity)axis.datamax=max}$.each(allAxes(),function(_,axis){axis.datamin=topSentry;axis.datamax=bottomSentry;axis.used=false});for(i=0;i<series.length;++i){s=series[i];s.datapoints={points:[]};executeHooks(hooks.processRawData,[s,s.data,s.datapoints])}for(i=0;i<series.length;++i){s=series[i];data=s.data;format=s.datapoints.format;if(!format){format=[];format.push({x:true,number:true,required:true});format.push({y:true,number:true,required:true});if(s.bars.show||s.lines.show&&s.lines.fill){var autoscale=!!(s.bars.show&&s.bars.zero||s.lines.show&&s.lines.zero);format.push({y:true,number:true,required:false,defaultValue:0,autoscale:autoscale});if(s.bars.horizontal){delete format[format.length-1].y;format[format.length-1].x=true}}s.datapoints.format=format}if(s.datapoints.pointsize!=null)continue;s.datapoints.pointsize=format.length;ps=s.datapoints.pointsize;points=s.datapoints.points;var insertSteps=s.lines.show&&s.lines.steps;s.xaxis.used=s.yaxis.used=true;for(j=k=0;j<data.length;++j,k+=ps){p=data[j];var nullify=p==null;if(!nullify){for(m=0;m<ps;++m){val=p[m];f=format[m];if(f){if(f.number&&val!=null){val=+val;if(isNaN(val))val=null;else if(val==Infinity)val=fakeInfinity;else if(val==-Infinity)val=-fakeInfinity}if(val==null){if(f.required)nullify=true;if(f.defaultValue!=null)val=f.defaultValue}}points[k+m]=val}}if(nullify){for(m=0;m<ps;++m){val=points[k+m];if(val!=null){f=format[m];if(f.autoscale!==false){if(f.x){updateAxis(s.xaxis,val,val)}if(f.y){updateAxis(s.yaxis,val,val)}}}points[k+m]=null}}else{if(insertSteps&&k>0&&points[k-ps]!=null&&points[k-ps]!=points[k]&&points[k-ps+1]!=points[k+1]){for(m=0;m<ps;++m)points[k+ps+m]=points[k+m];points[k+1]=points[k-ps+1];k+=ps}}}}for(i=0;i<series.length;++i){s=series[i];executeHooks(hooks.processDatapoints,[s,s.datapoints])}for(i=0;i<series.length;++i){s=series[i];points=s.datapoints.points;ps=s.datapoints.pointsize;format=s.datapoints.format;var xmin=topSentry,ymin=topSentry,xmax=bottomSentry,ymax=bottomSentry;for(j=0;j<points.length;j+=ps){if(points[j]==null)continue;for(m=0;m<ps;++m){val=points[j+m];f=format[m];if(!f||f.autoscale===false||val==fakeInfinity||val==-fakeInfinity)continue;if(f.x){if(val<xmin)xmin=val;if(val>xmax)xmax=val}if(f.y){if(val<ymin)ymin=val;if(val>ymax)ymax=val}}}if(s.bars.show){var delta;switch(s.bars.align){case"left":delta=0;break;case"right":delta=-s.bars.barWidth;break;default:delta=-s.bars.barWidth/2}if(s.bars.horizontal){ymin+=delta;ymax+=delta+s.bars.barWidth}else{xmin+=delta;xmax+=delta+s.bars.barWidth}}updateAxis(s.xaxis,xmin,xmax);updateAxis(s.yaxis,ymin,ymax)}$.each(allAxes(),function(_,axis){if(axis.datamin==topSentry)axis.datamin=null;if(axis.datamax==bottomSentry)axis.datamax=null})}function setupCanvases(){placeholder.css("padding",0).children().filter(function(){return!$(this).hasClass("flot-overlay")&&!$(this).hasClass("flot-base")}).remove();if(placeholder.css("position")=="static")placeholder.css("position","relative");surface=new Canvas("flot-base",placeholder);overlay=new Canvas("flot-overlay",placeholder);ctx=surface.context;octx=overlay.context;eventHolder=$(overlay.element).unbind();var existing=placeholder.data("plot");if(existing){existing.shutdown();overlay.clear()}placeholder.data("plot",plot)}function bindEvents(){if(options.grid.hoverable){eventHolder.mousemove(onMouseMove);eventHolder.bind("mouseleave",onMouseLeave)}if(options.grid.clickable)eventHolder.click(onClick);executeHooks(hooks.bindEvents,[eventHolder])}function shutdown(){if(redrawTimeout)clearTimeout(redrawTimeout);eventHolder.unbind("mousemove",onMouseMove);eventHolder.unbind("mouseleave",onMouseLeave);eventHolder.unbind("click",onClick);executeHooks(hooks.shutdown,[eventHolder])}function setTransformationHelpers(axis){function identity(x){return x}var s,m,t=axis.options.transform||identity,it=axis.options.inverseTransform;if(axis.direction=="x"){s=axis.scale=plotWidth/Math.abs(t(axis.max)-t(axis.min));m=Math.min(t(axis.max),t(axis.min))}else{s=axis.scale=plotHeight/Math.abs(t(axis.max)-t(axis.min));s=-s;m=Math.max(t(axis.max),t(axis.min))}if(t==identity)axis.p2c=function(p){return(p-m)*s};else axis.p2c=function(p){return(t(p)-m)*s};if(!it)axis.c2p=function(c){return m+c/s};else axis.c2p=function(c){return it(m+c/s)}}function measureTickLabels(axis){var opts=axis.options,ticks=axis.ticks||[],labelWidth=opts.labelWidth||0,labelHeight=opts.labelHeight||0,maxWidth=labelWidth||(axis.direction=="x"?Math.floor(surface.width/(ticks.length||1)):null),legacyStyles=axis.direction+"Axis "+axis.direction+axis.n+"Axis",layer="flot-"+axis.direction+"-axis flot-"+axis.direction+axis.n+"-axis "+legacyStyles,font=opts.font||"flot-tick-label tickLabel";for(var i=0;i<ticks.length;++i){var t=ticks[i];if(!t.label)continue;var info=surface.getTextInfo(layer,t.label,font,null,maxWidth);labelWidth=Math.max(labelWidth,info.width);labelHeight=Math.max(labelHeight,info.height)}axis.labelWidth=opts.labelWidth||labelWidth;axis.labelHeight=opts.labelHeight||labelHeight}function allocateAxisBoxFirstPhase(axis){var lw=axis.labelWidth,lh=axis.labelHeight,pos=axis.options.position,isXAxis=axis.direction==="x",tickLength=axis.options.tickLength,axisMargin=options.grid.axisMargin,padding=options.grid.labelMargin,innermost=true,outermost=true,first=true,found=false;$.each(isXAxis?xaxes:yaxes,function(i,a){if(a&&(a.show||a.reserveSpace)){if(a===axis){found=true}else if(a.options.position===pos){if(found){outermost=false}else{innermost=false}}if(!found){first=false}}});if(outermost){axisMargin=0}if(tickLength==null){tickLength=first?"full":5}if(!isNaN(+tickLength))padding+=+tickLength;if(isXAxis){lh+=padding;if(pos=="bottom"){plotOffset.bottom+=lh+axisMargin;axis.box={top:surface.height-plotOffset.bottom,height:lh}}else{axis.box={top:plotOffset.top+axisMargin,height:lh};plotOffset.top+=lh+axisMargin}}else{lw+=padding;if(pos=="left"){axis.box={left:plotOffset.left+axisMargin,width:lw};plotOffset.left+=lw+axisMargin}else{plotOffset.right+=lw+axisMargin;axis.box={left:surface.width-plotOffset.right,width:lw}}}axis.position=pos;axis.tickLength=tickLength;axis.box.padding=padding;axis.innermost=innermost}function allocateAxisBoxSecondPhase(axis){if(axis.direction=="x"){axis.box.left=plotOffset.left-axis.labelWidth/2;axis.box.width=surface.width-plotOffset.left-plotOffset.right+axis.labelWidth}else{axis.box.top=plotOffset.top-axis.labelHeight/2;axis.box.height=surface.height-plotOffset.bottom-plotOffset.top+axis.labelHeight}}function adjustLayoutForThingsStickingOut(){var minMargin=options.grid.minBorderMargin,axis,i;if(minMargin==null){minMargin=0;for(i=0;i<series.length;++i)minMargin=Math.max(minMargin,2*(series[i].points.radius+series[i].points.lineWidth/2))}var margins={left:minMargin,right:minMargin,top:minMargin,bottom:minMargin};$.each(allAxes(),function(_,axis){if(axis.reserveSpace&&axis.ticks&&axis.ticks.length){if(axis.direction==="x"){margins.left=Math.max(margins.left,axis.labelWidth/2);margins.right=Math.max(margins.right,axis.labelWidth/2)}else{margins.bottom=Math.max(margins.bottom,axis.labelHeight/2);margins.top=Math.max(margins.top,axis.labelHeight/2)}}});plotOffset.left=Math.ceil(Math.max(margins.left,plotOffset.left));plotOffset.right=Math.ceil(Math.max(margins.right,plotOffset.right));plotOffset.top=Math.ceil(Math.max(margins.top,plotOffset.top));plotOffset.bottom=Math.ceil(Math.max(margins.bottom,plotOffset.bottom))}function setupGrid(){var i,axes=allAxes(),showGrid=options.grid.show;for(var a in plotOffset){var margin=options.grid.margin||0;plotOffset[a]=typeof margin=="number"?margin:margin[a]||0}executeHooks(hooks.processOffset,[plotOffset]);for(var a in plotOffset){if(typeof options.grid.borderWidth=="object"){plotOffset[a]+=showGrid?options.grid.borderWidth[a]:0}else{plotOffset[a]+=showGrid?options.grid.borderWidth:0}}$.each(axes,function(_,axis){var axisOpts=axis.options;axis.show=axisOpts.show==null?axis.used:axisOpts.show;axis.reserveSpace=axisOpts.reserveSpace==null?axis.show:axisOpts.reserveSpace;setRange(axis)});if(showGrid){var allocatedAxes=$.grep(axes,function(axis){return axis.show||axis.reserveSpace});$.each(allocatedAxes,function(_,axis){setupTickGeneration(axis);setTicks(axis);snapRangeToTicks(axis,axis.ticks);measureTickLabels(axis)});for(i=allocatedAxes.length-1;i>=0;--i)allocateAxisBoxFirstPhase(allocatedAxes[i]);adjustLayoutForThingsStickingOut();$.each(allocatedAxes,function(_,axis){allocateAxisBoxSecondPhase(axis)})}plotWidth=surface.width-plotOffset.left-plotOffset.right;plotHeight=surface.height-plotOffset.bottom-plotOffset.top;$.each(axes,function(_,axis){setTransformationHelpers(axis)});if(showGrid){drawAxisLabels()}insertLegend()}function setRange(axis){var opts=axis.options,min=+(opts.min!=null?opts.min:axis.datamin),max=+(opts.max!=null?opts.max:axis.datamax),delta=max-min;if(delta==0){var widen=max==0?1:.01;if(opts.min==null)min-=widen;if(opts.max==null||opts.min!=null)max+=widen}else{var margin=opts.autoscaleMargin;if(margin!=null){if(opts.min==null){min-=delta*margin;if(min<0&&axis.datamin!=null&&axis.datamin>=0)min=0}if(opts.max==null){max+=delta*margin;if(max>0&&axis.datamax!=null&&axis.datamax<=0)max=0}}}axis.min=min;axis.max=max}function setupTickGeneration(axis){var opts=axis.options;var noTicks;if(typeof opts.ticks=="number"&&opts.ticks>0)noTicks=opts.ticks;else noTicks=.3*Math.sqrt(axis.direction=="x"?surface.width:surface.height);var delta=(axis.max-axis.min)/noTicks,dec=-Math.floor(Math.log(delta)/Math.LN10),maxDec=opts.tickDecimals;if(maxDec!=null&&dec>maxDec){dec=maxDec}var magn=Math.pow(10,-dec),norm=delta/magn,size;if(norm<1.5){size=1}else if(norm<3){size=2;if(norm>2.25&&(maxDec==null||dec+1<=maxDec)){size=2.5;++dec}}else if(norm<7.5){size=5}else{size=10}size*=magn;if(opts.minTickSize!=null&&size<opts.minTickSize){size=opts.minTickSize}axis.delta=delta;axis.tickDecimals=Math.max(0,maxDec!=null?maxDec:dec);axis.tickSize=opts.tickSize||size;if(opts.mode=="time"&&!axis.tickGenerator){throw new Error("Time mode requires the flot.time plugin.")}if(!axis.tickGenerator){axis.tickGenerator=function(axis){var ticks=[],start=floorInBase(axis.min,axis.tickSize),i=0,v=Number.NaN,prev;do{prev=v;v=start+i*axis.tickSize;ticks.push(v);++i}while(v<axis.max&&v!=prev);return ticks};axis.tickFormatter=function(value,axis){var factor=axis.tickDecimals?Math.pow(10,axis.tickDecimals):1;var formatted=""+Math.round(value*factor)/factor;if(axis.tickDecimals!=null){var decimal=formatted.indexOf(".");var precision=decimal==-1?0:formatted.length-decimal-1;if(precision<axis.tickDecimals){return(precision?formatted:formatted+".")+(""+factor).substr(1,axis.tickDecimals-precision)}}return formatted}}if($.isFunction(opts.tickFormatter))axis.tickFormatter=function(v,axis){return""+opts.tickFormatter(v,axis)};if(opts.alignTicksWithAxis!=null){var otherAxis=(axis.direction=="x"?xaxes:yaxes)[opts.alignTicksWithAxis-1];if(otherAxis&&otherAxis.used&&otherAxis!=axis){var niceTicks=axis.tickGenerator(axis);if(niceTicks.length>0){if(opts.min==null)axis.min=Math.min(axis.min,niceTicks[0]);if(opts.max==null&&niceTicks.length>1)axis.max=Math.max(axis.max,niceTicks[niceTicks.length-1])}axis.tickGenerator=function(axis){var ticks=[],v,i;for(i=0;i<otherAxis.ticks.length;++i){v=(otherAxis.ticks[i].v-otherAxis.min)/(otherAxis.max-otherAxis.min);v=axis.min+v*(axis.max-axis.min);ticks.push(v)}return ticks};if(!axis.mode&&opts.tickDecimals==null){var extraDec=Math.max(0,-Math.floor(Math.log(axis.delta)/Math.LN10)+1),ts=axis.tickGenerator(axis);if(!(ts.length>1&&/\..*0$/.test((ts[1]-ts[0]).toFixed(extraDec))))axis.tickDecimals=extraDec}}}}function setTicks(axis){var oticks=axis.options.ticks,ticks=[];if(oticks==null||typeof oticks=="number"&&oticks>0)ticks=axis.tickGenerator(axis);else if(oticks){if($.isFunction(oticks))ticks=oticks(axis);else ticks=oticks}var i,v;axis.ticks=[];for(i=0;i<ticks.length;++i){var label=null;var t=ticks[i];if(typeof t=="object"){v=+t[0];if(t.length>1)label=t[1]}else v=+t;if(label==null)label=axis.tickFormatter(v,axis);if(!isNaN(v))axis.ticks.push({v:v,label:label})}}function snapRangeToTicks(axis,ticks){if(axis.options.autoscaleMargin&&ticks.length>0){if(axis.options.min==null)axis.min=Math.min(axis.min,ticks[0].v);if(axis.options.max==null&&ticks.length>1)axis.max=Math.max(axis.max,ticks[ticks.length-1].v)}}function draw(){surface.clear();executeHooks(hooks.drawBackground,[ctx]);var grid=options.grid;if(grid.show&&grid.backgroundColor)drawBackground();if(grid.show&&!grid.aboveData){drawGrid()}for(var i=0;i<series.length;++i){executeHooks(hooks.drawSeries,[ctx,series[i]]);drawSeries(series[i])}executeHooks(hooks.draw,[ctx]);if(grid.show&&grid.aboveData){drawGrid()}surface.render();triggerRedrawOverlay()}function extractRange(ranges,coord){var axis,from,to,key,axes=allAxes();for(var i=0;i<axes.length;++i){axis=axes[i];if(axis.direction==coord){key=coord+axis.n+"axis";if(!ranges[key]&&axis.n==1)key=coord+"axis";if(ranges[key]){from=ranges[key].from;to=ranges[key].to;break}}}if(!ranges[key]){axis=coord=="x"?xaxes[0]:yaxes[0];from=ranges[coord+"1"];to=ranges[coord+"2"]}if(from!=null&&to!=null&&from>to){var tmp=from;from=to;to=tmp}return{from:from,to:to,axis:axis}}function drawBackground(){ctx.save();ctx.translate(plotOffset.left,plotOffset.top);ctx.fillStyle=getColorOrGradient(options.grid.backgroundColor,plotHeight,0,"rgba(255, 255, 255, 0)");ctx.fillRect(0,0,plotWidth,plotHeight);ctx.restore()}function drawGrid(){var i,axes,bw,bc;ctx.save();ctx.translate(plotOffset.left,plotOffset.top);var markings=options.grid.markings;if(markings){if($.isFunction(markings)){axes=plot.getAxes();axes.xmin=axes.xaxis.min;axes.xmax=axes.xaxis.max;axes.ymin=axes.yaxis.min;axes.ymax=axes.yaxis.max;markings=markings(axes)}for(i=0;i<markings.length;++i){var m=markings[i],xrange=extractRange(m,"x"),yrange=extractRange(m,"y");if(xrange.from==null)xrange.from=xrange.axis.min;if(xrange.to==null)xrange.to=xrange.axis.max;
if(yrange.from==null)yrange.from=yrange.axis.min;if(yrange.to==null)yrange.to=yrange.axis.max;if(xrange.to<xrange.axis.min||xrange.from>xrange.axis.max||yrange.to<yrange.axis.min||yrange.from>yrange.axis.max)continue;xrange.from=Math.max(xrange.from,xrange.axis.min);xrange.to=Math.min(xrange.to,xrange.axis.max);yrange.from=Math.max(yrange.from,yrange.axis.min);yrange.to=Math.min(yrange.to,yrange.axis.max);var xequal=xrange.from===xrange.to,yequal=yrange.from===yrange.to;if(xequal&&yequal){continue}xrange.from=Math.floor(xrange.axis.p2c(xrange.from));xrange.to=Math.floor(xrange.axis.p2c(xrange.to));yrange.from=Math.floor(yrange.axis.p2c(yrange.from));yrange.to=Math.floor(yrange.axis.p2c(yrange.to));if(xequal||yequal){var lineWidth=m.lineWidth||options.grid.markingsLineWidth,subPixel=lineWidth%2?.5:0;ctx.beginPath();ctx.strokeStyle=m.color||options.grid.markingsColor;ctx.lineWidth=lineWidth;if(xequal){ctx.moveTo(xrange.to+subPixel,yrange.from);ctx.lineTo(xrange.to+subPixel,yrange.to)}else{ctx.moveTo(xrange.from,yrange.to+subPixel);ctx.lineTo(xrange.to,yrange.to+subPixel)}ctx.stroke()}else{ctx.fillStyle=m.color||options.grid.markingsColor;ctx.fillRect(xrange.from,yrange.to,xrange.to-xrange.from,yrange.from-yrange.to)}}}axes=allAxes();bw=options.grid.borderWidth;for(var j=0;j<axes.length;++j){var axis=axes[j],box=axis.box,t=axis.tickLength,x,y,xoff,yoff;if(!axis.show||axis.ticks.length==0)continue;ctx.lineWidth=1;if(axis.direction=="x"){x=0;if(t=="full")y=axis.position=="top"?0:plotHeight;else y=box.top-plotOffset.top+(axis.position=="top"?box.height:0)}else{y=0;if(t=="full")x=axis.position=="left"?0:plotWidth;else x=box.left-plotOffset.left+(axis.position=="left"?box.width:0)}if(!axis.innermost){ctx.strokeStyle=axis.options.color;ctx.beginPath();xoff=yoff=0;if(axis.direction=="x")xoff=plotWidth+1;else yoff=plotHeight+1;if(ctx.lineWidth==1){if(axis.direction=="x"){y=Math.floor(y)+.5}else{x=Math.floor(x)+.5}}ctx.moveTo(x,y);ctx.lineTo(x+xoff,y+yoff);ctx.stroke()}ctx.strokeStyle=axis.options.tickColor;ctx.beginPath();for(i=0;i<axis.ticks.length;++i){var v=axis.ticks[i].v;xoff=yoff=0;if(isNaN(v)||v<axis.min||v>axis.max||t=="full"&&(typeof bw=="object"&&bw[axis.position]>0||bw>0)&&(v==axis.min||v==axis.max))continue;if(axis.direction=="x"){x=axis.p2c(v);yoff=t=="full"?-plotHeight:t;if(axis.position=="top")yoff=-yoff}else{y=axis.p2c(v);xoff=t=="full"?-plotWidth:t;if(axis.position=="left")xoff=-xoff}if(ctx.lineWidth==1){if(axis.direction=="x")x=Math.floor(x)+.5;else y=Math.floor(y)+.5}ctx.moveTo(x,y);ctx.lineTo(x+xoff,y+yoff)}ctx.stroke()}if(bw){bc=options.grid.borderColor;if(typeof bw=="object"||typeof bc=="object"){if(typeof bw!=="object"){bw={top:bw,right:bw,bottom:bw,left:bw}}if(typeof bc!=="object"){bc={top:bc,right:bc,bottom:bc,left:bc}}if(bw.top>0){ctx.strokeStyle=bc.top;ctx.lineWidth=bw.top;ctx.beginPath();ctx.moveTo(0-bw.left,0-bw.top/2);ctx.lineTo(plotWidth,0-bw.top/2);ctx.stroke()}if(bw.right>0){ctx.strokeStyle=bc.right;ctx.lineWidth=bw.right;ctx.beginPath();ctx.moveTo(plotWidth+bw.right/2,0-bw.top);ctx.lineTo(plotWidth+bw.right/2,plotHeight);ctx.stroke()}if(bw.bottom>0){ctx.strokeStyle=bc.bottom;ctx.lineWidth=bw.bottom;ctx.beginPath();ctx.moveTo(plotWidth+bw.right,plotHeight+bw.bottom/2);ctx.lineTo(0,plotHeight+bw.bottom/2);ctx.stroke()}if(bw.left>0){ctx.strokeStyle=bc.left;ctx.lineWidth=bw.left;ctx.beginPath();ctx.moveTo(0-bw.left/2,plotHeight+bw.bottom);ctx.lineTo(0-bw.left/2,0);ctx.stroke()}}else{ctx.lineWidth=bw;ctx.strokeStyle=options.grid.borderColor;ctx.strokeRect(-bw/2,-bw/2,plotWidth+bw,plotHeight+bw)}}ctx.restore()}function drawAxisLabels(){$.each(allAxes(),function(_,axis){var box=axis.box,legacyStyles=axis.direction+"Axis "+axis.direction+axis.n+"Axis",layer="flot-"+axis.direction+"-axis flot-"+axis.direction+axis.n+"-axis "+legacyStyles,font=axis.options.font||"flot-tick-label tickLabel",tick,x,y,halign,valign;surface.removeText(layer);if(!axis.show||axis.ticks.length==0)return;for(var i=0;i<axis.ticks.length;++i){tick=axis.ticks[i];if(!tick.label||tick.v<axis.min||tick.v>axis.max)continue;if(axis.direction=="x"){halign="center";x=plotOffset.left+axis.p2c(tick.v);if(axis.position=="bottom"){y=box.top+box.padding}else{y=box.top+box.height-box.padding;valign="bottom"}}else{valign="middle";y=plotOffset.top+axis.p2c(tick.v);if(axis.position=="left"){x=box.left+box.width-box.padding;halign="right"}else{x=box.left+box.padding}}surface.addText(layer,x,y,tick.label,font,null,null,halign,valign)}})}function drawSeries(series){if(series.lines.show)drawSeriesLines(series);if(series.bars.show)drawSeriesBars(series);if(series.points.show)drawSeriesPoints(series)}function drawSeriesLines(series){function plotLine(datapoints,xoffset,yoffset,axisx,axisy){var points=datapoints.points,ps=datapoints.pointsize,prevx=null,prevy=null;ctx.beginPath();for(var i=ps;i<points.length;i+=ps){var x1=points[i-ps],y1=points[i-ps+1],x2=points[i],y2=points[i+1];if(x1==null||x2==null)continue;if(y1<=y2&&y1<axisy.min){if(y2<axisy.min)continue;x1=(axisy.min-y1)/(y2-y1)*(x2-x1)+x1;y1=axisy.min}else if(y2<=y1&&y2<axisy.min){if(y1<axisy.min)continue;x2=(axisy.min-y1)/(y2-y1)*(x2-x1)+x1;y2=axisy.min}if(y1>=y2&&y1>axisy.max){if(y2>axisy.max)continue;x1=(axisy.max-y1)/(y2-y1)*(x2-x1)+x1;y1=axisy.max}else if(y2>=y1&&y2>axisy.max){if(y1>axisy.max)continue;x2=(axisy.max-y1)/(y2-y1)*(x2-x1)+x1;y2=axisy.max}if(x1<=x2&&x1<axisx.min){if(x2<axisx.min)continue;y1=(axisx.min-x1)/(x2-x1)*(y2-y1)+y1;x1=axisx.min}else if(x2<=x1&&x2<axisx.min){if(x1<axisx.min)continue;y2=(axisx.min-x1)/(x2-x1)*(y2-y1)+y1;x2=axisx.min}if(x1>=x2&&x1>axisx.max){if(x2>axisx.max)continue;y1=(axisx.max-x1)/(x2-x1)*(y2-y1)+y1;x1=axisx.max}else if(x2>=x1&&x2>axisx.max){if(x1>axisx.max)continue;y2=(axisx.max-x1)/(x2-x1)*(y2-y1)+y1;x2=axisx.max}if(x1!=prevx||y1!=prevy)ctx.moveTo(axisx.p2c(x1)+xoffset,axisy.p2c(y1)+yoffset);prevx=x2;prevy=y2;ctx.lineTo(axisx.p2c(x2)+xoffset,axisy.p2c(y2)+yoffset)}ctx.stroke()}function plotLineArea(datapoints,axisx,axisy){var points=datapoints.points,ps=datapoints.pointsize,bottom=Math.min(Math.max(0,axisy.min),axisy.max),i=0,top,areaOpen=false,ypos=1,segmentStart=0,segmentEnd=0;while(true){if(ps>0&&i>points.length+ps)break;i+=ps;var x1=points[i-ps],y1=points[i-ps+ypos],x2=points[i],y2=points[i+ypos];if(areaOpen){if(ps>0&&x1!=null&&x2==null){segmentEnd=i;ps=-ps;ypos=2;continue}if(ps<0&&i==segmentStart+ps){ctx.fill();areaOpen=false;ps=-ps;ypos=1;i=segmentStart=segmentEnd+ps;continue}}if(x1==null||x2==null)continue;if(x1<=x2&&x1<axisx.min){if(x2<axisx.min)continue;y1=(axisx.min-x1)/(x2-x1)*(y2-y1)+y1;x1=axisx.min}else if(x2<=x1&&x2<axisx.min){if(x1<axisx.min)continue;y2=(axisx.min-x1)/(x2-x1)*(y2-y1)+y1;x2=axisx.min}if(x1>=x2&&x1>axisx.max){if(x2>axisx.max)continue;y1=(axisx.max-x1)/(x2-x1)*(y2-y1)+y1;x1=axisx.max}else if(x2>=x1&&x2>axisx.max){if(x1>axisx.max)continue;y2=(axisx.max-x1)/(x2-x1)*(y2-y1)+y1;x2=axisx.max}if(!areaOpen){ctx.beginPath();ctx.moveTo(axisx.p2c(x1),axisy.p2c(bottom));areaOpen=true}if(y1>=axisy.max&&y2>=axisy.max){ctx.lineTo(axisx.p2c(x1),axisy.p2c(axisy.max));ctx.lineTo(axisx.p2c(x2),axisy.p2c(axisy.max));continue}else if(y1<=axisy.min&&y2<=axisy.min){ctx.lineTo(axisx.p2c(x1),axisy.p2c(axisy.min));ctx.lineTo(axisx.p2c(x2),axisy.p2c(axisy.min));continue}var x1old=x1,x2old=x2;if(y1<=y2&&y1<axisy.min&&y2>=axisy.min){x1=(axisy.min-y1)/(y2-y1)*(x2-x1)+x1;y1=axisy.min}else if(y2<=y1&&y2<axisy.min&&y1>=axisy.min){x2=(axisy.min-y1)/(y2-y1)*(x2-x1)+x1;y2=axisy.min}if(y1>=y2&&y1>axisy.max&&y2<=axisy.max){x1=(axisy.max-y1)/(y2-y1)*(x2-x1)+x1;y1=axisy.max}else if(y2>=y1&&y2>axisy.max&&y1<=axisy.max){x2=(axisy.max-y1)/(y2-y1)*(x2-x1)+x1;y2=axisy.max}if(x1!=x1old){ctx.lineTo(axisx.p2c(x1old),axisy.p2c(y1))}ctx.lineTo(axisx.p2c(x1),axisy.p2c(y1));ctx.lineTo(axisx.p2c(x2),axisy.p2c(y2));if(x2!=x2old){ctx.lineTo(axisx.p2c(x2),axisy.p2c(y2));ctx.lineTo(axisx.p2c(x2old),axisy.p2c(y2))}}}ctx.save();ctx.translate(plotOffset.left,plotOffset.top);ctx.lineJoin="round";var lw=series.lines.lineWidth,sw=series.shadowSize;if(lw>0&&sw>0){ctx.lineWidth=sw;ctx.strokeStyle="rgba(0,0,0,0.1)";var angle=Math.PI/18;plotLine(series.datapoints,Math.sin(angle)*(lw/2+sw/2),Math.cos(angle)*(lw/2+sw/2),series.xaxis,series.yaxis);ctx.lineWidth=sw/2;plotLine(series.datapoints,Math.sin(angle)*(lw/2+sw/4),Math.cos(angle)*(lw/2+sw/4),series.xaxis,series.yaxis)}ctx.lineWidth=lw;ctx.strokeStyle=series.color;var fillStyle=getFillStyle(series.lines,series.color,0,plotHeight);if(fillStyle){ctx.fillStyle=fillStyle;plotLineArea(series.datapoints,series.xaxis,series.yaxis)}if(lw>0)plotLine(series.datapoints,0,0,series.xaxis,series.yaxis);ctx.restore()}function drawSeriesPoints(series){function plotPoints(datapoints,radius,fillStyle,offset,shadow,axisx,axisy,symbol){var points=datapoints.points,ps=datapoints.pointsize;for(var i=0;i<points.length;i+=ps){var x=points[i],y=points[i+1];if(x==null||x<axisx.min||x>axisx.max||y<axisy.min||y>axisy.max)continue;ctx.beginPath();x=axisx.p2c(x);y=axisy.p2c(y)+offset;if(symbol=="circle")ctx.arc(x,y,radius,0,shadow?Math.PI:Math.PI*2,false);else symbol(ctx,x,y,radius,shadow);ctx.closePath();if(fillStyle){ctx.fillStyle=fillStyle;ctx.fill()}ctx.stroke()}}ctx.save();ctx.translate(plotOffset.left,plotOffset.top);var lw=series.points.lineWidth,sw=series.shadowSize,radius=series.points.radius,symbol=series.points.symbol;if(lw==0)lw=1e-4;if(lw>0&&sw>0){var w=sw/2;ctx.lineWidth=w;ctx.strokeStyle="rgba(0,0,0,0.1)";plotPoints(series.datapoints,radius,null,w+w/2,true,series.xaxis,series.yaxis,symbol);ctx.strokeStyle="rgba(0,0,0,0.2)";plotPoints(series.datapoints,radius,null,w/2,true,series.xaxis,series.yaxis,symbol)}ctx.lineWidth=lw;ctx.strokeStyle=series.color;plotPoints(series.datapoints,radius,getFillStyle(series.points,series.color),0,false,series.xaxis,series.yaxis,symbol);ctx.restore()}function drawBar(x,y,b,barLeft,barRight,fillStyleCallback,axisx,axisy,c,horizontal,lineWidth){var left,right,bottom,top,drawLeft,drawRight,drawTop,drawBottom,tmp;if(horizontal){drawBottom=drawRight=drawTop=true;drawLeft=false;left=b;right=x;top=y+barLeft;bottom=y+barRight;if(right<left){tmp=right;right=left;left=tmp;drawLeft=true;drawRight=false}}else{drawLeft=drawRight=drawTop=true;drawBottom=false;left=x+barLeft;right=x+barRight;bottom=b;top=y;if(top<bottom){tmp=top;top=bottom;bottom=tmp;drawBottom=true;drawTop=false}}if(right<axisx.min||left>axisx.max||top<axisy.min||bottom>axisy.max)return;if(left<axisx.min){left=axisx.min;drawLeft=false}if(right>axisx.max){right=axisx.max;drawRight=false}if(bottom<axisy.min){bottom=axisy.min;drawBottom=false}if(top>axisy.max){top=axisy.max;drawTop=false}left=axisx.p2c(left);bottom=axisy.p2c(bottom);right=axisx.p2c(right);top=axisy.p2c(top);if(fillStyleCallback){c.fillStyle=fillStyleCallback(bottom,top);c.fillRect(left,top,right-left,bottom-top)}if(lineWidth>0&&(drawLeft||drawRight||drawTop||drawBottom)){c.beginPath();c.moveTo(left,bottom);if(drawLeft)c.lineTo(left,top);else c.moveTo(left,top);if(drawTop)c.lineTo(right,top);else c.moveTo(right,top);if(drawRight)c.lineTo(right,bottom);else c.moveTo(right,bottom);if(drawBottom)c.lineTo(left,bottom);else c.moveTo(left,bottom);c.stroke()}}function drawSeriesBars(series){function plotBars(datapoints,barLeft,barRight,fillStyleCallback,axisx,axisy){var points=datapoints.points,ps=datapoints.pointsize;for(var i=0;i<points.length;i+=ps){if(points[i]==null)continue;drawBar(points[i],points[i+1],points[i+2],barLeft,barRight,fillStyleCallback,axisx,axisy,ctx,series.bars.horizontal,series.bars.lineWidth)}}ctx.save();ctx.translate(plotOffset.left,plotOffset.top);ctx.lineWidth=series.bars.lineWidth;ctx.strokeStyle=series.color;var barLeft;switch(series.bars.align){case"left":barLeft=0;break;case"right":barLeft=-series.bars.barWidth;break;default:barLeft=-series.bars.barWidth/2}var fillStyleCallback=series.bars.fill?function(bottom,top){return getFillStyle(series.bars,series.color,bottom,top)}:null;plotBars(series.datapoints,barLeft,barLeft+series.bars.barWidth,fillStyleCallback,series.xaxis,series.yaxis);ctx.restore()}function getFillStyle(filloptions,seriesColor,bottom,top){var fill=filloptions.fill;if(!fill)return null;if(filloptions.fillColor)return getColorOrGradient(filloptions.fillColor,bottom,top,seriesColor);var c=$.color.parse(seriesColor);c.a=typeof fill=="number"?fill:.4;c.normalize();return c.toString()}function insertLegend(){if(options.legend.container!=null){$(options.legend.container).html("")}else{placeholder.find(".legend").remove()}if(!options.legend.show){return}var fragments=[],entries=[],rowStarted=false,lf=options.legend.labelFormatter,s,label;for(var i=0;i<series.length;++i){s=series[i];if(s.label){label=lf?lf(s.label,s):s.label;if(label){entries.push({label:label,color:s.color})}}}if(options.legend.sorted){if($.isFunction(options.legend.sorted)){entries.sort(options.legend.sorted)}else if(options.legend.sorted=="reverse"){entries.reverse()}else{var ascending=options.legend.sorted!="descending";entries.sort(function(a,b){return a.label==b.label?0:a.label<b.label!=ascending?1:-1})}}for(var i=0;i<entries.length;++i){var entry=entries[i];if(i%options.legend.noColumns==0){if(rowStarted)fragments.push("</tr>");fragments.push("<tr>");rowStarted=true}fragments.push('<td class="legendColorBox"><div style="border:1px solid '+options.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+entry.color+';overflow:hidden"></div></div></td>'+'<td class="legendLabel">'+entry.label+"</td>")}if(rowStarted)fragments.push("</tr>");if(fragments.length==0)return;var table='<table style="font-size:smaller;color:'+options.grid.color+'">'+fragments.join("")+"</table>";if(options.legend.container!=null)$(options.legend.container).html(table);else{var pos="",p=options.legend.position,m=options.legend.margin;if(m[0]==null)m=[m,m];if(p.charAt(0)=="n")pos+="top:"+(m[1]+plotOffset.top)+"px;";else if(p.charAt(0)=="s")pos+="bottom:"+(m[1]+plotOffset.bottom)+"px;";if(p.charAt(1)=="e")pos+="right:"+(m[0]+plotOffset.right)+"px;";else if(p.charAt(1)=="w")pos+="left:"+(m[0]+plotOffset.left)+"px;";var legend=$('<div class="legend">'+table.replace('style="','style="position:absolute;'+pos+";")+"</div>").appendTo(placeholder);if(options.legend.backgroundOpacity!=0){var c=options.legend.backgroundColor;if(c==null){c=options.grid.backgroundColor;if(c&&typeof c=="string")c=$.color.parse(c);else c=$.color.extract(legend,"background-color");c.a=1;c=c.toString()}var div=legend.children();$('<div style="position:absolute;width:'+div.width()+"px;height:"+div.height()+"px;"+pos+"background-color:"+c+';"> </div>').prependTo(legend).css("opacity",options.legend.backgroundOpacity)}}}var highlights=[],redrawTimeout=null;function findNearbyItem(mouseX,mouseY,seriesFilter){var maxDistance=options.grid.mouseActiveRadius,smallestDistance=maxDistance*maxDistance+1,item=null,foundPoint=false,i,j,ps;for(i=series.length-1;i>=0;--i){if(!seriesFilter(series[i]))continue;var s=series[i],axisx=s.xaxis,axisy=s.yaxis,points=s.datapoints.points,mx=axisx.c2p(mouseX),my=axisy.c2p(mouseY),maxx=maxDistance/axisx.scale,maxy=maxDistance/axisy.scale;ps=s.datapoints.pointsize;if(axisx.options.inverseTransform)maxx=Number.MAX_VALUE;if(axisy.options.inverseTransform)maxy=Number.MAX_VALUE;if(s.lines.show||s.points.show){for(j=0;j<points.length;j+=ps){var x=points[j],y=points[j+1];if(x==null)continue;if(x-mx>maxx||x-mx<-maxx||y-my>maxy||y-my<-maxy)continue;var dx=Math.abs(axisx.p2c(x)-mouseX),dy=Math.abs(axisy.p2c(y)-mouseY),dist=dx*dx+dy*dy;if(dist<smallestDistance){smallestDistance=dist;item=[i,j/ps]}}}if(s.bars.show&&!item){var barLeft,barRight;switch(s.bars.align){case"left":barLeft=0;break;case"right":barLeft=-s.bars.barWidth;break;default:barLeft=-s.bars.barWidth/2}barRight=barLeft+s.bars.barWidth;for(j=0;j<points.length;j+=ps){var x=points[j],y=points[j+1],b=points[j+2];if(x==null)continue;if(series[i].bars.horizontal?mx<=Math.max(b,x)&&mx>=Math.min(b,x)&&my>=y+barLeft&&my<=y+barRight:mx>=x+barLeft&&mx<=x+barRight&&my>=Math.min(b,y)&&my<=Math.max(b,y))item=[i,j/ps]}}}if(item){i=item[0];j=item[1];ps=series[i].datapoints.pointsize;return{datapoint:series[i].datapoints.points.slice(j*ps,(j+1)*ps),dataIndex:j,series:series[i],seriesIndex:i}}return null}function onMouseMove(e){if(options.grid.hoverable)triggerClickHoverEvent("plothover",e,function(s){return s["hoverable"]!=false})}function onMouseLeave(e){if(options.grid.hoverable)triggerClickHoverEvent("plothover",e,function(s){return false})}function onClick(e){triggerClickHoverEvent("plotclick",e,function(s){return s["clickable"]!=false})}function triggerClickHoverEvent(eventname,event,seriesFilter){var offset=eventHolder.offset(),canvasX=event.pageX-offset.left-plotOffset.left,canvasY=event.pageY-offset.top-plotOffset.top,pos=canvasToAxisCoords({left:canvasX,top:canvasY});pos.pageX=event.pageX;pos.pageY=event.pageY;var item=findNearbyItem(canvasX,canvasY,seriesFilter);if(item){item.pageX=parseInt(item.series.xaxis.p2c(item.datapoint[0])+offset.left+plotOffset.left,10);item.pageY=parseInt(item.series.yaxis.p2c(item.datapoint[1])+offset.top+plotOffset.top,10)}if(options.grid.autoHighlight){for(var i=0;i<highlights.length;++i){var h=highlights[i];if(h.auto==eventname&&!(item&&h.series==item.series&&h.point[0]==item.datapoint[0]&&h.point[1]==item.datapoint[1]))unhighlight(h.series,h.point)}if(item)highlight(item.series,item.datapoint,eventname)}placeholder.trigger(eventname,[pos,item])}function triggerRedrawOverlay(){var t=options.interaction.redrawOverlayInterval;if(t==-1){drawOverlay();return}if(!redrawTimeout)redrawTimeout=setTimeout(drawOverlay,t)}function drawOverlay(){redrawTimeout=null;octx.save();overlay.clear();octx.translate(plotOffset.left,plotOffset.top);var i,hi;for(i=0;i<highlights.length;++i){hi=highlights[i];if(hi.series.bars.show)drawBarHighlight(hi.series,hi.point);else drawPointHighlight(hi.series,hi.point)}octx.restore();executeHooks(hooks.drawOverlay,[octx])}function highlight(s,point,auto){if(typeof s=="number")s=series[s];if(typeof point=="number"){var ps=s.datapoints.pointsize;point=s.datapoints.points.slice(ps*point,ps*(point+1))}var i=indexOfHighlight(s,point);if(i==-1){highlights.push({series:s,point:point,auto:auto});triggerRedrawOverlay()}else if(!auto)highlights[i].auto=false}function unhighlight(s,point){if(s==null&&point==null){highlights=[];triggerRedrawOverlay();return}if(typeof s=="number")s=series[s];if(typeof point=="number"){var ps=s.datapoints.pointsize;point=s.datapoints.points.slice(ps*point,ps*(point+1))}var i=indexOfHighlight(s,point);if(i!=-1){highlights.splice(i,1);triggerRedrawOverlay()}}function indexOfHighlight(s,p){for(var i=0;i<highlights.length;++i){var h=highlights[i];if(h.series==s&&h.point[0]==p[0]&&h.point[1]==p[1])return i}return-1}function drawPointHighlight(series,point){var x=point[0],y=point[1],axisx=series.xaxis,axisy=series.yaxis,highlightColor=typeof series.highlightColor==="string"?series.highlightColor:$.color.parse(series.color).scale("a",.5).toString();if(x<axisx.min||x>axisx.max||y<axisy.min||y>axisy.max)return;var pointRadius=series.points.radius+series.points.lineWidth/2;octx.lineWidth=pointRadius;octx.strokeStyle=highlightColor;var radius=1.5*pointRadius;x=axisx.p2c(x);y=axisy.p2c(y);octx.beginPath();if(series.points.symbol=="circle")octx.arc(x,y,radius,0,2*Math.PI,false);else series.points.symbol(octx,x,y,radius,false);octx.closePath();octx.stroke()}function drawBarHighlight(series,point){var highlightColor=typeof series.highlightColor==="string"?series.highlightColor:$.color.parse(series.color).scale("a",.5).toString(),fillStyle=highlightColor,barLeft;switch(series.bars.align){case"left":barLeft=0;break;case"right":barLeft=-series.bars.barWidth;break;default:barLeft=-series.bars.barWidth/2}octx.lineWidth=series.bars.lineWidth;octx.strokeStyle=highlightColor;drawBar(point[0],point[1],point[2]||0,barLeft,barLeft+series.bars.barWidth,function(){return fillStyle},series.xaxis,series.yaxis,octx,series.bars.horizontal,series.bars.lineWidth)}function getColorOrGradient(spec,bottom,top,defaultColor){if(typeof spec=="string")return spec;else{var gradient=ctx.createLinearGradient(0,top,0,bottom);for(var i=0,l=spec.colors.length;i<l;++i){var c=spec.colors[i];if(typeof c!="string"){var co=$.color.parse(defaultColor);if(c.brightness!=null)co=co.scale("rgb",c.brightness);if(c.opacity!=null)co.a*=c.opacity;c=co.toString()}gradient.addColorStop(i/(l-1),c)}return gradient}}}$.plot=function(placeholder,data,options){var plot=new Plot($(placeholder),data,options,$.plot.plugins);return plot};$.plot.version="0.8.3";$.plot.plugins=[];$.fn.plot=function(data,options){return this.each(function(){$.plot(this,data,options)})};function floorInBase(n,base){return base*Math.floor(n/base)}})(jQuery);
;(function($){var options={axisLabels:{show:true}};function canvasSupported(){return!!document.createElement('canvas').getContext;}
function canvasTextSupported(){if(!canvasSupported()){return false;}
var dummy_canvas=document.createElement('canvas');var context=dummy_canvas.getContext('2d');return typeof context.fillText=='function';}
function css3TransitionSupported(){var div=document.createElement('div');return typeof div.style.MozTransition!='undefined'||typeof div.style.OTransition!='undefined'||typeof div.style.webkitTransition!='undefined'||typeof div.style.transition!='undefined';}
function AxisLabel(axisName,position,padding,plot,opts){this.axisName=axisName;this.position=position;this.padding=padding;this.plot=plot;this.opts=opts;this.width=0;this.height=0;}
AxisLabel.prototype.cleanup=function(){};CanvasAxisLabel.prototype=new AxisLabel();CanvasAxisLabel.prototype.constructor=CanvasAxisLabel;function CanvasAxisLabel(axisName,position,padding,plot,opts){AxisLabel.prototype.constructor.call(this,axisName,position,padding,plot,opts);}
CanvasAxisLabel.prototype.calculateSize=function(){if(!this.opts.axisLabelFontSizePixels)
this.opts.axisLabelFontSizePixels=14;if(!this.opts.axisLabelFontFamily)
this.opts.axisLabelFontFamily='sans-serif';var textWidth=this.opts.axisLabelFontSizePixels+this.padding;var textHeight=this.opts.axisLabelFontSizePixels+this.padding;if(this.position=='left'||this.position=='right'){this.width=this.opts.axisLabelFontSizePixels+this.padding;this.height=0;}else{this.width=0;this.height=this.opts.axisLabelFontSizePixels+this.padding;}};CanvasAxisLabel.prototype.draw=function(box){if(!this.opts.axisLabelColour)
this.opts.axisLabelColour='black';var ctx=this.plot.getCanvas().getContext('2d');ctx.save();ctx.font=this.opts.axisLabelFontSizePixels+'px '+
this.opts.axisLabelFontFamily;ctx.fillStyle=this.opts.axisLabelColour;var width=ctx.measureText(this.opts.axisLabel).width;var height=this.opts.axisLabelFontSizePixels;var x,y,angle=0;if(this.position=='top'){x=box.left+box.width/2-width/2;y=box.top+height*0.72;}else if(this.position=='bottom'){x=box.left+box.width/2-width/2;y=box.top+box.height-height*0.72;}else if(this.position=='left'){x=box.left+height*0.72;y=box.height/2+box.top+width/2;angle=-Math.PI/2;}else if(this.position=='right'){x=box.left+box.width-height*0.72;y=box.height/2+box.top-width/2;angle=Math.PI/2;}
ctx.translate(x,y);ctx.rotate(angle);ctx.fillText(this.opts.axisLabel,0,0);ctx.restore();};HtmlAxisLabel.prototype=new AxisLabel();HtmlAxisLabel.prototype.constructor=HtmlAxisLabel;function HtmlAxisLabel(axisName,position,padding,plot,opts){AxisLabel.prototype.constructor.call(this,axisName,position,padding,plot,opts);this.elem=null;}
HtmlAxisLabel.prototype.calculateSize=function(){var elem=$('<div class="axisLabels" style="position:absolute;">'+
this.opts.axisLabel+'</div>');this.plot.getPlaceholder().append(elem);this.labelWidth=elem.outerWidth(true);this.labelHeight=elem.outerHeight(true);elem.remove();this.width=this.height=0;if(this.position=='left'||this.position=='right'){this.width=this.labelWidth+this.padding;}else{this.height=this.labelHeight+this.padding;}};HtmlAxisLabel.prototype.cleanup=function(){if(this.elem){this.elem.remove();}};HtmlAxisLabel.prototype.draw=function(box){this.plot.getPlaceholder().find('#'+this.axisName+'Label').remove();this.elem=$('<div id="'+this.axisName+'Label" " class="axisLabels" style="position:absolute;">'
+this.opts.axisLabel+'</div>');this.plot.getPlaceholder().append(this.elem);if(this.position=='top'){this.elem.css('left',box.left+box.width/2-this.labelWidth/2+'px');this.elem.css('top',box.top+'px');}else if(this.position=='bottom'){this.elem.css('left',box.left+box.width/2-this.labelWidth/2+'px');this.elem.css('top',box.top+box.height-this.labelHeight+'px');}else if(this.position=='left'){this.elem.css('top',box.top+box.height/2-this.labelHeight/2+'px');this.elem.css('left',box.left+'px');}else if(this.position=='right'){this.elem.css('top',box.top+box.height/2-this.labelHeight/2+'px');this.elem.css('left',box.left+box.width-this.labelWidth+'px');}};CssTransformAxisLabel.prototype=new HtmlAxisLabel();CssTransformAxisLabel.prototype.constructor=CssTransformAxisLabel;function CssTransformAxisLabel(axisName,position,padding,plot,opts){HtmlAxisLabel.prototype.constructor.call(this,axisName,position,padding,plot,opts);}
CssTransformAxisLabel.prototype.calculateSize=function(){HtmlAxisLabel.prototype.calculateSize.call(this);this.width=this.height=0;if(this.position=='left'||this.position=='right'){this.width=this.labelHeight+this.padding;}else{this.height=this.labelHeight+this.padding;}};CssTransformAxisLabel.prototype.transforms=function(degrees,x,y){var stransforms={'-moz-transform':'','-webkit-transform':'','-o-transform':'','-ms-transform':''};if(x!=0||y!=0){var stdTranslate=' translate('+x+'px, '+y+'px)';stransforms['-moz-transform']+=stdTranslate;stransforms['-webkit-transform']+=stdTranslate;stransforms['-o-transform']+=stdTranslate;stransforms['-ms-transform']+=stdTranslate;}
if(degrees!=0){var rotation=degrees/90;var stdRotate=' rotate('+degrees+'deg)';stransforms['-moz-transform']+=stdRotate;stransforms['-webkit-transform']+=stdRotate;stransforms['-o-transform']+=stdRotate;stransforms['-ms-transform']+=stdRotate;}
var s='top: 0; left: 0; ';for(var prop in stransforms){if(stransforms[prop]){s+=prop+':'+stransforms[prop]+';';}}
s+=';';return s;};CssTransformAxisLabel.prototype.calculateOffsets=function(box){var offsets={x:0,y:0,degrees:0};if(this.position=='bottom'){offsets.x=box.left+box.width/2-this.labelWidth/2;offsets.y=box.top+box.height-this.labelHeight;}else if(this.position=='top'){offsets.x=box.left+box.width/2-this.labelWidth/2;offsets.y=box.top;}else if(this.position=='left'){offsets.degrees=-90;offsets.x=box.left-this.labelWidth/2+this.labelHeight/2;offsets.y=box.height/2+box.top;}else if(this.position=='right'){offsets.degrees=90;offsets.x=box.left+box.width-this.labelWidth/2
-this.labelHeight/2;offsets.y=box.height/2+box.top;}
offsets.x=Math.round(offsets.x);offsets.y=Math.round(offsets.y);return offsets;};CssTransformAxisLabel.prototype.draw=function(box){this.plot.getPlaceholder().find("."+this.axisName+"Label").remove();var offsets=this.calculateOffsets(box);this.elem=$('<div class="axisLabels '+this.axisName+'Label" style="position:absolute; '+
this.transforms(offsets.degrees,offsets.x,offsets.y)+'">'+this.opts.axisLabel+'</div>');this.plot.getPlaceholder().append(this.elem);};IeTransformAxisLabel.prototype=new CssTransformAxisLabel();IeTransformAxisLabel.prototype.constructor=IeTransformAxisLabel;function IeTransformAxisLabel(axisName,position,padding,plot,opts){CssTransformAxisLabel.prototype.constructor.call(this,axisName,position,padding,plot,opts);this.requiresResize=false;}
IeTransformAxisLabel.prototype.transforms=function(degrees,x,y){var s='';if(degrees!=0){var rotation=degrees/90;while(rotation<0){rotation+=4;}
s+=' filter: progid:DXImageTransform.Microsoft.BasicImage(rotation='+rotation+'); ';this.requiresResize=(this.position=='right');}
if(x!=0){s+='left: '+x+'px; ';}
if(y!=0){s+='top: '+y+'px; ';}
return s;};IeTransformAxisLabel.prototype.calculateOffsets=function(box){var offsets=CssTransformAxisLabel.prototype.calculateOffsets.call(this,box);if(this.position=='top'){offsets.y=box.top+1;}else if(this.position=='left'){offsets.x=box.left;offsets.y=box.height/2+box.top-this.labelWidth/2;}else if(this.position=='right'){offsets.x=box.left+box.width-this.labelHeight;offsets.y=box.height/2+box.top-this.labelWidth/2;}
return offsets;};IeTransformAxisLabel.prototype.draw=function(box){CssTransformAxisLabel.prototype.draw.call(this,box);if(this.requiresResize){this.elem=this.plot.getPlaceholder().find("."+this.axisName+"Label");this.elem.css('width',this.labelWidth);this.elem.css('height',this.labelHeight);}};function init(plot){plot.hooks.processOptions.push(function(plot,options){if(!options.axisLabels.show)
return;var secondPass=false;var axisLabels={};var axisOffsetCounts={left:0,right:0,top:0,bottom:0};var defaultPadding=2;plot.hooks.draw.push(function(plot,ctx){var hasAxisLabels=false;if(!secondPass){$.each(plot.getAxes(),function(axisName,axis){var opts=axis.options||plot.getOptions()[axisName];if(axisName in axisLabels){axis.labelHeight=axis.labelHeight-
axisLabels[axisName].height;axis.labelWidth=axis.labelWidth-
axisLabels[axisName].width;opts.labelHeight=axis.labelHeight;opts.labelWidth=axis.labelWidth;axisLabels[axisName].cleanup();delete axisLabels[axisName];}
if(!opts||!opts.axisLabel||!axis.show)
return;hasAxisLabels=true;var renderer=null;if(!opts.axisLabelUseHtml&&navigator.appName=='Microsoft Internet Explorer'){var ua=navigator.userAgent;var re=new RegExp("MSIE ([0-9]{1,}[\.0-9]{0,})");if(re.exec(ua)!=null){rv=parseFloat(RegExp.$1);}
if(rv>=9&&!opts.axisLabelUseCanvas&&!opts.axisLabelUseHtml){renderer=CssTransformAxisLabel;}else if(!opts.axisLabelUseCanvas&&!opts.axisLabelUseHtml){renderer=IeTransformAxisLabel;}else if(opts.axisLabelUseCanvas){renderer=CanvasAxisLabel;}else{renderer=HtmlAxisLabel;}}else{if(opts.axisLabelUseHtml||(!css3TransitionSupported()&&!canvasTextSupported())&&!opts.axisLabelUseCanvas){renderer=HtmlAxisLabel;}else if(opts.axisLabelUseCanvas||!css3TransitionSupported()){renderer=CanvasAxisLabel;}else{renderer=CssTransformAxisLabel;}}
var padding=opts.axisLabelPadding===undefined?defaultPadding:opts.axisLabelPadding;axisLabels[axisName]=new renderer(axisName,axis.position,padding,plot,opts);axisLabels[axisName].calculateSize();opts.labelHeight=axis.labelHeight+
axisLabels[axisName].height;opts.labelWidth=axis.labelWidth+
axisLabels[axisName].width;});if(hasAxisLabels){secondPass=true;plot.setupGrid();plot.draw();}}else{secondPass=false;$.each(plot.getAxes(),function(axisName,axis){var opts=axis.options||plot.getOptions()[axisName];if(!opts||!opts.axisLabel||!axis.show)
return;axisLabels[axisName].draw(axis.box);});}});});}
$.plot.plugins.push({init:init,options:options,name:'axisLabels',version:'2.0'});})(jQuery);
;/* Javascript plotting library for jQuery, version 0.8.3.

Copyright (c) 2007-2014 IOLA and Ole Laursen.
Licensed under the MIT license.

*/
(function($){var options={xaxis:{timezone:null,timeformat:null,twelveHourClock:false,monthNames:null}};function floorInBase(n,base){return base*Math.floor(n/base)}function formatDate(d,fmt,monthNames,dayNames){if(typeof d.strftime=="function"){return d.strftime(fmt)}var leftPad=function(n,pad){n=""+n;pad=""+(pad==null?"0":pad);return n.length==1?pad+n:n};var r=[];var escape=false;var hours=d.getHours();var isAM=hours<12;if(monthNames==null){monthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}if(dayNames==null){dayNames=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]}var hours12;if(hours>12){hours12=hours-12}else if(hours==0){hours12=12}else{hours12=hours}for(var i=0;i<fmt.length;++i){var c=fmt.charAt(i);if(escape){switch(c){case"a":c=""+dayNames[d.getDay()];break;case"b":c=""+monthNames[d.getMonth()];break;case"d":c=leftPad(d.getDate());break;case"e":c=leftPad(d.getDate()," ");break;case"h":case"H":c=leftPad(hours);break;case"I":c=leftPad(hours12);break;case"l":c=leftPad(hours12," ");break;case"m":c=leftPad(d.getMonth()+1);break;case"M":c=leftPad(d.getMinutes());break;case"q":c=""+(Math.floor(d.getMonth()/3)+1);break;case"S":c=leftPad(d.getSeconds());break;case"y":c=leftPad(d.getFullYear()%100);break;case"Y":c=""+d.getFullYear();break;case"p":c=isAM?""+"am":""+"pm";break;case"P":c=isAM?""+"AM":""+"PM";break;case"w":c=""+d.getDay();break}r.push(c);escape=false}else{if(c=="%"){escape=true}else{r.push(c)}}}return r.join("")}function makeUtcWrapper(d){function addProxyMethod(sourceObj,sourceMethod,targetObj,targetMethod){sourceObj[sourceMethod]=function(){return targetObj[targetMethod].apply(targetObj,arguments)}}var utc={date:d};if(d.strftime!=undefined){addProxyMethod(utc,"strftime",d,"strftime")}addProxyMethod(utc,"getTime",d,"getTime");addProxyMethod(utc,"setTime",d,"setTime");var props=["Date","Day","FullYear","Hours","Milliseconds","Minutes","Month","Seconds"];for(var p=0;p<props.length;p++){addProxyMethod(utc,"get"+props[p],d,"getUTC"+props[p]);addProxyMethod(utc,"set"+props[p],d,"setUTC"+props[p])}return utc}function dateGenerator(ts,opts){if(opts.timezone=="browser"){return new Date(ts)}else if(!opts.timezone||opts.timezone=="utc"){return makeUtcWrapper(new Date(ts))}else if(typeof timezoneJS!="undefined"&&typeof timezoneJS.Date!="undefined"){var d=new timezoneJS.Date;d.setTimezone(opts.timezone);d.setTime(ts);return d}else{return makeUtcWrapper(new Date(ts))}}var timeUnitSize={second:1e3,minute:60*1e3,hour:60*60*1e3,day:24*60*60*1e3,month:30*24*60*60*1e3,quarter:3*30*24*60*60*1e3,year:365.2425*24*60*60*1e3};var baseSpec=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"]];var specMonths=baseSpec.concat([[3,"month"],[6,"month"],[1,"year"]]);var specQuarters=baseSpec.concat([[1,"quarter"],[2,"quarter"],[1,"year"]]);function init(plot){plot.hooks.processOptions.push(function(plot,options){$.each(plot.getAxes(),function(axisName,axis){var opts=axis.options;if(opts.mode=="time"){axis.tickGenerator=function(axis){var ticks=[];var d=dateGenerator(axis.min,opts);var minSize=0;var spec=opts.tickSize&&opts.tickSize[1]==="quarter"||opts.minTickSize&&opts.minTickSize[1]==="quarter"?specQuarters:specMonths;if(opts.minTickSize!=null){if(typeof opts.tickSize=="number"){minSize=opts.tickSize}else{minSize=opts.minTickSize[0]*timeUnitSize[opts.minTickSize[1]]}}for(var i=0;i<spec.length-1;++i){if(axis.delta<(spec[i][0]*timeUnitSize[spec[i][1]]+spec[i+1][0]*timeUnitSize[spec[i+1][1]])/2&&spec[i][0]*timeUnitSize[spec[i][1]]>=minSize){break}}var size=spec[i][0];var unit=spec[i][1];if(unit=="year"){if(opts.minTickSize!=null&&opts.minTickSize[1]=="year"){size=Math.floor(opts.minTickSize[0])}else{var magn=Math.pow(10,Math.floor(Math.log(axis.delta/timeUnitSize.year)/Math.LN10));var norm=axis.delta/timeUnitSize.year/magn;if(norm<1.5){size=1}else if(norm<3){size=2}else if(norm<7.5){size=5}else{size=10}size*=magn}if(size<1){size=1}}axis.tickSize=opts.tickSize||[size,unit];var tickSize=axis.tickSize[0];unit=axis.tickSize[1];var step=tickSize*timeUnitSize[unit];if(unit=="second"){d.setSeconds(floorInBase(d.getSeconds(),tickSize))}else if(unit=="minute"){d.setMinutes(floorInBase(d.getMinutes(),tickSize))}else if(unit=="hour"){d.setHours(floorInBase(d.getHours(),tickSize))}else if(unit=="month"){d.setMonth(floorInBase(d.getMonth(),tickSize))}else if(unit=="quarter"){d.setMonth(3*floorInBase(d.getMonth()/3,tickSize))}else if(unit=="year"){d.setFullYear(floorInBase(d.getFullYear(),tickSize))}d.setMilliseconds(0);if(step>=timeUnitSize.minute){d.setSeconds(0)}if(step>=timeUnitSize.hour){d.setMinutes(0)}if(step>=timeUnitSize.day){d.setHours(0)}if(step>=timeUnitSize.day*4){d.setDate(1)}if(step>=timeUnitSize.month*2){d.setMonth(floorInBase(d.getMonth(),3))}if(step>=timeUnitSize.quarter*2){d.setMonth(floorInBase(d.getMonth(),6))}if(step>=timeUnitSize.year){d.setMonth(0)}var carry=0;var v=Number.NaN;var prev;do{prev=v;v=d.getTime();ticks.push(v);if(unit=="month"||unit=="quarter"){if(tickSize<1){d.setDate(1);var start=d.getTime();d.setMonth(d.getMonth()+(unit=="quarter"?3:1));var end=d.getTime();d.setTime(v+carry*timeUnitSize.hour+(end-start)*tickSize);carry=d.getHours();d.setHours(0)}else{d.setMonth(d.getMonth()+tickSize*(unit=="quarter"?3:1))}}else if(unit=="year"){d.setFullYear(d.getFullYear()+tickSize)}else{d.setTime(v+step)}}while(v<axis.max&&v!=prev);return ticks};axis.tickFormatter=function(v,axis){var d=dateGenerator(v,axis.options);if(opts.timeformat!=null){return formatDate(d,opts.timeformat,opts.monthNames,opts.dayNames)}var useQuarters=axis.options.tickSize&&axis.options.tickSize[1]=="quarter"||axis.options.minTickSize&&axis.options.minTickSize[1]=="quarter";var t=axis.tickSize[0]*timeUnitSize[axis.tickSize[1]];var span=axis.max-axis.min;var suffix=opts.twelveHourClock?" %p":"";var hourCode=opts.twelveHourClock?"%I":"%H";var fmt;if(t<timeUnitSize.minute){fmt=hourCode+":%M:%S"+suffix}else if(t<timeUnitSize.day){if(span<2*timeUnitSize.day){fmt=hourCode+":%M"+suffix}else{fmt="%b %d "+hourCode+":%M"+suffix}}else if(t<timeUnitSize.month){fmt="%b %d"}else if(useQuarters&&t<timeUnitSize.quarter||!useQuarters&&t<timeUnitSize.year){if(span<timeUnitSize.year){fmt="%b"}else{fmt="%b %Y"}}else if(useQuarters&&t<timeUnitSize.year){if(span<timeUnitSize.year){fmt="Q%q"}else{fmt="Q%q %Y"}}else{fmt="%Y"}var rt=formatDate(d,fmt,opts.monthNames,opts.dayNames);return rt}}})})}$.plot.plugins.push({init:init,options:options,name:"time",version:"1.0"});$.plot.formatDate=formatDate;$.plot.dateGenerator=dateGenerator})(jQuery);
;(function(a){function e(h){var k,j=this,l=h.data||{};if(l.elem)j=h.dragTarget=l.elem,h.dragProxy=d.proxy||j,h.cursorOffsetX=l.pageX-l.left,h.cursorOffsetY=l.pageY-l.top,h.offsetX=h.pageX-h.cursorOffsetX,h.offsetY=h.pageY-h.cursorOffsetY;else if(d.dragging||l.which>0&&h.which!=l.which||a(h.target).is(l.not))return;switch(h.type){case"mousedown":return a.extend(l,a(j).offset(),{elem:j,target:h.target,pageX:h.pageX,pageY:h.pageY}),b.add(document,"mousemove mouseup",e,l),i(j,!1),d.dragging=null,!1;case!d.dragging&&"mousemove":if(g(h.pageX-l.pageX)+g(h.pageY-l.pageY)<l.distance)break;h.target=l.target,k=f(h,"dragstart",j),k!==!1&&(d.dragging=j,d.proxy=h.dragProxy=a(k||j)[0]);case"mousemove":if(d.dragging){if(k=f(h,"drag",j),c.drop&&(c.drop.allowed=k!==!1,c.drop.handler(h)),k!==!1)break;h.type="mouseup"}case"mouseup":b.remove(document,"mousemove mouseup",e),d.dragging&&(c.drop&&c.drop.handler(h),f(h,"dragend",j)),i(j,!0),d.dragging=d.proxy=l.elem=!1}return!0}function f(b,c,d){b.type=c;var e=a.event.dispatch.call(d,b);return e===!1?!1:e||b.result}function g(a){return Math.pow(a,2)}function h(){return d.dragging===!1}function i(a,b){a&&(a.unselectable=b?"off":"on",a.onselectstart=function(){return b},a.style&&(a.style.MozUserSelect=b?"":"none"))}a.fn.drag=function(a,b,c){return b&&this.bind("dragstart",a),c&&this.bind("dragend",c),a?this.bind("drag",b?b:a):this.trigger("drag")};var b=a.event,c=b.special,d=c.drag={not:":input",distance:0,which:1,dragging:!1,setup:function(c){c=a.extend({distance:d.distance,which:d.which,not:d.not},c||{}),c.distance=g(c.distance),b.add(this,"mousedown",e,c),this.attachEvent&&this.attachEvent("ondragstart",h)},teardown:function(){b.remove(this,"mousedown",e),this===d.dragging&&(d.dragging=d.proxy=!1),i(this,!0),this.detachEvent&&this.detachEvent("ondragstart",h)}};c.dragstart=c.dragend={setup:function(){},teardown:function(){}}})(jQuery);(function(d){function e(a){var b=a||window.event,c=[].slice.call(arguments,1),f=0,e=0,g=0,a=d.event.fix(b);a.type="mousewheel";b.wheelDelta&&(f=b.wheelDelta/120);b.detail&&(f=-b.detail/3);g=f;void 0!==b.axis&&b.axis===b.HORIZONTAL_AXIS&&(g=0,e=-1*f);void 0!==b.wheelDeltaY&&(g=b.wheelDeltaY/120);void 0!==b.wheelDeltaX&&(e=-1*b.wheelDeltaX/120);c.unshift(a,f,e,g);return(d.event.dispatch||d.event.handle).apply(this,c)}var c=["DOMMouseScroll","mousewheel"];if(d.event.fixHooks)for(var h=c.length;h;)d.event.fixHooks[c[--h]]=d.event.mouseHooks;d.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=c.length;a;)this.addEventListener(c[--a],e,!1);else this.onmousewheel=e},teardown:function(){if(this.removeEventListener)for(var a=c.length;a;)this.removeEventListener(c[--a],e,!1);else this.onmousewheel=null}};d.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})})(jQuery);(function($){var options={xaxis:{zoomRange:null,panRange:null},zoom:{interactive:false,trigger:"click",amount:1.5},pan:{interactive:false,cursor:"move",frameRate:20}};function init(plot){function onZoomClick(e,zoomOut){var c=plot.offset();c.left=e.pageX-c.left;c.top=e.pageY-c.top;if(zoomOut)
plot.zoomOut({center:c});else
plot.zoom({center:c});}
function onMouseWheel(e,delta){e.preventDefault();return false;}
var prevCursor='default',prevPageX=0,prevPageY=0,panTimeout=null;function onDragStart(e){if(e.which!=1)
return false;var c=plot.getPlaceholder().css('cursor');if(c)
prevCursor=c;plot.getPlaceholder().css('cursor',plot.getOptions().pan.cursor);prevPageX=e.pageX;prevPageY=e.pageY;}
function onDrag(e){var frameRate=plot.getOptions().pan.frameRate;if(panTimeout||!frameRate)
return;panTimeout=setTimeout(function(){plot.pan({left:prevPageX-e.pageX,top:prevPageY-e.pageY});prevPageX=e.pageX;prevPageY=e.pageY;panTimeout=null;},1/frameRate*1000);}
function onDragEnd(e){if(panTimeout){clearTimeout(panTimeout);panTimeout=null;}
plot.getPlaceholder().css('cursor',prevCursor);plot.pan({left:prevPageX-e.pageX,top:prevPageY-e.pageY});}
function bindEvents(plot,eventHolder){var o=plot.getOptions();if(o.zoom.interactive){eventHolder[o.zoom.trigger](onZoomClick);eventHolder.mousewheel(onMouseWheel);}
if(o.pan.interactive){eventHolder.bind("dragstart",{distance:10},onDragStart);eventHolder.bind("drag",onDrag);eventHolder.bind("dragend",onDragEnd);}}
plot.zoomOut=function(args){if(!args)
args={};if(!args.amount)
args.amount=plot.getOptions().zoom.amount;args.amount=1/args.amount;plot.zoom(args);};plot.zoom=function(args){if(!args)
args={};var c=args.center,amount=args.amount||plot.getOptions().zoom.amount,w=plot.width(),h=plot.height();if(!c)
c={left:w/2,top:h/2};var xf=c.left/w,yf=c.top/h,minmax={x:{min:c.left-xf*w/amount,max:c.left+(1-xf)*w/amount},y:{min:c.top-yf*h/amount,max:c.top+(1-yf)*h/amount}};$.each(plot.getAxes(),function(_,axis){var opts=axis.options,min=minmax[axis.direction].min,max=minmax[axis.direction].max,zr=opts.zoomRange,pr=opts.panRange;if(zr===false)
return;min=axis.c2p(min);max=axis.c2p(max);if(min>max){var tmp=min;min=max;max=tmp;}
if(pr){if(pr[0]!=null&&min<pr[0]){min=pr[0];}
if(pr[1]!=null&&max>pr[1]){max=pr[1];}}
var range=max-min;if(zr&&((zr[0]!=null&&range<zr[0]&&amount>1)||(zr[1]!=null&&range>zr[1]&&amount<1)))
return;opts.min=min;opts.max=max;});plot.setupGrid();plot.draw();if(!args.preventEvent)
plot.getPlaceholder().trigger("plotzoom",[plot,args]);};plot.pan=function(args){var delta={x:+args.left,y:+args.top};if(isNaN(delta.x))
delta.x=0;if(isNaN(delta.y))
delta.y=0;$.each(plot.getAxes(),function(_,axis){var opts=axis.options,min,max,d=delta[axis.direction];min=axis.c2p(axis.p2c(axis.min)+d),max=axis.c2p(axis.p2c(axis.max)+d);var pr=opts.panRange;if(pr===false)
return;if(pr){if(pr[0]!=null&&pr[0]>min){d=pr[0]-min;min+=d;max+=d;}
if(pr[1]!=null&&pr[1]<max){d=pr[1]-max;min+=d;max+=d;}}
opts.min=min;opts.max=max;});plot.setupGrid();plot.draw();if(!args.preventEvent)
plot.getPlaceholder().trigger("plotpan",[plot,args]);};function shutdown(plot,eventHolder){eventHolder.unbind(plot.getOptions().zoom.trigger,onZoomClick);eventHolder.unbind("mousewheel",onMouseWheel);eventHolder.unbind("dragstart",onDragStart);eventHolder.unbind("drag",onDrag);eventHolder.unbind("dragend",onDragEnd);if(panTimeout)
clearTimeout(panTimeout);}
plot.hooks.bindEvents.push(bindEvents);plot.hooks.shutdown.push(shutdown);}
$.plot.plugins.push({init:init,options:options,name:'navigate',version:'1.3'});})(jQuery);